<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.0.0"/>
    <title>moleculegraph API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>


            <h2>Submodules</h2>
            <ul>
                    <li><a href="moleculegraph/general_utils.html">general_utils</a></li>
                    <li><a href="moleculegraph/molecule_utils.html">molecule_utils</a></li>
            </ul>

            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#molecule">molecule</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#molecule.__init__">molecule</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.molecule">molecule</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.f">f</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.n">n</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.i">i</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.len">len</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.atom_indexes">atom_indexes</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.atom_names">atom_names</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.atom_number">atom_number</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.atom_numbers">atom_numbers</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.idx_neighbour_list">idx_neighbour_list</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.neighbour_list">neighbour_list</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.ring_root_indexes">ring_root_indexes</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.distance_matrix">distance_matrix</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.bond_lists">bond_lists</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.idx_bond_list">idx_bond_list</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.bond_list">bond_list</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.bond_keys">bond_keys</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.angle_list">angle_list</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.angle_names">angle_names</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.angle_keys">angle_keys</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.torsion_list">torsion_list</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.torsion_names">torsion_names</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.torsion_keys">torsion_keys</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.ring_close_indexes">ring_close_indexes</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.unique_atom_names">unique_atom_names</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.unique_atom_numbers">unique_atom_numbers</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.unique_bond_keys">unique_bond_keys</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.unique_bond_indexes">unique_bond_indexes</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.unique_bond_inverse">unique_bond_inverse</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.unique_bond_names">unique_bond_names</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.unique_bond_numbers">unique_bond_numbers</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.unique_angle_keys">unique_angle_keys</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.unique_angle_indexes">unique_angle_indexes</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.unique_angle_inverse">unique_angle_inverse</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.unique_angle_names">unique_angle_names</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.unique_angle_numbers">unique_angle_numbers</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.unique_torsion_keys">unique_torsion_keys</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.unique_torsion_indexes">unique_torsion_indexes</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.unique_torsion_inverse">unique_torsion_inverse</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.unique_torsion_names">unique_torsion_names</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.unique_torsion_numbers">unique_torsion_numbers</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.unique_atom_pair_names">unique_atom_pair_names</a>
                        </li>
                        <li>
                                <a class="variable" href="#molecule.unique_atom_pair_keys">unique_atom_pair_keys</a>
                        </li>
                        <li>
                                <a class="function" href="#molecule.get_neighbour_list">get_neighbour_list</a>
                        </li>
                        <li>
                                <a class="function" href="#molecule.get_bond_matrix">get_bond_matrix</a>
                        </li>
                        <li>
                                <a class="function" href="#molecule.get_distance_matrix">get_distance_matrix</a>
                        </li>
                        <li>
                                <a class="function" href="#molecule.get_atom_index">get_atom_index</a>
                        </li>
                        <li>
                                <a class="function" href="#molecule.get_atom_no">get_atom_no</a>
                        </li>
                        <li>
                                <a class="function" href="#molecule.get_next_atom_idx">get_next_atom_idx</a>
                        </li>
                        <li>
                                <a class="function" href="#molecule.get_last_atom_idx">get_last_atom_idx</a>
                        </li>
                        <li>
                                <a class="function" href="#molecule.get_next_atom_no">get_next_atom_no</a>
                        </li>
                        <li>
                                <a class="function" href="#molecule.get_last_atom_no">get_last_atom_no</a>
                        </li>
                        <li>
                                <a class="function" href="#molecule.map_molecule_via_atom_names">map_molecule_via_atom_names</a>
                        </li>
                        <li>
                                <a class="function" href="#molecule.map_unique_via_atom_names">map_unique_via_atom_names</a>
                        </li>
                        <li>
                                <a class="function" href="#molecule.map_molecule">map_molecule</a>
                        </li>
                        <li>
                                <a class="function" href="#molecule.map_unique">map_unique</a>
                        </li>
                        <li>
                                <a class="function" href="#molecule.map_nested">map_nested</a>
                        </li>
                        <li>
                                <a class="function" href="#molecule.get_distance">get_distance</a>
                        </li>
                        <li>
                                <a class="function" href="#molecule.get_sorted_key">get_sorted_key</a>
                        </li>
                        <li>
                                <a class="function" href="#molecule.visualize">visualize</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
moleculegraph    </h1>

                
                        <input id="mod-moleculegraph-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-moleculegraph-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="kn">from</span> <span class="nn">.general_utils</span> <span class="kn">import</span> <span class="o">*</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="kn">from</span> <span class="nn">.molecule_utils</span> <span class="kn">import</span> <span class="o">*</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="kn">import</span> <span class="nn">csv</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="c1"># from rapidfuzz.string_metric import normalized_levenshtein</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="kn">import</span> <span class="nn">json</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="sd">moleculegraph</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="sd">A graph representation for molecules and everything else for data mapping</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;0.0.0&quot;</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;Maximilian Fleck&quot;</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="n">__credits__</span> <span class="o">=</span> <span class="s2">&quot;ITT Uni Stuttgart&quot;</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="k">class</span> <span class="nc">molecule</span><span class="p">:</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="sd">    simple undirected graph representation for molecules and more.</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="sd">    </span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="sd">    write code about molecules without the need to care about them.</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="sd">    </span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="sd">    semantics only. Bring your own syntax.</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="sd">    </span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="sd">    Main results are:</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="sd">    - distance matrix of the molecule.</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">    - atom, bond, angle, torsion lists.</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">    YOU can use them to:</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="sd">    - map force-field information onto your molecule.</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="sd">    - generate inputs for templating trajectories and coordinates</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">    - use group contribution approaches</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="sd">    - process coordinates from the PubChem-API</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="sd">    Furthermore:</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="sd">    - this graph-representation is quite general and not limited to molecules.</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="sd">    - ...you might use it to represent your favorite baking recipes and optimize them.    </span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="sd">    </span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mol</span><span class="p">):</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">        initializes molecules based on graph-list representation.</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="sd">        </span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="sd">        The term index (or idx) always refers to a character in the string, </span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">        be it semantic or syntactic. Semantics and syntax of the string are </span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="sd">        no longer important once the bond list and thus the actual graph is </span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="sd">        created. Then there are only syntactic objects, i.e. atoms.</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a><span class="sd">        Thus, all numbers occuring in bond, angle or torsional lists or in</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="sd">        distance matrices refer to atomic numbers. Indexes and semantic lists </span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="sd">        are only important for advanced applications. For example, generating</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a><span class="sd">        strings with the same meaning. If both options are available they are</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="sd">        are marked with index/indexes/idx and number/numbers. For example:</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="sd">        ring_root_numbers and ring_root_indexes.</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="sd">        Parameters:</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="sd">        - mol:</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="sd">            - string representation of a molecule.</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="sd">        </span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">        Returns:</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="sd">            nothing</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>            <span class="n">mol</span> <span class="o">=</span> <span class="n">mol</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;][&quot;</span><span class="p">)</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">molecule</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>        <span class="sd">&quot;&quot;&quot;array representation of the molecule i.e. all keys/words/whatever in a list&quot;&quot;&quot;</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mol</span><span class="p">))</span>  <span class="c1"># shows function</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>        <span class="sd">&quot;&quot;&quot;array with all functions. </span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">        - branches pointing forward f &gt; 0</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="sd">        - rings pointing backward f &lt; 0</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a><span class="sd">        - beads without function f = 0</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mol</span><span class="p">))</span>  <span class="c1"># shows atomnumber</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>        <span class="sd">&quot;&quot;&quot;array with atom numbers. branches and rings n = -1 as they are no atoms&quot;&quot;&quot;</span>        
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mol</span><span class="p">))</span>  <span class="c1"># shows index</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>        <span class="sd">&quot;&quot;&quot;array with indexes. atoms, branches and rings get an index&quot;&quot;&quot;</span>         
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">)</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>        <span class="sd">&quot;&quot;&quot;number of all elements i.e. atoms, branches and rings&quot;&quot;&quot;</span>       
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>            <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>            <span class="k">elif</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>                <span class="c1"># dum = -int(m[1:])</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>  <span class="c1"># self.get_atom_index()</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>                <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>        <span class="c1"># contains indexes of atoms</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>        <span class="c1"># index of atom no n: self.atom_indexes[n]</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">atom_indexes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>        <span class="sd">&quot;&quot;&quot;array with indexes of all atoms&quot;&quot;&quot;</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">atom_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">molecule</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>        <span class="sd">&quot;&quot;&quot;array with names of all atoms&quot;&quot;&quot;</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">atom_number</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_indexes</span><span class="p">)</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>        <span class="sd">&quot;&quot;&quot;number of all atoms&quot;&quot;&quot;</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">atom_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_number</span><span class="p">)</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>        <span class="sd">&quot;&quot;&quot;array with numbers of all atoms&quot;&quot;&quot;</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>        
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>        <span class="c1"># housekeeping for get_neighbour_list (will be called later)</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>        <span class="c1"># (the following things are generated when calling get_neighbour_list)</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">idx_neighbour_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>        <span class="sd">&quot;&quot;&quot;array with indexes of all neighboured/bonded atoms&quot;&quot;&quot;</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">neighbour_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>        <span class="sd">&quot;&quot;&quot;array with numbers of all neighboured/bonded atoms&quot;&quot;&quot;</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ring_root_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>        <span class="sd">&quot;&quot;&quot;array with indexes of all atoms rooting a ring&quot;&quot;&quot;</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>       
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>        
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>        <span class="c1"># housekeeping for get_distance_matrix (will be called later)</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>        <span class="c1"># (the following things are generated when calling get_distance_matrix)</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distance_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>        <span class="sd">&quot;&quot;&quot;distance matrix of all atoms in the molecule&quot;&quot;&quot;</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bond_lists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>        <span class="sd">&quot;&quot;&quot;nested array with bond lists </span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a><span class="sd">        - starting from atoms separeted by one bond bond_lists[0]</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a><span class="sd">        - then atoms separeted by two bonds bond_lists[1] </span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a><span class="sd">        - ...</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">idx_bond_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>        <span class="sd">&quot;&quot;&quot;array with indexes of all neighboured/bonded atoms&quot;&quot;&quot;</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bond_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>        <span class="sd">&quot;&quot;&quot;array with numbers of all neighboured/bonded atoms&quot;&quot;&quot;</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bond_keys</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>        <span class="sd">&quot;&quot;&quot;array with keys of all neighboured/bonded atoms&quot;&quot;&quot;</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">angle_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>        <span class="sd">&quot;&quot;&quot;array of numbers of all angle forming atoms (separated by 2 bonds)&quot;&quot;&quot;</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">angle_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>        <span class="sd">&quot;&quot;&quot;array of names of all angle forming atoms (separated by 2 bonds)&quot;&quot;&quot;</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">angle_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>        <span class="sd">&quot;&quot;&quot;array of keys of all angle forming atoms (separated by 2 bonds)&quot;&quot;&quot;</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>        <span class="sd">&quot;&quot;&quot;array of numbers of all dihedral forming atoms (separated by 3 bonds)&quot;&quot;&quot;</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>        <span class="sd">&quot;&quot;&quot;array of names of all dihedral forming atoms (separated by 3 bonds)&quot;&quot;&quot;</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>        
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>        <span class="sd">&quot;&quot;&quot;array of keys of all dihedral forming atoms (separated by 3 bonds)&quot;&quot;&quot;</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>        <span class="c1"># get bond list</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">get_neighbour_list</span><span class="p">()</span>        
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>        
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>        <span class="c1"># get branch ends</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>        <span class="n">n</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bond_list</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>        <span class="n">pp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">branch_end_numbers</span> <span class="o">=</span> <span class="n">n</span><span class="p">[</span><span class="n">pp</span><span class="p">]</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">branch_end_indexes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_indexes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">branch_end_numbers</span><span class="p">]</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">branch_end_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">branch_end_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>        <span class="c1"># get ring closures</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ring_close_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>        <span class="sd">&quot;&quot;&quot;array with indexes of all atoms closing a ring&quot;&quot;&quot;</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ring_close_indexes</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ring_close_numbers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ring_close_indexes</span><span class="p">]</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>            <span class="sd">&quot;&quot;&quot;array with atom numbers of all atoms closing a ring&quot;&quot;&quot;</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ring_root_numbers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ring_root_indexes</span><span class="p">]</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>            <span class="sd">&quot;&quot;&quot;array with atom numbers of all atoms rooting a ring&quot;&quot;&quot;</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ring_close_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ring_root_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>        <span class="c1"># get distance matrix</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">get_distance_matrix</span><span class="p">()</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>        <span class="n">dummy</span> <span class="o">=</span> <span class="n">unique_sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_names</span><span class="p">,</span> <span class="n">return_inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>        <span class="p">(</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_keys</span><span class="p">,</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_indexes</span><span class="p">,</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_inverse</span><span class="p">,</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>        <span class="p">)</span> <span class="o">=</span> <span class="n">dummy</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_names</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_indexes</span><span class="p">]</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>        <span class="sd">&quot;&quot;&quot;array with unique atom names&quot;&quot;&quot;</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_numbers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_numbers</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_indexes</span><span class="p">]</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>        <span class="sd">&quot;&quot;&quot;array with numbers of unique atom names&quot;&quot;&quot;</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_keys</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_inverse</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_names</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>        <span class="p">),</span> <span class="s2">&quot;unique atom in inverse doesnt work&quot;</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>        <span class="n">dummy</span> <span class="o">=</span> <span class="n">unique_sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bond_keys</span><span class="p">,</span> <span class="n">return_inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_bond_keys</span> <span class="o">=</span> <span class="n">dummy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>        <span class="sd">&quot;&quot;&quot;array with unique bond keys&quot;&quot;&quot;</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_bond_indexes</span> <span class="o">=</span> <span class="n">dummy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>        <span class="sd">&quot;&quot;&quot;array with unique bond indexes&quot;&quot;&quot;</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_bond_inverse</span> <span class="o">=</span> <span class="n">dummy</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>        <span class="sd">&quot;&quot;&quot;array to invert unique bonds&quot;&quot;&quot;</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_bond_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_names</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_bond_indexes</span><span class="p">]</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>        <span class="sd">&quot;&quot;&quot;array with unique bond names&quot;&quot;&quot;</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_bond_numbers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_bond_indexes</span><span class="p">]</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>        <span class="sd">&quot;&quot;&quot;array with numbers of unique bond names&quot;&quot;&quot;</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bond_keys</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">unique_bond_keys</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_bond_inverse</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_keys</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>            <span class="p">),</span> <span class="s2">&quot;unique bond in inverse doesnt work&quot;</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>        <span class="n">dummy</span> <span class="o">=</span> <span class="n">unique_sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angle_keys</span><span class="p">,</span> <span class="n">return_inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_angle_keys</span> <span class="o">=</span> <span class="n">dummy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>        <span class="sd">&quot;&quot;&quot;array with unique angle keys&quot;&quot;&quot;</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_angle_indexes</span> <span class="o">=</span> <span class="n">dummy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>        <span class="sd">&quot;&quot;&quot;array with unique angle indexes&quot;&quot;&quot;</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_angle_inverse</span> <span class="o">=</span> <span class="n">dummy</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>        <span class="sd">&quot;&quot;&quot;array to invert unique angles&quot;&quot;&quot;</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_angle_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_names</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_angle_indexes</span><span class="p">]</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>        <span class="sd">&quot;&quot;&quot;array with unique angle names&quot;&quot;&quot;</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_angle_numbers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_angle_indexes</span><span class="p">]</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>        <span class="sd">&quot;&quot;&quot;array with numbers of unique angle names&quot;&quot;&quot;</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angle_keys</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">unique_angle_keys</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_angle_inverse</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_keys</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>            <span class="p">),</span> <span class="s2">&quot;unique angle in inverse doesnt work&quot;</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>        <span class="n">dummy</span> <span class="o">=</span> <span class="n">unique_sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">torsion_keys</span><span class="p">,</span> <span class="n">return_inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_torsion_keys</span> <span class="o">=</span> <span class="n">dummy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>        <span class="sd">&quot;&quot;&quot;array with unique torsion keys&quot;&quot;&quot;</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_torsion_indexes</span> <span class="o">=</span> <span class="n">dummy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>        <span class="sd">&quot;&quot;&quot;array with unique torsion indexes&quot;&quot;&quot;</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_torsion_inverse</span> <span class="o">=</span> <span class="n">dummy</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>        <span class="sd">&quot;&quot;&quot;array to invert unique torsions&quot;&quot;&quot;</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>        
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_torsion_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">torsion_names</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_torsion_indexes</span><span class="p">]</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>        <span class="sd">&quot;&quot;&quot;array with unique torsion names&quot;&quot;&quot;</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_torsion_numbers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">torsion_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_torsion_indexes</span><span class="p">]</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>        <span class="sd">&quot;&quot;&quot;array with numbers of unique torsion names&quot;&quot;&quot;</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">torsion_keys</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">unique_torsion_keys</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_torsion_inverse</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">torsion_keys</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>            <span class="p">),</span> <span class="s2">&quot;unique angle in inverse doesnt work&quot;</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_pair_names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_pair_keys</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">a0</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_names</span><span class="p">):</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">a1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_names</span><span class="p">):</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">j</span><span class="p">:</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_pair_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sort_force_fields</span><span class="p">([</span><span class="n">a0</span><span class="p">,</span> <span class="n">a1</span><span class="p">]))</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_pair_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>                        <span class="n">make_graph</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_pair_names</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>                    <span class="p">)</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_pair_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_pair_names</span><span class="p">)</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>        <span class="sd">&quot;&quot;&quot;array with unique atom pair names. use them for combining rules.&quot;&quot;&quot;</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_pair_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_pair_keys</span><span class="p">)</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>        <span class="sd">&quot;&quot;&quot;array with unique atom pair keys. use them for combining rules.&quot;&quot;&quot;</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>        <span class="k">return</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>    <span class="k">def</span> <span class="nf">get_neighbour_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a><span class="sd">        generates a neighbour list from an initialized molecule</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a><span class="sd">        Parameters: None</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a><span class="sd">        Returns:</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a><span class="sd">        - neighbour_list:</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a><span class="sd">            - list of neighboured atoms containing their atom numbers.</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a><span class="sd">        - idx_neighbour_list:</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a><span class="sd">            - list of neighboured atoms containing their atom indexes.</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a><span class="sd">        &quot;&quot;&quot;</span> 
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>        <span class="n">idx_neighbour_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>        <span class="n">idx_branch_ends</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>        <span class="n">idx_branch_starts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>        <span class="n">idx_ring_close</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>        <span class="n">idx_branch_funs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>        <span class="n">branches</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">))</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>        <span class="n">branch_origins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">))</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>        <span class="n">branch_count</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_number</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">idx_neighbour_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">neighbour_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">idx_bond_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">bond_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a><span class="sd">        find branches and assign numbers.</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a><span class="sd">        get main path through molecule.</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a><span class="sd">        build molecule from this...</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>        <span class="n">inv_f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>        <span class="n">branch_no</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>        <span class="n">inv_f_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">inv_f</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)))</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>        <span class="n">inv_branches</span> <span class="o">=</span> <span class="n">inv_f</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>        <span class="n">inv_branches</span><span class="p">[</span><span class="n">inv_branches</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ifi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">inv_f_p</span><span class="p">,</span> <span class="n">inv_f</span><span class="p">[</span><span class="n">inv_f_p</span><span class="p">]):</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>            <span class="k">if</span> <span class="n">ifi</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># ring</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>                <span class="n">inv_branches</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>            <span class="k">if</span> <span class="n">ifi</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># branch :)</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>                <span class="n">pp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">inv_branches</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)))</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">ifi</span><span class="p">:</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>                    <span class="n">p_branch</span> <span class="o">=</span> <span class="n">pp</span><span class="p">[</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="n">ifi</span><span class="p">)</span> <span class="p">:]</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>                    <span class="n">inv_branches</span><span class="p">[</span><span class="n">p_branch</span><span class="p">]</span> <span class="o">=</span> <span class="n">branch_no</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>                    <span class="n">inv_branches</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">branch_no</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>                    <span class="n">branch_no</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>        <span class="n">branches</span> <span class="o">=</span> <span class="n">reenumerate_branches</span><span class="p">(</span><span class="n">inv_branches</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>        <span class="c1"># print(branches)</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>        <span class="n">main_path_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">branches</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>        <span class="n">main_path_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">[</span><span class="n">main_path_p</span><span class="p">]</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>        <span class="c1"># get bond list of main path</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>        <span class="n">bond_list</span> <span class="o">=</span> <span class="n">bond_list_from_simple_path</span><span class="p">(</span><span class="n">main_path_i</span><span class="p">)</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>        <span class="c1"># print( &quot;branches&quot;,branches )</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a><span class="sd">        build bond list</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>        <span class="n">f_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)))</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ring_root_indexes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>        <span class="c1"># print(&quot;f_p , self.f[f_p]&quot;, f_p, self.f[f_p])</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">f_p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">[</span><span class="n">f_p</span><span class="p">]):</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>            <span class="c1">#print(branches)</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>            <span class="k">if</span> <span class="n">fi</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>                <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>                    <span class="n">get_diff_in_bond_lists</span><span class="p">(</span><span class="n">f_p</span><span class="p">[</span><span class="n">f_p</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>                <span class="p">)</span>  <span class="c1"># index of last atom</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>                <span class="n">branches</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_branch_root</span><span class="p">(</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>                    <span class="n">branches</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">branches</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>                <span class="p">)</span>  <span class="c1"># connect ring to acompanying branch</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>                <span class="n">subgraph</span> <span class="o">=</span> <span class="n">graph_from_bonds</span><span class="p">(</span><span class="n">bond_list</span><span class="p">)</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>                <span class="n">path_to_main</span> <span class="o">=</span> <span class="n">get_shortest_path</span><span class="p">(</span><span class="n">subgraph</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>                <span class="n">bond_list_to_main</span> <span class="o">=</span> <span class="n">bond_list_from_simple_path</span><span class="p">(</span><span class="n">path_to_main</span><span class="p">)</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>                <span class="n">graph_to_main</span> <span class="o">=</span> <span class="n">graph_from_bonds</span><span class="p">(</span><span class="n">bond_list_to_main</span><span class="p">)</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>                <span class="n">root</span> <span class="o">=</span> <span class="n">get_root</span><span class="p">(</span><span class="n">graph_to_main</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fi</span><span class="p">)))</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>                <span class="k">if</span> <span class="n">root</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;root of ring outside molecule. ignore.&quot;</span><span class="p">)</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>                    <span class="n">bond_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">bond_list</span><span class="p">,</span> <span class="p">[[</span><span class="n">root</span><span class="p">,</span> <span class="n">idx</span><span class="p">]]])</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">ring_root_indexes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>            <span class="k">elif</span> <span class="n">fi</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>                <span class="n">link</span> <span class="o">=</span> <span class="n">get_branch_root</span><span class="p">(</span><span class="n">branches</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">branches</span><span class="p">)</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>                <span class="n">branch</span> <span class="o">=</span> <span class="n">branches</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>                <span class="n">p_subchain_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">branches</span> <span class="o">==</span> <span class="n">branch</span><span class="p">)))[</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>                    <span class="mi">1</span><span class="p">:</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>                <span class="p">]</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p_subchain_i</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">fi</span><span class="p">:</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;end of branch outside molecule. ignore.&quot;</span><span class="p">)</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>                    <span class="n">p_subchain_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([[</span><span class="n">link</span><span class="p">],</span> <span class="n">p_subchain_i</span><span class="p">])</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>                    <span class="n">subchain_bond_list</span> <span class="o">=</span> <span class="n">bond_list_from_simple_path</span><span class="p">(</span><span class="n">p_subchain_i</span><span class="p">)</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>                    <span class="n">bond_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">bond_list</span><span class="p">,</span> <span class="n">subchain_bond_list</span><span class="p">])</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;fi = 0... this should not happen :P&quot;</span><span class="p">)</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>        <span class="c1">#print(&quot;fin branches&quot;, branches)</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">idx_neighbour_list</span> <span class="o">=</span> <span class="n">bond_list</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">idx_bond_list</span> <span class="o">=</span> <span class="n">bond_list</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ring_root_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ring_root_indexes</span><span class="p">)</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">neighbour_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_atom_no</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">idx_neighbour_list</span><span class="p">)</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bond_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">neighbour_list</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">neighbour_list</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">idx_neighbour_list</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>    <span class="k">def</span> <span class="nf">get_bond_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a><span class="sd">        generates bond matrix from an initialized molecule</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a><span class="sd">        Parameters: None</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a><span class="sd">        Returns:</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a><span class="sd">        - bond_matrix:</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a><span class="sd">            - bond matrix of you molecule</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bond_matrix</span> <span class="o">=</span> <span class="n">get_bond_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">neighbour_list</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_number</span><span class="p">)</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_matrix</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>    <span class="k">def</span> <span class="nf">get_distance_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a><span class="sd">        generates distance matrix from an initialized molecule.</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a><span class="sd">        Furthermore different angle and torsion lists are generated.</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a><span class="sd">        Parameters: None</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a><span class="sd">        </span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a><span class="sd">        Returns:</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a><span class="sd">        - distance_matrix:</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a><span class="sd">            - distance matrix of you molecule</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distance_matrix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_lists</span> <span class="o">=</span> <span class="n">get_distance_matrix</span><span class="p">(</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">neighbour_list</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_number</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a>        <span class="p">)</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bond_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_lists</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bond_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a>            <span class="p">[</span><span class="n">sort_force_fields</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_names</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_list</span><span class="p">]</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a>        <span class="p">)</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bond_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">make_graph</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_names</span><span class="p">])</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bond_lists</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">angle_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bond_lists</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">angle_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>                <span class="p">[</span><span class="n">sort_force_fields</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_names</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_list</span><span class="p">]</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>            <span class="p">)</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">angle_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">make_graph</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_names</span><span class="p">])</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">angle_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">angle_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">angle_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bond_lists</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">torsion_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bond_lists</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">torsion_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a>                <span class="p">[</span><span class="n">sort_force_fields</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_names</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">torsion_list</span><span class="p">]</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>            <span class="p">)</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">torsion_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">make_graph</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">torsion_names</span><span class="p">])</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">torsion_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">torsion_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">torsion_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance_matrix</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>    <span class="k">def</span> <span class="nf">get_atom_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">no</span><span class="p">):</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a><span class="sd">        returns index of atom.</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a><span class="sd">        - Number: atom number</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a><span class="sd">        - Index:  index in list representation of molecule.</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a><span class="sd">        Number and index are differing due to functionals in the list.</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a><span class="sd">        Parameters:</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a><span class="sd">        - no:</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a><span class="sd">           - number of the atom</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a><span class="sd">           </span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a><span class="sd">        Returns:</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a><span class="sd">        - index of atom number &quot;no&quot;</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_indexes</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">no</span><span class="p">)])</span>  <span class="c1"># int(np.squeeze(np.where(self.n==no)))</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>    <span class="k">def</span> <span class="nf">get_atom_no</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a><span class="sd">        returns index of atom.</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a><span class="sd">        - Number: atom number</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a><span class="sd">        - Index:  index in list representation of molecule.</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a><span class="sd">        Number and index are differing due to functionals in the list.</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a><span class="sd">        Parameters:</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a><span class="sd">        - idx:</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a><span class="sd">            - idx of the atom</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a><span class="sd">            </span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a><span class="sd">        Returns:</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a><span class="sd">        - number of atom with index</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a>        <span class="n">idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a>            <span class="n">no</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_indexes</span> <span class="o">==</span> <span class="n">idx</span><span class="p">)))</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a>            <span class="k">assert</span> <span class="n">no</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="s2">&quot;atom numbers dont work&quot;</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a>            <span class="k">return</span> <span class="n">no</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;atom numbers dont work&quot;</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error in get_atom_no: not an atom&quot;</span><span class="p">)</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>    <span class="k">def</span> <span class="nf">get_next_atom_idx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a><span class="sd">        returns index of the next atom after index idx.</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a><span class="sd">        Index:  index in list representation of molecule.</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a><span class="sd">        Number and index are differing due to functionals in the list.</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a><span class="sd">        Parameters:</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a><span class="sd">        idx:</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a><span class="sd">            - index in list representation of molecule</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a><span class="sd">            </span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a><span class="sd">        Returns:</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a><span class="sd">        - index of the next atom after index idx</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_indexes</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_indexes</span> <span class="o">-</span> <span class="n">idx</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]))</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a>    <span class="k">def</span> <span class="nf">get_last_atom_idx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a><span class="sd">        returns index of the atom before index idx.</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a><span class="sd">        Index:  index in list representation of molecule.</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a><span class="sd">        Number and index are differing due to functionals in the list.</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a><span class="sd">        Parameters:</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a><span class="sd">        idx:</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a><span class="sd">            - index in list representation of molecule</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a><span class="sd">            </span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a><span class="sd">        Returns:</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a><span class="sd">        - index of the atom before index idx</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a>        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_indexes</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_indexes</span> <span class="o">-</span> <span class="n">idx</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]))</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>    <span class="k">def</span> <span class="nf">get_next_atom_no</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a><span class="sd">        returns number of the atom after index idx.</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a><span class="sd">        Index:  index in list representation of molecule.</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a><span class="sd">        Number: atom number</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a><span class="sd">        Number and index are differing due to functionals in the list.</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a><span class="sd">        Parameters:</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a><span class="sd">        - idx:</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a><span class="sd">            - index in list representation of molecule</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a><span class="sd">            </span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a><span class="sd">        Returns:</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a><span class="sd">        - number of the atom after index idx</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a>        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_next_atom_idx</span><span class="p">(</span><span class="n">idx</span><span class="p">)])</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a>    <span class="k">def</span> <span class="nf">get_last_atom_no</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a><span class="sd">        returns number of the atom before index idx.</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a><span class="sd">        Index:  index in list representation of molecule.</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a><span class="sd">        Number: atom number</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a><span class="sd">        Number and index are differing due to functionals in the list.</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a><span class="sd">        Parameters:</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a><span class="sd">            self:</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a><span class="sd">                - initialized molecule.</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a><span class="sd">            idx:</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a><span class="sd">                - index in list representation of molecule</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a><span class="sd">                </span>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a><span class="sd">        Returns:</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a><span class="sd">            number of the atom before index idx</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a>        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_last_atom_idx</span><span class="p">(</span><span class="n">idx</span><span class="p">)])</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a>    <span class="k">def</span> <span class="nf">map_molecule_via_atom_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a><span class="sd">        maps information from a dictionary onto the molecule.</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a><span class="sd">        Use this for molecule information i.e. coordinates, group contributions,...</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a><span class="sd">        Parameters:</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a><span class="sd">        - data:</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a><span class="sd">            - dictionary with: keys == atom names !!!</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a><span class="sd">            </span>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a><span class="sd">        Returns:</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a><span class="sd">        - mapped data</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a>        <span class="k">return</span> <span class="p">[</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_names</span><span class="p">)]</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a>    <span class="k">def</span> <span class="nf">map_unique_via_atom_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a><span class="sd">        Maps information from a dictionary onto unique elements of the molecule.</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a><span class="sd">        Preserves the order of the original list.</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a><span class="sd">        Use this for force-field information i.e. potentials,...</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a><span class="sd">        Parameters:</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a><span class="sd">        - data:</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a><span class="sd">            - dictionary with: keys == atom names !!!</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a><span class="sd">            </span>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a><span class="sd">        Returns:</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a><span class="sd">        - mapped unique data</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a>        <span class="nb">print</span><span class="p">(</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a>            <span class="s2">&quot;map_unique_via_atom_names is outtdated... dont use</span><span class="se">\n</span><span class="s2"> shouldnt cause errors btw&quot;</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a>        <span class="p">)</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a>        <span class="k">return</span> <span class="p">[</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_names</span><span class="p">)]</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a>    <span class="k">def</span> <span class="nf">map_molecule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">goal</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a><span class="sd">        maps information from a dictionary onto a goal.</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a><span class="sd">        Use this for molecule information i.e. coordinates, group contributions,...</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a><span class="sd">        Parameters:</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a><span class="sd">        - goal:</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a><span class="sd">            - list of keys</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a><span class="sd">        - data:</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a><span class="sd">            - dictionary with keys in goal</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a><span class="sd">            </span>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a><span class="sd">        Returns:</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a><span class="sd">        - mapped data</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a>        <span class="k">return</span> <span class="p">[</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="n">goal</span><span class="p">)]</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a>    <span class="k">def</span> <span class="nf">map_unique</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">goal</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a><span class="sd">        Maps information from a dictionary onto unique elements a goal.</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a><span class="sd">        Preserves the order of the original list.</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a><span class="sd">        Use this for force-field information i.e. potentials,...</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a>
</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a><span class="sd">        Parameters:</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a><span class="sd">        - goal:</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a><span class="sd">            - list of keys</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a><span class="sd">        - data:</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a><span class="sd">            - dictionary with keys in goal</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a><span class="sd">            </span>
</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a><span class="sd">        Returns:</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a><span class="sd">        - mapped unique data</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;map_unique is outtdated... dont use</span><span class="se">\n</span><span class="s2"> shouldnt cause errors btw&quot;</span><span class="p">)</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos">583</span></a>        <span class="k">return</span> <span class="p">[</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="n">unique_sort</span><span class="p">(</span><span class="n">goal</span><span class="p">))]</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos">584</span></a>
</span><span id="L-585"><a href="#L-585"><span class="linenos">585</span></a>    <span class="k">def</span> <span class="nf">map_nested</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">goal</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos">586</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos">587</span></a><span class="sd">        Maps information from a dictionary onto nested elements of a goal.</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos">588</span></a><span class="sd">        Preserves the order of the original list.</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos">589</span></a><span class="sd">        Use this for advanced force-field information i.e. mixing rules,...</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos">590</span></a>
</span><span id="L-591"><a href="#L-591"><span class="linenos">591</span></a><span class="sd">        same as:</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos">592</span></a><span class="sd">        [ self.map_unique( m, data) for m in goal ]</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos">593</span></a>
</span><span id="L-594"><a href="#L-594"><span class="linenos">594</span></a><span class="sd">        Parameters:</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos">595</span></a><span class="sd">        - goal:</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos">596</span></a><span class="sd">            -with list list of keys</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos">597</span></a><span class="sd">        - data:</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos">598</span></a><span class="sd">            -dictionary with keys in goal</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos">599</span></a><span class="sd">            </span>
</span><span id="L-600"><a href="#L-600"><span class="linenos">600</span></a><span class="sd">        Returns:</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos">601</span></a><span class="sd">        - mapped unique data</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos">602</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos">603</span></a>        <span class="k">return</span> <span class="p">[[</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="n">m</span><span class="p">)]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">goal</span><span class="p">]</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos">604</span></a>
</span><span id="L-605"><a href="#L-605"><span class="linenos">605</span></a>    <span class="k">def</span> <span class="nf">get_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos">606</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos">607</span></a><span class="sd">        Returns distance between atoms no x and y</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos">608</span></a><span class="sd">        0: same atom i.e. x==y</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos">609</span></a><span class="sd">        1: bond</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos">610</span></a><span class="sd">        2: angle</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos">611</span></a><span class="sd">        3: torsion</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos">612</span></a>
</span><span id="L-613"><a href="#L-613"><span class="linenos">613</span></a><span class="sd">        Parameters:</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos">614</span></a><span class="sd">        - x,y:</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos">615</span></a><span class="sd">            - atom numbers</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos">616</span></a><span class="sd">            </span>
</span><span id="L-617"><a href="#L-617"><span class="linenos">617</span></a><span class="sd">        Returns:</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos">618</span></a><span class="sd">        - distance</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos">619</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos">620</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance_matrix</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)][</span><span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)]</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos">621</span></a>
</span><span id="L-622"><a href="#L-622"><span class="linenos">622</span></a>    <span class="k">def</span> <span class="nf">get_sorted_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos">623</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos">624</span></a><span class="sd">        Sorts a list alphabetically.</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos">625</span></a><span class="sd">        Very important for dictionary keys in the molecule class!!!</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos">626</span></a>
</span><span id="L-627"><a href="#L-627"><span class="linenos">627</span></a><span class="sd">        Parameters:</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos">628</span></a><span class="sd">        - x:</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos">629</span></a><span class="sd">            - string list to sort</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos">630</span></a><span class="sd">            </span>
</span><span id="L-631"><a href="#L-631"><span class="linenos">631</span></a><span class="sd">        Returns:</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos">632</span></a><span class="sd">        - key (string) and sorted list</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos">633</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos">634</span></a>        <span class="n">x_sort</span> <span class="o">=</span> <span class="n">sort_force_fields</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos">635</span></a>        <span class="k">return</span> <span class="n">make_graph</span><span class="p">(</span><span class="n">x_sort</span><span class="p">),</span> <span class="n">x_sort</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos">636</span></a>
</span><span id="L-637"><a href="#L-637"><span class="linenos">637</span></a>    <span class="k">def</span> <span class="nf">visualize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">saveto</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos">638</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos">639</span></a><span class="sd">        plots and visualizes molecule</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos">640</span></a><span class="sd">        </span>
</span><span id="L-641"><a href="#L-641"><span class="linenos">641</span></a><span class="sd">        Parameters:</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos">642</span></a><span class="sd">        - saveto:</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos">643</span></a><span class="sd">            - optional, location to save pic of graph to,</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos">644</span></a><span class="sd">            - add file format at the end ;)</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos">645</span></a><span class="sd">            </span>
</span><span id="L-646"><a href="#L-646"><span class="linenos">646</span></a><span class="sd">        Returns:</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos">647</span></a><span class="sd">            nothing</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos">648</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos">649</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_numbers</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos">650</span></a>            <span class="n">plot_graph</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_list</span><span class="p">,</span> <span class="n">saveto</span><span class="o">=</span><span class="n">saveto</span><span class="p">)</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos">651</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos">652</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;one bead only&quot;</span><span class="p">)</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos">653</span></a>        <span class="k">return</span>
</span></pre></div>


            </section>
                <section id="molecule">
                            <input id="molecule-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">molecule</span>:

                <label class="view-source-button" for="molecule-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#molecule"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="molecule-21"><a href="#molecule-21"><span class="linenos"> 21</span></a><span class="k">class</span> <span class="nc">molecule</span><span class="p">:</span>
</span><span id="molecule-22"><a href="#molecule-22"><span class="linenos"> 22</span></a>    <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule-23"><a href="#molecule-23"><span class="linenos"> 23</span></a><span class="sd">    simple undirected graph representation for molecules and more.</span>
</span><span id="molecule-24"><a href="#molecule-24"><span class="linenos"> 24</span></a><span class="sd">    </span>
</span><span id="molecule-25"><a href="#molecule-25"><span class="linenos"> 25</span></a><span class="sd">    write code about molecules without the need to care about them.</span>
</span><span id="molecule-26"><a href="#molecule-26"><span class="linenos"> 26</span></a><span class="sd">    </span>
</span><span id="molecule-27"><a href="#molecule-27"><span class="linenos"> 27</span></a><span class="sd">    semantics only. Bring your own syntax.</span>
</span><span id="molecule-28"><a href="#molecule-28"><span class="linenos"> 28</span></a><span class="sd">    </span>
</span><span id="molecule-29"><a href="#molecule-29"><span class="linenos"> 29</span></a><span class="sd">    Main results are:</span>
</span><span id="molecule-30"><a href="#molecule-30"><span class="linenos"> 30</span></a><span class="sd">    - distance matrix of the molecule.</span>
</span><span id="molecule-31"><a href="#molecule-31"><span class="linenos"> 31</span></a><span class="sd">    - atom, bond, angle, torsion lists.</span>
</span><span id="molecule-32"><a href="#molecule-32"><span class="linenos"> 32</span></a>
</span><span id="molecule-33"><a href="#molecule-33"><span class="linenos"> 33</span></a><span class="sd">    YOU can use them to:</span>
</span><span id="molecule-34"><a href="#molecule-34"><span class="linenos"> 34</span></a><span class="sd">    - map force-field information onto your molecule.</span>
</span><span id="molecule-35"><a href="#molecule-35"><span class="linenos"> 35</span></a><span class="sd">    - generate inputs for templating trajectories and coordinates</span>
</span><span id="molecule-36"><a href="#molecule-36"><span class="linenos"> 36</span></a><span class="sd">    - use group contribution approaches</span>
</span><span id="molecule-37"><a href="#molecule-37"><span class="linenos"> 37</span></a><span class="sd">    - process coordinates from the PubChem-API</span>
</span><span id="molecule-38"><a href="#molecule-38"><span class="linenos"> 38</span></a>
</span><span id="molecule-39"><a href="#molecule-39"><span class="linenos"> 39</span></a><span class="sd">    Furthermore:</span>
</span><span id="molecule-40"><a href="#molecule-40"><span class="linenos"> 40</span></a><span class="sd">    - this graph-representation is quite general and not limited to molecules.</span>
</span><span id="molecule-41"><a href="#molecule-41"><span class="linenos"> 41</span></a><span class="sd">    - ...you might use it to represent your favorite baking recipes and optimize them.    </span>
</span><span id="molecule-42"><a href="#molecule-42"><span class="linenos"> 42</span></a><span class="sd">    </span>
</span><span id="molecule-43"><a href="#molecule-43"><span class="linenos"> 43</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="molecule-44"><a href="#molecule-44"><span class="linenos"> 44</span></a>
</span><span id="molecule-45"><a href="#molecule-45"><span class="linenos"> 45</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mol</span><span class="p">):</span>
</span><span id="molecule-46"><a href="#molecule-46"><span class="linenos"> 46</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule-47"><a href="#molecule-47"><span class="linenos"> 47</span></a><span class="sd">        initializes molecules based on graph-list representation.</span>
</span><span id="molecule-48"><a href="#molecule-48"><span class="linenos"> 48</span></a><span class="sd">        </span>
</span><span id="molecule-49"><a href="#molecule-49"><span class="linenos"> 49</span></a><span class="sd">        The term index (or idx) always refers to a character in the string, </span>
</span><span id="molecule-50"><a href="#molecule-50"><span class="linenos"> 50</span></a><span class="sd">        be it semantic or syntactic. Semantics and syntax of the string are </span>
</span><span id="molecule-51"><a href="#molecule-51"><span class="linenos"> 51</span></a><span class="sd">        no longer important once the bond list and thus the actual graph is </span>
</span><span id="molecule-52"><a href="#molecule-52"><span class="linenos"> 52</span></a><span class="sd">        created. Then there are only syntactic objects, i.e. atoms.</span>
</span><span id="molecule-53"><a href="#molecule-53"><span class="linenos"> 53</span></a><span class="sd">        Thus, all numbers occuring in bond, angle or torsional lists or in</span>
</span><span id="molecule-54"><a href="#molecule-54"><span class="linenos"> 54</span></a><span class="sd">        distance matrices refer to atomic numbers. Indexes and semantic lists </span>
</span><span id="molecule-55"><a href="#molecule-55"><span class="linenos"> 55</span></a><span class="sd">        are only important for advanced applications. For example, generating</span>
</span><span id="molecule-56"><a href="#molecule-56"><span class="linenos"> 56</span></a><span class="sd">        strings with the same meaning. If both options are available they are</span>
</span><span id="molecule-57"><a href="#molecule-57"><span class="linenos"> 57</span></a><span class="sd">        are marked with index/indexes/idx and number/numbers. For example:</span>
</span><span id="molecule-58"><a href="#molecule-58"><span class="linenos"> 58</span></a><span class="sd">        ring_root_numbers and ring_root_indexes.</span>
</span><span id="molecule-59"><a href="#molecule-59"><span class="linenos"> 59</span></a>
</span><span id="molecule-60"><a href="#molecule-60"><span class="linenos"> 60</span></a><span class="sd">        Parameters:</span>
</span><span id="molecule-61"><a href="#molecule-61"><span class="linenos"> 61</span></a><span class="sd">        - mol:</span>
</span><span id="molecule-62"><a href="#molecule-62"><span class="linenos"> 62</span></a><span class="sd">            - string representation of a molecule.</span>
</span><span id="molecule-63"><a href="#molecule-63"><span class="linenos"> 63</span></a><span class="sd">        </span>
</span><span id="molecule-64"><a href="#molecule-64"><span class="linenos"> 64</span></a><span class="sd">        Returns:</span>
</span><span id="molecule-65"><a href="#molecule-65"><span class="linenos"> 65</span></a><span class="sd">            nothing</span>
</span><span id="molecule-66"><a href="#molecule-66"><span class="linenos"> 66</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule-67"><a href="#molecule-67"><span class="linenos"> 67</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="molecule-68"><a href="#molecule-68"><span class="linenos"> 68</span></a>            <span class="n">mol</span> <span class="o">=</span> <span class="n">mol</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;][&quot;</span><span class="p">)</span>
</span><span id="molecule-69"><a href="#molecule-69"><span class="linenos"> 69</span></a>
</span><span id="molecule-70"><a href="#molecule-70"><span class="linenos"> 70</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">molecule</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
</span><span id="molecule-71"><a href="#molecule-71"><span class="linenos"> 71</span></a>        <span class="sd">&quot;&quot;&quot;array representation of the molecule i.e. all keys/words/whatever in a list&quot;&quot;&quot;</span>
</span><span id="molecule-72"><a href="#molecule-72"><span class="linenos"> 72</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mol</span><span class="p">))</span>  <span class="c1"># shows function</span>
</span><span id="molecule-73"><a href="#molecule-73"><span class="linenos"> 73</span></a>        <span class="sd">&quot;&quot;&quot;array with all functions. </span>
</span><span id="molecule-74"><a href="#molecule-74"><span class="linenos"> 74</span></a><span class="sd">        - branches pointing forward f &gt; 0</span>
</span><span id="molecule-75"><a href="#molecule-75"><span class="linenos"> 75</span></a><span class="sd">        - rings pointing backward f &lt; 0</span>
</span><span id="molecule-76"><a href="#molecule-76"><span class="linenos"> 76</span></a><span class="sd">        - beads without function f = 0</span>
</span><span id="molecule-77"><a href="#molecule-77"><span class="linenos"> 77</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule-78"><a href="#molecule-78"><span class="linenos"> 78</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mol</span><span class="p">))</span>  <span class="c1"># shows atomnumber</span>
</span><span id="molecule-79"><a href="#molecule-79"><span class="linenos"> 79</span></a>        <span class="sd">&quot;&quot;&quot;array with atom numbers. branches and rings n = -1 as they are no atoms&quot;&quot;&quot;</span>        
</span><span id="molecule-80"><a href="#molecule-80"><span class="linenos"> 80</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mol</span><span class="p">))</span>  <span class="c1"># shows index</span>
</span><span id="molecule-81"><a href="#molecule-81"><span class="linenos"> 81</span></a>        <span class="sd">&quot;&quot;&quot;array with indexes. atoms, branches and rings get an index&quot;&quot;&quot;</span>         
</span><span id="molecule-82"><a href="#molecule-82"><span class="linenos"> 82</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">)</span>
</span><span id="molecule-83"><a href="#molecule-83"><span class="linenos"> 83</span></a>        <span class="sd">&quot;&quot;&quot;number of all elements i.e. atoms, branches and rings&quot;&quot;&quot;</span>       
</span><span id="molecule-84"><a href="#molecule-84"><span class="linenos"> 84</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="molecule-85"><a href="#molecule-85"><span class="linenos"> 85</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
</span><span id="molecule-86"><a href="#molecule-86"><span class="linenos"> 86</span></a>            <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span>
</span><span id="molecule-87"><a href="#molecule-87"><span class="linenos"> 87</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
</span><span id="molecule-88"><a href="#molecule-88"><span class="linenos"> 88</span></a>            <span class="k">elif</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span>
</span><span id="molecule-89"><a href="#molecule-89"><span class="linenos"> 89</span></a>                <span class="c1"># dum = -int(m[1:])</span>
</span><span id="molecule-90"><a href="#molecule-90"><span class="linenos"> 90</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>  <span class="c1"># self.get_atom_index()</span>
</span><span id="molecule-91"><a href="#molecule-91"><span class="linenos"> 91</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="molecule-92"><a href="#molecule-92"><span class="linenos"> 92</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span>
</span><span id="molecule-93"><a href="#molecule-93"><span class="linenos"> 93</span></a>                <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="molecule-94"><a href="#molecule-94"><span class="linenos"> 94</span></a>
</span><span id="molecule-95"><a href="#molecule-95"><span class="linenos"> 95</span></a>        <span class="c1"># contains indexes of atoms</span>
</span><span id="molecule-96"><a href="#molecule-96"><span class="linenos"> 96</span></a>        <span class="c1"># index of atom no n: self.atom_indexes[n]</span>
</span><span id="molecule-97"><a href="#molecule-97"><span class="linenos"> 97</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">atom_indexes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="molecule-98"><a href="#molecule-98"><span class="linenos"> 98</span></a>        <span class="sd">&quot;&quot;&quot;array with indexes of all atoms&quot;&quot;&quot;</span>
</span><span id="molecule-99"><a href="#molecule-99"><span class="linenos"> 99</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">atom_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">molecule</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="molecule-100"><a href="#molecule-100"><span class="linenos">100</span></a>        <span class="sd">&quot;&quot;&quot;array with names of all atoms&quot;&quot;&quot;</span>
</span><span id="molecule-101"><a href="#molecule-101"><span class="linenos">101</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">atom_number</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_indexes</span><span class="p">)</span>
</span><span id="molecule-102"><a href="#molecule-102"><span class="linenos">102</span></a>        <span class="sd">&quot;&quot;&quot;number of all atoms&quot;&quot;&quot;</span>
</span><span id="molecule-103"><a href="#molecule-103"><span class="linenos">103</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">atom_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_number</span><span class="p">)</span>
</span><span id="molecule-104"><a href="#molecule-104"><span class="linenos">104</span></a>        <span class="sd">&quot;&quot;&quot;array with numbers of all atoms&quot;&quot;&quot;</span>
</span><span id="molecule-105"><a href="#molecule-105"><span class="linenos">105</span></a>        
</span><span id="molecule-106"><a href="#molecule-106"><span class="linenos">106</span></a>        <span class="c1"># housekeeping for get_neighbour_list (will be called later)</span>
</span><span id="molecule-107"><a href="#molecule-107"><span class="linenos">107</span></a>        <span class="c1"># (the following things are generated when calling get_neighbour_list)</span>
</span><span id="molecule-108"><a href="#molecule-108"><span class="linenos">108</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">idx_neighbour_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule-109"><a href="#molecule-109"><span class="linenos">109</span></a>        <span class="sd">&quot;&quot;&quot;array with indexes of all neighboured/bonded atoms&quot;&quot;&quot;</span>
</span><span id="molecule-110"><a href="#molecule-110"><span class="linenos">110</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">neighbour_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule-111"><a href="#molecule-111"><span class="linenos">111</span></a>        <span class="sd">&quot;&quot;&quot;array with numbers of all neighboured/bonded atoms&quot;&quot;&quot;</span>
</span><span id="molecule-112"><a href="#molecule-112"><span class="linenos">112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ring_root_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule-113"><a href="#molecule-113"><span class="linenos">113</span></a>        <span class="sd">&quot;&quot;&quot;array with indexes of all atoms rooting a ring&quot;&quot;&quot;</span>
</span><span id="molecule-114"><a href="#molecule-114"><span class="linenos">114</span></a>       
</span><span id="molecule-115"><a href="#molecule-115"><span class="linenos">115</span></a>        
</span><span id="molecule-116"><a href="#molecule-116"><span class="linenos">116</span></a>        <span class="c1"># housekeeping for get_distance_matrix (will be called later)</span>
</span><span id="molecule-117"><a href="#molecule-117"><span class="linenos">117</span></a>        <span class="c1"># (the following things are generated when calling get_distance_matrix)</span>
</span><span id="molecule-118"><a href="#molecule-118"><span class="linenos">118</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distance_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule-119"><a href="#molecule-119"><span class="linenos">119</span></a>        <span class="sd">&quot;&quot;&quot;distance matrix of all atoms in the molecule&quot;&quot;&quot;</span>
</span><span id="molecule-120"><a href="#molecule-120"><span class="linenos">120</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bond_lists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule-121"><a href="#molecule-121"><span class="linenos">121</span></a>        <span class="sd">&quot;&quot;&quot;nested array with bond lists </span>
</span><span id="molecule-122"><a href="#molecule-122"><span class="linenos">122</span></a><span class="sd">        - starting from atoms separeted by one bond bond_lists[0]</span>
</span><span id="molecule-123"><a href="#molecule-123"><span class="linenos">123</span></a><span class="sd">        - then atoms separeted by two bonds bond_lists[1] </span>
</span><span id="molecule-124"><a href="#molecule-124"><span class="linenos">124</span></a><span class="sd">        - ...</span>
</span><span id="molecule-125"><a href="#molecule-125"><span class="linenos">125</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule-126"><a href="#molecule-126"><span class="linenos">126</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">idx_bond_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule-127"><a href="#molecule-127"><span class="linenos">127</span></a>        <span class="sd">&quot;&quot;&quot;array with indexes of all neighboured/bonded atoms&quot;&quot;&quot;</span>
</span><span id="molecule-128"><a href="#molecule-128"><span class="linenos">128</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bond_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  
</span><span id="molecule-129"><a href="#molecule-129"><span class="linenos">129</span></a>        <span class="sd">&quot;&quot;&quot;array with numbers of all neighboured/bonded atoms&quot;&quot;&quot;</span>
</span><span id="molecule-130"><a href="#molecule-130"><span class="linenos">130</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bond_keys</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule-131"><a href="#molecule-131"><span class="linenos">131</span></a>        <span class="sd">&quot;&quot;&quot;array with keys of all neighboured/bonded atoms&quot;&quot;&quot;</span>
</span><span id="molecule-132"><a href="#molecule-132"><span class="linenos">132</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">angle_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule-133"><a href="#molecule-133"><span class="linenos">133</span></a>        <span class="sd">&quot;&quot;&quot;array of numbers of all angle forming atoms (separated by 2 bonds)&quot;&quot;&quot;</span>
</span><span id="molecule-134"><a href="#molecule-134"><span class="linenos">134</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">angle_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule-135"><a href="#molecule-135"><span class="linenos">135</span></a>        <span class="sd">&quot;&quot;&quot;array of names of all angle forming atoms (separated by 2 bonds)&quot;&quot;&quot;</span>
</span><span id="molecule-136"><a href="#molecule-136"><span class="linenos">136</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">angle_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule-137"><a href="#molecule-137"><span class="linenos">137</span></a>        <span class="sd">&quot;&quot;&quot;array of keys of all angle forming atoms (separated by 2 bonds)&quot;&quot;&quot;</span>
</span><span id="molecule-138"><a href="#molecule-138"><span class="linenos">138</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule-139"><a href="#molecule-139"><span class="linenos">139</span></a>        <span class="sd">&quot;&quot;&quot;array of numbers of all dihedral forming atoms (separated by 3 bonds)&quot;&quot;&quot;</span>
</span><span id="molecule-140"><a href="#molecule-140"><span class="linenos">140</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule-141"><a href="#molecule-141"><span class="linenos">141</span></a>        <span class="sd">&quot;&quot;&quot;array of names of all dihedral forming atoms (separated by 3 bonds)&quot;&quot;&quot;</span>
</span><span id="molecule-142"><a href="#molecule-142"><span class="linenos">142</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>        
</span><span id="molecule-143"><a href="#molecule-143"><span class="linenos">143</span></a>        <span class="sd">&quot;&quot;&quot;array of keys of all dihedral forming atoms (separated by 3 bonds)&quot;&quot;&quot;</span>
</span><span id="molecule-144"><a href="#molecule-144"><span class="linenos">144</span></a>
</span><span id="molecule-145"><a href="#molecule-145"><span class="linenos">145</span></a>        <span class="c1"># get bond list</span>
</span><span id="molecule-146"><a href="#molecule-146"><span class="linenos">146</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">get_neighbour_list</span><span class="p">()</span>        
</span><span id="molecule-147"><a href="#molecule-147"><span class="linenos">147</span></a>        
</span><span id="molecule-148"><a href="#molecule-148"><span class="linenos">148</span></a>        <span class="c1"># get branch ends</span>
</span><span id="molecule-149"><a href="#molecule-149"><span class="linenos">149</span></a>        <span class="n">n</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bond_list</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="molecule-150"><a href="#molecule-150"><span class="linenos">150</span></a>        <span class="n">pp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="molecule-151"><a href="#molecule-151"><span class="linenos">151</span></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="molecule-152"><a href="#molecule-152"><span class="linenos">152</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">branch_end_numbers</span> <span class="o">=</span> <span class="n">n</span><span class="p">[</span><span class="n">pp</span><span class="p">]</span>
</span><span id="molecule-153"><a href="#molecule-153"><span class="linenos">153</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">branch_end_indexes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_indexes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">branch_end_numbers</span><span class="p">]</span>
</span><span id="molecule-154"><a href="#molecule-154"><span class="linenos">154</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="molecule-155"><a href="#molecule-155"><span class="linenos">155</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">branch_end_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="molecule-156"><a href="#molecule-156"><span class="linenos">156</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">branch_end_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="molecule-157"><a href="#molecule-157"><span class="linenos">157</span></a>        <span class="c1"># get ring closures</span>
</span><span id="molecule-158"><a href="#molecule-158"><span class="linenos">158</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ring_close_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="molecule-159"><a href="#molecule-159"><span class="linenos">159</span></a>        <span class="sd">&quot;&quot;&quot;array with indexes of all atoms closing a ring&quot;&quot;&quot;</span>
</span><span id="molecule-160"><a href="#molecule-160"><span class="linenos">160</span></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ring_close_indexes</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="molecule-161"><a href="#molecule-161"><span class="linenos">161</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ring_close_numbers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ring_close_indexes</span><span class="p">]</span>
</span><span id="molecule-162"><a href="#molecule-162"><span class="linenos">162</span></a>            <span class="sd">&quot;&quot;&quot;array with atom numbers of all atoms closing a ring&quot;&quot;&quot;</span>
</span><span id="molecule-163"><a href="#molecule-163"><span class="linenos">163</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ring_root_numbers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ring_root_indexes</span><span class="p">]</span>
</span><span id="molecule-164"><a href="#molecule-164"><span class="linenos">164</span></a>            <span class="sd">&quot;&quot;&quot;array with atom numbers of all atoms rooting a ring&quot;&quot;&quot;</span>
</span><span id="molecule-165"><a href="#molecule-165"><span class="linenos">165</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="molecule-166"><a href="#molecule-166"><span class="linenos">166</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ring_close_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="molecule-167"><a href="#molecule-167"><span class="linenos">167</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ring_root_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="molecule-168"><a href="#molecule-168"><span class="linenos">168</span></a>
</span><span id="molecule-169"><a href="#molecule-169"><span class="linenos">169</span></a>        <span class="c1"># get distance matrix</span>
</span><span id="molecule-170"><a href="#molecule-170"><span class="linenos">170</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">get_distance_matrix</span><span class="p">()</span>
</span><span id="molecule-171"><a href="#molecule-171"><span class="linenos">171</span></a>
</span><span id="molecule-172"><a href="#molecule-172"><span class="linenos">172</span></a>        <span class="n">dummy</span> <span class="o">=</span> <span class="n">unique_sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_names</span><span class="p">,</span> <span class="n">return_inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="molecule-173"><a href="#molecule-173"><span class="linenos">173</span></a>        <span class="p">(</span>
</span><span id="molecule-174"><a href="#molecule-174"><span class="linenos">174</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_keys</span><span class="p">,</span>
</span><span id="molecule-175"><a href="#molecule-175"><span class="linenos">175</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_indexes</span><span class="p">,</span>
</span><span id="molecule-176"><a href="#molecule-176"><span class="linenos">176</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_inverse</span><span class="p">,</span>
</span><span id="molecule-177"><a href="#molecule-177"><span class="linenos">177</span></a>        <span class="p">)</span> <span class="o">=</span> <span class="n">dummy</span>
</span><span id="molecule-178"><a href="#molecule-178"><span class="linenos">178</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_names</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_indexes</span><span class="p">]</span>
</span><span id="molecule-179"><a href="#molecule-179"><span class="linenos">179</span></a>        <span class="sd">&quot;&quot;&quot;array with unique atom names&quot;&quot;&quot;</span>
</span><span id="molecule-180"><a href="#molecule-180"><span class="linenos">180</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_numbers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_numbers</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_indexes</span><span class="p">]</span>
</span><span id="molecule-181"><a href="#molecule-181"><span class="linenos">181</span></a>        <span class="sd">&quot;&quot;&quot;array with numbers of unique atom names&quot;&quot;&quot;</span>
</span><span id="molecule-182"><a href="#molecule-182"><span class="linenos">182</span></a>        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span>
</span><span id="molecule-183"><a href="#molecule-183"><span class="linenos">183</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_keys</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_inverse</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_names</span>
</span><span id="molecule-184"><a href="#molecule-184"><span class="linenos">184</span></a>        <span class="p">),</span> <span class="s2">&quot;unique atom in inverse doesnt work&quot;</span>
</span><span id="molecule-185"><a href="#molecule-185"><span class="linenos">185</span></a>
</span><span id="molecule-186"><a href="#molecule-186"><span class="linenos">186</span></a>        <span class="n">dummy</span> <span class="o">=</span> <span class="n">unique_sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bond_keys</span><span class="p">,</span> <span class="n">return_inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="molecule-187"><a href="#molecule-187"><span class="linenos">187</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_bond_keys</span> <span class="o">=</span> <span class="n">dummy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="molecule-188"><a href="#molecule-188"><span class="linenos">188</span></a>        <span class="sd">&quot;&quot;&quot;array with unique bond keys&quot;&quot;&quot;</span>
</span><span id="molecule-189"><a href="#molecule-189"><span class="linenos">189</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_bond_indexes</span> <span class="o">=</span> <span class="n">dummy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="molecule-190"><a href="#molecule-190"><span class="linenos">190</span></a>        <span class="sd">&quot;&quot;&quot;array with unique bond indexes&quot;&quot;&quot;</span>
</span><span id="molecule-191"><a href="#molecule-191"><span class="linenos">191</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_bond_inverse</span> <span class="o">=</span> <span class="n">dummy</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="molecule-192"><a href="#molecule-192"><span class="linenos">192</span></a>        <span class="sd">&quot;&quot;&quot;array to invert unique bonds&quot;&quot;&quot;</span>
</span><span id="molecule-193"><a href="#molecule-193"><span class="linenos">193</span></a>
</span><span id="molecule-194"><a href="#molecule-194"><span class="linenos">194</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_bond_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_names</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_bond_indexes</span><span class="p">]</span>
</span><span id="molecule-195"><a href="#molecule-195"><span class="linenos">195</span></a>        <span class="sd">&quot;&quot;&quot;array with unique bond names&quot;&quot;&quot;</span>
</span><span id="molecule-196"><a href="#molecule-196"><span class="linenos">196</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_bond_numbers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_bond_indexes</span><span class="p">]</span>
</span><span id="molecule-197"><a href="#molecule-197"><span class="linenos">197</span></a>        <span class="sd">&quot;&quot;&quot;array with numbers of unique bond names&quot;&quot;&quot;</span>
</span><span id="molecule-198"><a href="#molecule-198"><span class="linenos">198</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bond_keys</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="molecule-199"><a href="#molecule-199"><span class="linenos">199</span></a>            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span>
</span><span id="molecule-200"><a href="#molecule-200"><span class="linenos">200</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">unique_bond_keys</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_bond_inverse</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_keys</span>
</span><span id="molecule-201"><a href="#molecule-201"><span class="linenos">201</span></a>            <span class="p">),</span> <span class="s2">&quot;unique bond in inverse doesnt work&quot;</span>
</span><span id="molecule-202"><a href="#molecule-202"><span class="linenos">202</span></a>
</span><span id="molecule-203"><a href="#molecule-203"><span class="linenos">203</span></a>        <span class="n">dummy</span> <span class="o">=</span> <span class="n">unique_sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angle_keys</span><span class="p">,</span> <span class="n">return_inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="molecule-204"><a href="#molecule-204"><span class="linenos">204</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_angle_keys</span> <span class="o">=</span> <span class="n">dummy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="molecule-205"><a href="#molecule-205"><span class="linenos">205</span></a>        <span class="sd">&quot;&quot;&quot;array with unique angle keys&quot;&quot;&quot;</span>
</span><span id="molecule-206"><a href="#molecule-206"><span class="linenos">206</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_angle_indexes</span> <span class="o">=</span> <span class="n">dummy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="molecule-207"><a href="#molecule-207"><span class="linenos">207</span></a>        <span class="sd">&quot;&quot;&quot;array with unique angle indexes&quot;&quot;&quot;</span>
</span><span id="molecule-208"><a href="#molecule-208"><span class="linenos">208</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_angle_inverse</span> <span class="o">=</span> <span class="n">dummy</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="molecule-209"><a href="#molecule-209"><span class="linenos">209</span></a>        <span class="sd">&quot;&quot;&quot;array to invert unique angles&quot;&quot;&quot;</span>
</span><span id="molecule-210"><a href="#molecule-210"><span class="linenos">210</span></a>
</span><span id="molecule-211"><a href="#molecule-211"><span class="linenos">211</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_angle_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_names</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_angle_indexes</span><span class="p">]</span>
</span><span id="molecule-212"><a href="#molecule-212"><span class="linenos">212</span></a>        <span class="sd">&quot;&quot;&quot;array with unique angle names&quot;&quot;&quot;</span>
</span><span id="molecule-213"><a href="#molecule-213"><span class="linenos">213</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_angle_numbers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_angle_indexes</span><span class="p">]</span>
</span><span id="molecule-214"><a href="#molecule-214"><span class="linenos">214</span></a>        <span class="sd">&quot;&quot;&quot;array with numbers of unique angle names&quot;&quot;&quot;</span>
</span><span id="molecule-215"><a href="#molecule-215"><span class="linenos">215</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angle_keys</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="molecule-216"><a href="#molecule-216"><span class="linenos">216</span></a>            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span>
</span><span id="molecule-217"><a href="#molecule-217"><span class="linenos">217</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">unique_angle_keys</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_angle_inverse</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_keys</span>
</span><span id="molecule-218"><a href="#molecule-218"><span class="linenos">218</span></a>            <span class="p">),</span> <span class="s2">&quot;unique angle in inverse doesnt work&quot;</span>
</span><span id="molecule-219"><a href="#molecule-219"><span class="linenos">219</span></a>
</span><span id="molecule-220"><a href="#molecule-220"><span class="linenos">220</span></a>        <span class="n">dummy</span> <span class="o">=</span> <span class="n">unique_sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">torsion_keys</span><span class="p">,</span> <span class="n">return_inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="molecule-221"><a href="#molecule-221"><span class="linenos">221</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_torsion_keys</span> <span class="o">=</span> <span class="n">dummy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="molecule-222"><a href="#molecule-222"><span class="linenos">222</span></a>        <span class="sd">&quot;&quot;&quot;array with unique torsion keys&quot;&quot;&quot;</span>
</span><span id="molecule-223"><a href="#molecule-223"><span class="linenos">223</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_torsion_indexes</span> <span class="o">=</span> <span class="n">dummy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="molecule-224"><a href="#molecule-224"><span class="linenos">224</span></a>        <span class="sd">&quot;&quot;&quot;array with unique torsion indexes&quot;&quot;&quot;</span>
</span><span id="molecule-225"><a href="#molecule-225"><span class="linenos">225</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_torsion_inverse</span> <span class="o">=</span> <span class="n">dummy</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="molecule-226"><a href="#molecule-226"><span class="linenos">226</span></a>        <span class="sd">&quot;&quot;&quot;array to invert unique torsions&quot;&quot;&quot;</span>
</span><span id="molecule-227"><a href="#molecule-227"><span class="linenos">227</span></a>        
</span><span id="molecule-228"><a href="#molecule-228"><span class="linenos">228</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_torsion_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">torsion_names</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_torsion_indexes</span><span class="p">]</span>
</span><span id="molecule-229"><a href="#molecule-229"><span class="linenos">229</span></a>        <span class="sd">&quot;&quot;&quot;array with unique torsion names&quot;&quot;&quot;</span>
</span><span id="molecule-230"><a href="#molecule-230"><span class="linenos">230</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_torsion_numbers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">torsion_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_torsion_indexes</span><span class="p">]</span>
</span><span id="molecule-231"><a href="#molecule-231"><span class="linenos">231</span></a>        <span class="sd">&quot;&quot;&quot;array with numbers of unique torsion names&quot;&quot;&quot;</span>
</span><span id="molecule-232"><a href="#molecule-232"><span class="linenos">232</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">torsion_keys</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="molecule-233"><a href="#molecule-233"><span class="linenos">233</span></a>            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span>
</span><span id="molecule-234"><a href="#molecule-234"><span class="linenos">234</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">unique_torsion_keys</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_torsion_inverse</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">torsion_keys</span>
</span><span id="molecule-235"><a href="#molecule-235"><span class="linenos">235</span></a>            <span class="p">),</span> <span class="s2">&quot;unique angle in inverse doesnt work&quot;</span>
</span><span id="molecule-236"><a href="#molecule-236"><span class="linenos">236</span></a>
</span><span id="molecule-237"><a href="#molecule-237"><span class="linenos">237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_pair_names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="molecule-238"><a href="#molecule-238"><span class="linenos">238</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_pair_keys</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="molecule-239"><a href="#molecule-239"><span class="linenos">239</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">a0</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_names</span><span class="p">):</span>
</span><span id="molecule-240"><a href="#molecule-240"><span class="linenos">240</span></a>            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">a1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_names</span><span class="p">):</span>
</span><span id="molecule-241"><a href="#molecule-241"><span class="linenos">241</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">j</span><span class="p">:</span>
</span><span id="molecule-242"><a href="#molecule-242"><span class="linenos">242</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_pair_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sort_force_fields</span><span class="p">([</span><span class="n">a0</span><span class="p">,</span> <span class="n">a1</span><span class="p">]))</span>
</span><span id="molecule-243"><a href="#molecule-243"><span class="linenos">243</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_pair_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="molecule-244"><a href="#molecule-244"><span class="linenos">244</span></a>                        <span class="n">make_graph</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_pair_names</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="molecule-245"><a href="#molecule-245"><span class="linenos">245</span></a>                    <span class="p">)</span>
</span><span id="molecule-246"><a href="#molecule-246"><span class="linenos">246</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_pair_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_pair_names</span><span class="p">)</span>
</span><span id="molecule-247"><a href="#molecule-247"><span class="linenos">247</span></a>        <span class="sd">&quot;&quot;&quot;array with unique atom pair names. use them for combining rules.&quot;&quot;&quot;</span>
</span><span id="molecule-248"><a href="#molecule-248"><span class="linenos">248</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_pair_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_pair_keys</span><span class="p">)</span>
</span><span id="molecule-249"><a href="#molecule-249"><span class="linenos">249</span></a>        <span class="sd">&quot;&quot;&quot;array with unique atom pair keys. use them for combining rules.&quot;&quot;&quot;</span>
</span><span id="molecule-250"><a href="#molecule-250"><span class="linenos">250</span></a>        <span class="k">return</span>
</span><span id="molecule-251"><a href="#molecule-251"><span class="linenos">251</span></a>
</span><span id="molecule-252"><a href="#molecule-252"><span class="linenos">252</span></a>    <span class="k">def</span> <span class="nf">get_neighbour_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="molecule-253"><a href="#molecule-253"><span class="linenos">253</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule-254"><a href="#molecule-254"><span class="linenos">254</span></a><span class="sd">        generates a neighbour list from an initialized molecule</span>
</span><span id="molecule-255"><a href="#molecule-255"><span class="linenos">255</span></a>
</span><span id="molecule-256"><a href="#molecule-256"><span class="linenos">256</span></a><span class="sd">        Parameters: None</span>
</span><span id="molecule-257"><a href="#molecule-257"><span class="linenos">257</span></a>
</span><span id="molecule-258"><a href="#molecule-258"><span class="linenos">258</span></a><span class="sd">        Returns:</span>
</span><span id="molecule-259"><a href="#molecule-259"><span class="linenos">259</span></a><span class="sd">        - neighbour_list:</span>
</span><span id="molecule-260"><a href="#molecule-260"><span class="linenos">260</span></a><span class="sd">            - list of neighboured atoms containing their atom numbers.</span>
</span><span id="molecule-261"><a href="#molecule-261"><span class="linenos">261</span></a><span class="sd">        - idx_neighbour_list:</span>
</span><span id="molecule-262"><a href="#molecule-262"><span class="linenos">262</span></a><span class="sd">            - list of neighboured atoms containing their atom indexes.</span>
</span><span id="molecule-263"><a href="#molecule-263"><span class="linenos">263</span></a><span class="sd">        &quot;&quot;&quot;</span> 
</span><span id="molecule-264"><a href="#molecule-264"><span class="linenos">264</span></a>
</span><span id="molecule-265"><a href="#molecule-265"><span class="linenos">265</span></a>        <span class="n">idx_neighbour_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="molecule-266"><a href="#molecule-266"><span class="linenos">266</span></a>        <span class="n">idx_branch_ends</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="molecule-267"><a href="#molecule-267"><span class="linenos">267</span></a>        <span class="n">idx_branch_starts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="molecule-268"><a href="#molecule-268"><span class="linenos">268</span></a>        <span class="n">idx_ring_close</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="molecule-269"><a href="#molecule-269"><span class="linenos">269</span></a>        <span class="n">idx_branch_funs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="molecule-270"><a href="#molecule-270"><span class="linenos">270</span></a>
</span><span id="molecule-271"><a href="#molecule-271"><span class="linenos">271</span></a>        <span class="n">branches</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">))</span>
</span><span id="molecule-272"><a href="#molecule-272"><span class="linenos">272</span></a>        <span class="n">branch_origins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">))</span>
</span><span id="molecule-273"><a href="#molecule-273"><span class="linenos">273</span></a>        <span class="n">branch_count</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="molecule-274"><a href="#molecule-274"><span class="linenos">274</span></a>
</span><span id="molecule-275"><a href="#molecule-275"><span class="linenos">275</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_number</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="molecule-276"><a href="#molecule-276"><span class="linenos">276</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">idx_neighbour_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule-277"><a href="#molecule-277"><span class="linenos">277</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">neighbour_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule-278"><a href="#molecule-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">idx_bond_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule-279"><a href="#molecule-279"><span class="linenos">279</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">bond_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule-280"><a href="#molecule-280"><span class="linenos">280</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule-281"><a href="#molecule-281"><span class="linenos">281</span></a>
</span><span id="molecule-282"><a href="#molecule-282"><span class="linenos">282</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule-283"><a href="#molecule-283"><span class="linenos">283</span></a><span class="sd">        find branches and assign numbers.</span>
</span><span id="molecule-284"><a href="#molecule-284"><span class="linenos">284</span></a><span class="sd">        get main path through molecule.</span>
</span><span id="molecule-285"><a href="#molecule-285"><span class="linenos">285</span></a><span class="sd">        build molecule from this...</span>
</span><span id="molecule-286"><a href="#molecule-286"><span class="linenos">286</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule-287"><a href="#molecule-287"><span class="linenos">287</span></a>        <span class="n">inv_f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="molecule-288"><a href="#molecule-288"><span class="linenos">288</span></a>        <span class="n">branch_no</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="molecule-289"><a href="#molecule-289"><span class="linenos">289</span></a>        <span class="n">inv_f_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">inv_f</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)))</span>
</span><span id="molecule-290"><a href="#molecule-290"><span class="linenos">290</span></a>        <span class="n">inv_branches</span> <span class="o">=</span> <span class="n">inv_f</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="molecule-291"><a href="#molecule-291"><span class="linenos">291</span></a>        <span class="n">inv_branches</span><span class="p">[</span><span class="n">inv_branches</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="molecule-292"><a href="#molecule-292"><span class="linenos">292</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ifi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">inv_f_p</span><span class="p">,</span> <span class="n">inv_f</span><span class="p">[</span><span class="n">inv_f_p</span><span class="p">]):</span>
</span><span id="molecule-293"><a href="#molecule-293"><span class="linenos">293</span></a>            <span class="k">if</span> <span class="n">ifi</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># ring</span>
</span><span id="molecule-294"><a href="#molecule-294"><span class="linenos">294</span></a>                <span class="n">inv_branches</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="molecule-295"><a href="#molecule-295"><span class="linenos">295</span></a>            <span class="k">if</span> <span class="n">ifi</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># branch :)</span>
</span><span id="molecule-296"><a href="#molecule-296"><span class="linenos">296</span></a>                <span class="n">pp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">inv_branches</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)))</span>
</span><span id="molecule-297"><a href="#molecule-297"><span class="linenos">297</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">ifi</span><span class="p">:</span>
</span><span id="molecule-298"><a href="#molecule-298"><span class="linenos">298</span></a>                    <span class="n">p_branch</span> <span class="o">=</span> <span class="n">pp</span><span class="p">[</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="n">ifi</span><span class="p">)</span> <span class="p">:]</span>
</span><span id="molecule-299"><a href="#molecule-299"><span class="linenos">299</span></a>                    <span class="n">inv_branches</span><span class="p">[</span><span class="n">p_branch</span><span class="p">]</span> <span class="o">=</span> <span class="n">branch_no</span>
</span><span id="molecule-300"><a href="#molecule-300"><span class="linenos">300</span></a>                    <span class="n">inv_branches</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">branch_no</span>
</span><span id="molecule-301"><a href="#molecule-301"><span class="linenos">301</span></a>                    <span class="n">branch_no</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="molecule-302"><a href="#molecule-302"><span class="linenos">302</span></a>        <span class="n">branches</span> <span class="o">=</span> <span class="n">reenumerate_branches</span><span class="p">(</span><span class="n">inv_branches</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="molecule-303"><a href="#molecule-303"><span class="linenos">303</span></a>        <span class="c1"># print(branches)</span>
</span><span id="molecule-304"><a href="#molecule-304"><span class="linenos">304</span></a>
</span><span id="molecule-305"><a href="#molecule-305"><span class="linenos">305</span></a>        <span class="n">main_path_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">branches</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="molecule-306"><a href="#molecule-306"><span class="linenos">306</span></a>        <span class="n">main_path_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">[</span><span class="n">main_path_p</span><span class="p">]</span>
</span><span id="molecule-307"><a href="#molecule-307"><span class="linenos">307</span></a>
</span><span id="molecule-308"><a href="#molecule-308"><span class="linenos">308</span></a>        <span class="c1"># get bond list of main path</span>
</span><span id="molecule-309"><a href="#molecule-309"><span class="linenos">309</span></a>        <span class="n">bond_list</span> <span class="o">=</span> <span class="n">bond_list_from_simple_path</span><span class="p">(</span><span class="n">main_path_i</span><span class="p">)</span>
</span><span id="molecule-310"><a href="#molecule-310"><span class="linenos">310</span></a>        <span class="c1"># print( &quot;branches&quot;,branches )</span>
</span><span id="molecule-311"><a href="#molecule-311"><span class="linenos">311</span></a>
</span><span id="molecule-312"><a href="#molecule-312"><span class="linenos">312</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule-313"><a href="#molecule-313"><span class="linenos">313</span></a><span class="sd">        build bond list</span>
</span><span id="molecule-314"><a href="#molecule-314"><span class="linenos">314</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule-315"><a href="#molecule-315"><span class="linenos">315</span></a>        <span class="n">f_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)))</span>
</span><span id="molecule-316"><a href="#molecule-316"><span class="linenos">316</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ring_root_indexes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="molecule-317"><a href="#molecule-317"><span class="linenos">317</span></a>        <span class="c1"># print(&quot;f_p , self.f[f_p]&quot;, f_p, self.f[f_p])</span>
</span><span id="molecule-318"><a href="#molecule-318"><span class="linenos">318</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">f_p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">[</span><span class="n">f_p</span><span class="p">]):</span>
</span><span id="molecule-319"><a href="#molecule-319"><span class="linenos">319</span></a>            <span class="c1">#print(branches)</span>
</span><span id="molecule-320"><a href="#molecule-320"><span class="linenos">320</span></a>            <span class="k">if</span> <span class="n">fi</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="molecule-321"><a href="#molecule-321"><span class="linenos">321</span></a>                <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span>
</span><span id="molecule-322"><a href="#molecule-322"><span class="linenos">322</span></a>                    <span class="n">get_diff_in_bond_lists</span><span class="p">(</span><span class="n">f_p</span><span class="p">[</span><span class="n">f_p</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</span><span id="molecule-323"><a href="#molecule-323"><span class="linenos">323</span></a>                <span class="p">)</span>  <span class="c1"># index of last atom</span>
</span><span id="molecule-324"><a href="#molecule-324"><span class="linenos">324</span></a>                <span class="n">branches</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_branch_root</span><span class="p">(</span>
</span><span id="molecule-325"><a href="#molecule-325"><span class="linenos">325</span></a>                    <span class="n">branches</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">branches</span>
</span><span id="molecule-326"><a href="#molecule-326"><span class="linenos">326</span></a>                <span class="p">)</span>  <span class="c1"># connect ring to acompanying branch</span>
</span><span id="molecule-327"><a href="#molecule-327"><span class="linenos">327</span></a>                <span class="n">subgraph</span> <span class="o">=</span> <span class="n">graph_from_bonds</span><span class="p">(</span><span class="n">bond_list</span><span class="p">)</span>
</span><span id="molecule-328"><a href="#molecule-328"><span class="linenos">328</span></a>                <span class="n">path_to_main</span> <span class="o">=</span> <span class="n">get_shortest_path</span><span class="p">(</span><span class="n">subgraph</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
</span><span id="molecule-329"><a href="#molecule-329"><span class="linenos">329</span></a>
</span><span id="molecule-330"><a href="#molecule-330"><span class="linenos">330</span></a>                <span class="n">bond_list_to_main</span> <span class="o">=</span> <span class="n">bond_list_from_simple_path</span><span class="p">(</span><span class="n">path_to_main</span><span class="p">)</span>
</span><span id="molecule-331"><a href="#molecule-331"><span class="linenos">331</span></a>                <span class="n">graph_to_main</span> <span class="o">=</span> <span class="n">graph_from_bonds</span><span class="p">(</span><span class="n">bond_list_to_main</span><span class="p">)</span>
</span><span id="molecule-332"><a href="#molecule-332"><span class="linenos">332</span></a>                <span class="n">root</span> <span class="o">=</span> <span class="n">get_root</span><span class="p">(</span><span class="n">graph_to_main</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fi</span><span class="p">)))</span>
</span><span id="molecule-333"><a href="#molecule-333"><span class="linenos">333</span></a>                <span class="k">if</span> <span class="n">root</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="molecule-334"><a href="#molecule-334"><span class="linenos">334</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;root of ring outside molecule. ignore.&quot;</span><span class="p">)</span>
</span><span id="molecule-335"><a href="#molecule-335"><span class="linenos">335</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="molecule-336"><a href="#molecule-336"><span class="linenos">336</span></a>                    <span class="n">bond_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">bond_list</span><span class="p">,</span> <span class="p">[[</span><span class="n">root</span><span class="p">,</span> <span class="n">idx</span><span class="p">]]])</span>
</span><span id="molecule-337"><a href="#molecule-337"><span class="linenos">337</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">ring_root_indexes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
</span><span id="molecule-338"><a href="#molecule-338"><span class="linenos">338</span></a>            <span class="k">elif</span> <span class="n">fi</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="molecule-339"><a href="#molecule-339"><span class="linenos">339</span></a>                <span class="n">link</span> <span class="o">=</span> <span class="n">get_branch_root</span><span class="p">(</span><span class="n">branches</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">branches</span><span class="p">)</span>
</span><span id="molecule-340"><a href="#molecule-340"><span class="linenos">340</span></a>                <span class="n">branch</span> <span class="o">=</span> <span class="n">branches</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="molecule-341"><a href="#molecule-341"><span class="linenos">341</span></a>                <span class="n">p_subchain_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">branches</span> <span class="o">==</span> <span class="n">branch</span><span class="p">)))[</span>
</span><span id="molecule-342"><a href="#molecule-342"><span class="linenos">342</span></a>                    <span class="mi">1</span><span class="p">:</span>
</span><span id="molecule-343"><a href="#molecule-343"><span class="linenos">343</span></a>                <span class="p">]</span>
</span><span id="molecule-344"><a href="#molecule-344"><span class="linenos">344</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p_subchain_i</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">fi</span><span class="p">:</span>
</span><span id="molecule-345"><a href="#molecule-345"><span class="linenos">345</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;end of branch outside molecule. ignore.&quot;</span><span class="p">)</span>
</span><span id="molecule-346"><a href="#molecule-346"><span class="linenos">346</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="molecule-347"><a href="#molecule-347"><span class="linenos">347</span></a>                    <span class="n">p_subchain_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([[</span><span class="n">link</span><span class="p">],</span> <span class="n">p_subchain_i</span><span class="p">])</span>
</span><span id="molecule-348"><a href="#molecule-348"><span class="linenos">348</span></a>                    <span class="n">subchain_bond_list</span> <span class="o">=</span> <span class="n">bond_list_from_simple_path</span><span class="p">(</span><span class="n">p_subchain_i</span><span class="p">)</span>
</span><span id="molecule-349"><a href="#molecule-349"><span class="linenos">349</span></a>                    <span class="n">bond_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">bond_list</span><span class="p">,</span> <span class="n">subchain_bond_list</span><span class="p">])</span>
</span><span id="molecule-350"><a href="#molecule-350"><span class="linenos">350</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="molecule-351"><a href="#molecule-351"><span class="linenos">351</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;fi = 0... this should not happen :P&quot;</span><span class="p">)</span>
</span><span id="molecule-352"><a href="#molecule-352"><span class="linenos">352</span></a>        <span class="c1">#print(&quot;fin branches&quot;, branches)</span>
</span><span id="molecule-353"><a href="#molecule-353"><span class="linenos">353</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">idx_neighbour_list</span> <span class="o">=</span> <span class="n">bond_list</span>
</span><span id="molecule-354"><a href="#molecule-354"><span class="linenos">354</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">idx_bond_list</span> <span class="o">=</span> <span class="n">bond_list</span>
</span><span id="molecule-355"><a href="#molecule-355"><span class="linenos">355</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ring_root_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ring_root_indexes</span><span class="p">)</span>
</span><span id="molecule-356"><a href="#molecule-356"><span class="linenos">356</span></a>
</span><span id="molecule-357"><a href="#molecule-357"><span class="linenos">357</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">neighbour_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_atom_no</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">idx_neighbour_list</span><span class="p">)</span>
</span><span id="molecule-358"><a href="#molecule-358"><span class="linenos">358</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bond_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">neighbour_list</span>
</span><span id="molecule-359"><a href="#molecule-359"><span class="linenos">359</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">neighbour_list</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">idx_neighbour_list</span>
</span><span id="molecule-360"><a href="#molecule-360"><span class="linenos">360</span></a>
</span><span id="molecule-361"><a href="#molecule-361"><span class="linenos">361</span></a>    <span class="k">def</span> <span class="nf">get_bond_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="molecule-362"><a href="#molecule-362"><span class="linenos">362</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule-363"><a href="#molecule-363"><span class="linenos">363</span></a><span class="sd">        generates bond matrix from an initialized molecule</span>
</span><span id="molecule-364"><a href="#molecule-364"><span class="linenos">364</span></a>
</span><span id="molecule-365"><a href="#molecule-365"><span class="linenos">365</span></a><span class="sd">        Parameters: None</span>
</span><span id="molecule-366"><a href="#molecule-366"><span class="linenos">366</span></a>
</span><span id="molecule-367"><a href="#molecule-367"><span class="linenos">367</span></a><span class="sd">        Returns:</span>
</span><span id="molecule-368"><a href="#molecule-368"><span class="linenos">368</span></a><span class="sd">        - bond_matrix:</span>
</span><span id="molecule-369"><a href="#molecule-369"><span class="linenos">369</span></a><span class="sd">            - bond matrix of you molecule</span>
</span><span id="molecule-370"><a href="#molecule-370"><span class="linenos">370</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule-371"><a href="#molecule-371"><span class="linenos">371</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bond_matrix</span> <span class="o">=</span> <span class="n">get_bond_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">neighbour_list</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_number</span><span class="p">)</span>
</span><span id="molecule-372"><a href="#molecule-372"><span class="linenos">372</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_matrix</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="molecule-373"><a href="#molecule-373"><span class="linenos">373</span></a>
</span><span id="molecule-374"><a href="#molecule-374"><span class="linenos">374</span></a>    <span class="k">def</span> <span class="nf">get_distance_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="molecule-375"><a href="#molecule-375"><span class="linenos">375</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule-376"><a href="#molecule-376"><span class="linenos">376</span></a><span class="sd">        generates distance matrix from an initialized molecule.</span>
</span><span id="molecule-377"><a href="#molecule-377"><span class="linenos">377</span></a><span class="sd">        Furthermore different angle and torsion lists are generated.</span>
</span><span id="molecule-378"><a href="#molecule-378"><span class="linenos">378</span></a>
</span><span id="molecule-379"><a href="#molecule-379"><span class="linenos">379</span></a><span class="sd">        Parameters: None</span>
</span><span id="molecule-380"><a href="#molecule-380"><span class="linenos">380</span></a><span class="sd">        </span>
</span><span id="molecule-381"><a href="#molecule-381"><span class="linenos">381</span></a><span class="sd">        Returns:</span>
</span><span id="molecule-382"><a href="#molecule-382"><span class="linenos">382</span></a><span class="sd">        - distance_matrix:</span>
</span><span id="molecule-383"><a href="#molecule-383"><span class="linenos">383</span></a><span class="sd">            - distance matrix of you molecule</span>
</span><span id="molecule-384"><a href="#molecule-384"><span class="linenos">384</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule-385"><a href="#molecule-385"><span class="linenos">385</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distance_matrix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_lists</span> <span class="o">=</span> <span class="n">get_distance_matrix</span><span class="p">(</span>
</span><span id="molecule-386"><a href="#molecule-386"><span class="linenos">386</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">neighbour_list</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_number</span>
</span><span id="molecule-387"><a href="#molecule-387"><span class="linenos">387</span></a>        <span class="p">)</span>
</span><span id="molecule-388"><a href="#molecule-388"><span class="linenos">388</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bond_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_lists</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="molecule-389"><a href="#molecule-389"><span class="linenos">389</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bond_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="molecule-390"><a href="#molecule-390"><span class="linenos">390</span></a>            <span class="p">[</span><span class="n">sort_force_fields</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_names</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_list</span><span class="p">]</span>
</span><span id="molecule-391"><a href="#molecule-391"><span class="linenos">391</span></a>        <span class="p">)</span>
</span><span id="molecule-392"><a href="#molecule-392"><span class="linenos">392</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bond_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">make_graph</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_names</span><span class="p">])</span>
</span><span id="molecule-393"><a href="#molecule-393"><span class="linenos">393</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bond_lists</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="molecule-394"><a href="#molecule-394"><span class="linenos">394</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">angle_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bond_lists</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="molecule-395"><a href="#molecule-395"><span class="linenos">395</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">angle_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="molecule-396"><a href="#molecule-396"><span class="linenos">396</span></a>                <span class="p">[</span><span class="n">sort_force_fields</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_names</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_list</span><span class="p">]</span>
</span><span id="molecule-397"><a href="#molecule-397"><span class="linenos">397</span></a>            <span class="p">)</span>
</span><span id="molecule-398"><a href="#molecule-398"><span class="linenos">398</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">angle_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">make_graph</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_names</span><span class="p">])</span>
</span><span id="molecule-399"><a href="#molecule-399"><span class="linenos">399</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="molecule-400"><a href="#molecule-400"><span class="linenos">400</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">angle_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule-401"><a href="#molecule-401"><span class="linenos">401</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">angle_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule-402"><a href="#molecule-402"><span class="linenos">402</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">angle_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule-403"><a href="#molecule-403"><span class="linenos">403</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bond_lists</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="molecule-404"><a href="#molecule-404"><span class="linenos">404</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">torsion_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bond_lists</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="molecule-405"><a href="#molecule-405"><span class="linenos">405</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">torsion_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="molecule-406"><a href="#molecule-406"><span class="linenos">406</span></a>                <span class="p">[</span><span class="n">sort_force_fields</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_names</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">torsion_list</span><span class="p">]</span>
</span><span id="molecule-407"><a href="#molecule-407"><span class="linenos">407</span></a>            <span class="p">)</span>
</span><span id="molecule-408"><a href="#molecule-408"><span class="linenos">408</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">torsion_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">make_graph</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">torsion_names</span><span class="p">])</span>
</span><span id="molecule-409"><a href="#molecule-409"><span class="linenos">409</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="molecule-410"><a href="#molecule-410"><span class="linenos">410</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">torsion_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule-411"><a href="#molecule-411"><span class="linenos">411</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">torsion_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule-412"><a href="#molecule-412"><span class="linenos">412</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">torsion_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule-413"><a href="#molecule-413"><span class="linenos">413</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance_matrix</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="molecule-414"><a href="#molecule-414"><span class="linenos">414</span></a>
</span><span id="molecule-415"><a href="#molecule-415"><span class="linenos">415</span></a>    <span class="k">def</span> <span class="nf">get_atom_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">no</span><span class="p">):</span>
</span><span id="molecule-416"><a href="#molecule-416"><span class="linenos">416</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule-417"><a href="#molecule-417"><span class="linenos">417</span></a><span class="sd">        returns index of atom.</span>
</span><span id="molecule-418"><a href="#molecule-418"><span class="linenos">418</span></a><span class="sd">        - Number: atom number</span>
</span><span id="molecule-419"><a href="#molecule-419"><span class="linenos">419</span></a><span class="sd">        - Index:  index in list representation of molecule.</span>
</span><span id="molecule-420"><a href="#molecule-420"><span class="linenos">420</span></a><span class="sd">        Number and index are differing due to functionals in the list.</span>
</span><span id="molecule-421"><a href="#molecule-421"><span class="linenos">421</span></a>
</span><span id="molecule-422"><a href="#molecule-422"><span class="linenos">422</span></a><span class="sd">        Parameters:</span>
</span><span id="molecule-423"><a href="#molecule-423"><span class="linenos">423</span></a><span class="sd">        - no:</span>
</span><span id="molecule-424"><a href="#molecule-424"><span class="linenos">424</span></a><span class="sd">           - number of the atom</span>
</span><span id="molecule-425"><a href="#molecule-425"><span class="linenos">425</span></a><span class="sd">           </span>
</span><span id="molecule-426"><a href="#molecule-426"><span class="linenos">426</span></a><span class="sd">        Returns:</span>
</span><span id="molecule-427"><a href="#molecule-427"><span class="linenos">427</span></a><span class="sd">        - index of atom number &quot;no&quot;</span>
</span><span id="molecule-428"><a href="#molecule-428"><span class="linenos">428</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule-429"><a href="#molecule-429"><span class="linenos">429</span></a>        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_indexes</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">no</span><span class="p">)])</span>  <span class="c1"># int(np.squeeze(np.where(self.n==no)))</span>
</span><span id="molecule-430"><a href="#molecule-430"><span class="linenos">430</span></a>
</span><span id="molecule-431"><a href="#molecule-431"><span class="linenos">431</span></a>    <span class="k">def</span> <span class="nf">get_atom_no</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
</span><span id="molecule-432"><a href="#molecule-432"><span class="linenos">432</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule-433"><a href="#molecule-433"><span class="linenos">433</span></a><span class="sd">        returns index of atom.</span>
</span><span id="molecule-434"><a href="#molecule-434"><span class="linenos">434</span></a><span class="sd">        - Number: atom number</span>
</span><span id="molecule-435"><a href="#molecule-435"><span class="linenos">435</span></a><span class="sd">        - Index:  index in list representation of molecule.</span>
</span><span id="molecule-436"><a href="#molecule-436"><span class="linenos">436</span></a><span class="sd">        Number and index are differing due to functionals in the list.</span>
</span><span id="molecule-437"><a href="#molecule-437"><span class="linenos">437</span></a>
</span><span id="molecule-438"><a href="#molecule-438"><span class="linenos">438</span></a><span class="sd">        Parameters:</span>
</span><span id="molecule-439"><a href="#molecule-439"><span class="linenos">439</span></a><span class="sd">        - idx:</span>
</span><span id="molecule-440"><a href="#molecule-440"><span class="linenos">440</span></a><span class="sd">            - idx of the atom</span>
</span><span id="molecule-441"><a href="#molecule-441"><span class="linenos">441</span></a><span class="sd">            </span>
</span><span id="molecule-442"><a href="#molecule-442"><span class="linenos">442</span></a><span class="sd">        Returns:</span>
</span><span id="molecule-443"><a href="#molecule-443"><span class="linenos">443</span></a><span class="sd">        - number of atom with index</span>
</span><span id="molecule-444"><a href="#molecule-444"><span class="linenos">444</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule-445"><a href="#molecule-445"><span class="linenos">445</span></a>        <span class="n">idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
</span><span id="molecule-446"><a href="#molecule-446"><span class="linenos">446</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="molecule-447"><a href="#molecule-447"><span class="linenos">447</span></a>            <span class="n">no</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_indexes</span> <span class="o">==</span> <span class="n">idx</span><span class="p">)))</span>
</span><span id="molecule-448"><a href="#molecule-448"><span class="linenos">448</span></a>            <span class="k">assert</span> <span class="n">no</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="s2">&quot;atom numbers dont work&quot;</span>
</span><span id="molecule-449"><a href="#molecule-449"><span class="linenos">449</span></a>            <span class="k">return</span> <span class="n">no</span>
</span><span id="molecule-450"><a href="#molecule-450"><span class="linenos">450</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="molecule-451"><a href="#molecule-451"><span class="linenos">451</span></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;atom numbers dont work&quot;</span>
</span><span id="molecule-452"><a href="#molecule-452"><span class="linenos">452</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error in get_atom_no: not an atom&quot;</span><span class="p">)</span>
</span><span id="molecule-453"><a href="#molecule-453"><span class="linenos">453</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="molecule-454"><a href="#molecule-454"><span class="linenos">454</span></a>
</span><span id="molecule-455"><a href="#molecule-455"><span class="linenos">455</span></a>    <span class="k">def</span> <span class="nf">get_next_atom_idx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
</span><span id="molecule-456"><a href="#molecule-456"><span class="linenos">456</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule-457"><a href="#molecule-457"><span class="linenos">457</span></a><span class="sd">        returns index of the next atom after index idx.</span>
</span><span id="molecule-458"><a href="#molecule-458"><span class="linenos">458</span></a><span class="sd">        Index:  index in list representation of molecule.</span>
</span><span id="molecule-459"><a href="#molecule-459"><span class="linenos">459</span></a><span class="sd">        Number and index are differing due to functionals in the list.</span>
</span><span id="molecule-460"><a href="#molecule-460"><span class="linenos">460</span></a>
</span><span id="molecule-461"><a href="#molecule-461"><span class="linenos">461</span></a><span class="sd">        Parameters:</span>
</span><span id="molecule-462"><a href="#molecule-462"><span class="linenos">462</span></a><span class="sd">        idx:</span>
</span><span id="molecule-463"><a href="#molecule-463"><span class="linenos">463</span></a><span class="sd">            - index in list representation of molecule</span>
</span><span id="molecule-464"><a href="#molecule-464"><span class="linenos">464</span></a><span class="sd">            </span>
</span><span id="molecule-465"><a href="#molecule-465"><span class="linenos">465</span></a><span class="sd">        Returns:</span>
</span><span id="molecule-466"><a href="#molecule-466"><span class="linenos">466</span></a><span class="sd">        - index of the next atom after index idx</span>
</span><span id="molecule-467"><a href="#molecule-467"><span class="linenos">467</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule-468"><a href="#molecule-468"><span class="linenos">468</span></a>        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_indexes</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_indexes</span> <span class="o">-</span> <span class="n">idx</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]))</span>
</span><span id="molecule-469"><a href="#molecule-469"><span class="linenos">469</span></a>
</span><span id="molecule-470"><a href="#molecule-470"><span class="linenos">470</span></a>    <span class="k">def</span> <span class="nf">get_last_atom_idx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
</span><span id="molecule-471"><a href="#molecule-471"><span class="linenos">471</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule-472"><a href="#molecule-472"><span class="linenos">472</span></a><span class="sd">        returns index of the atom before index idx.</span>
</span><span id="molecule-473"><a href="#molecule-473"><span class="linenos">473</span></a><span class="sd">        Index:  index in list representation of molecule.</span>
</span><span id="molecule-474"><a href="#molecule-474"><span class="linenos">474</span></a><span class="sd">        Number and index are differing due to functionals in the list.</span>
</span><span id="molecule-475"><a href="#molecule-475"><span class="linenos">475</span></a>
</span><span id="molecule-476"><a href="#molecule-476"><span class="linenos">476</span></a><span class="sd">        Parameters:</span>
</span><span id="molecule-477"><a href="#molecule-477"><span class="linenos">477</span></a><span class="sd">        idx:</span>
</span><span id="molecule-478"><a href="#molecule-478"><span class="linenos">478</span></a><span class="sd">            - index in list representation of molecule</span>
</span><span id="molecule-479"><a href="#molecule-479"><span class="linenos">479</span></a><span class="sd">            </span>
</span><span id="molecule-480"><a href="#molecule-480"><span class="linenos">480</span></a><span class="sd">        Returns:</span>
</span><span id="molecule-481"><a href="#molecule-481"><span class="linenos">481</span></a><span class="sd">        - index of the atom before index idx</span>
</span><span id="molecule-482"><a href="#molecule-482"><span class="linenos">482</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule-483"><a href="#molecule-483"><span class="linenos">483</span></a>        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_indexes</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_indexes</span> <span class="o">-</span> <span class="n">idx</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]))</span>
</span><span id="molecule-484"><a href="#molecule-484"><span class="linenos">484</span></a>
</span><span id="molecule-485"><a href="#molecule-485"><span class="linenos">485</span></a>    <span class="k">def</span> <span class="nf">get_next_atom_no</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
</span><span id="molecule-486"><a href="#molecule-486"><span class="linenos">486</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule-487"><a href="#molecule-487"><span class="linenos">487</span></a><span class="sd">        returns number of the atom after index idx.</span>
</span><span id="molecule-488"><a href="#molecule-488"><span class="linenos">488</span></a><span class="sd">        Index:  index in list representation of molecule.</span>
</span><span id="molecule-489"><a href="#molecule-489"><span class="linenos">489</span></a><span class="sd">        Number: atom number</span>
</span><span id="molecule-490"><a href="#molecule-490"><span class="linenos">490</span></a><span class="sd">        Number and index are differing due to functionals in the list.</span>
</span><span id="molecule-491"><a href="#molecule-491"><span class="linenos">491</span></a>
</span><span id="molecule-492"><a href="#molecule-492"><span class="linenos">492</span></a><span class="sd">        Parameters:</span>
</span><span id="molecule-493"><a href="#molecule-493"><span class="linenos">493</span></a><span class="sd">        - idx:</span>
</span><span id="molecule-494"><a href="#molecule-494"><span class="linenos">494</span></a><span class="sd">            - index in list representation of molecule</span>
</span><span id="molecule-495"><a href="#molecule-495"><span class="linenos">495</span></a><span class="sd">            </span>
</span><span id="molecule-496"><a href="#molecule-496"><span class="linenos">496</span></a><span class="sd">        Returns:</span>
</span><span id="molecule-497"><a href="#molecule-497"><span class="linenos">497</span></a><span class="sd">        - number of the atom after index idx</span>
</span><span id="molecule-498"><a href="#molecule-498"><span class="linenos">498</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule-499"><a href="#molecule-499"><span class="linenos">499</span></a>        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_next_atom_idx</span><span class="p">(</span><span class="n">idx</span><span class="p">)])</span>
</span><span id="molecule-500"><a href="#molecule-500"><span class="linenos">500</span></a>
</span><span id="molecule-501"><a href="#molecule-501"><span class="linenos">501</span></a>    <span class="k">def</span> <span class="nf">get_last_atom_no</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
</span><span id="molecule-502"><a href="#molecule-502"><span class="linenos">502</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule-503"><a href="#molecule-503"><span class="linenos">503</span></a><span class="sd">        returns number of the atom before index idx.</span>
</span><span id="molecule-504"><a href="#molecule-504"><span class="linenos">504</span></a><span class="sd">        Index:  index in list representation of molecule.</span>
</span><span id="molecule-505"><a href="#molecule-505"><span class="linenos">505</span></a><span class="sd">        Number: atom number</span>
</span><span id="molecule-506"><a href="#molecule-506"><span class="linenos">506</span></a><span class="sd">        Number and index are differing due to functionals in the list.</span>
</span><span id="molecule-507"><a href="#molecule-507"><span class="linenos">507</span></a>
</span><span id="molecule-508"><a href="#molecule-508"><span class="linenos">508</span></a><span class="sd">        Parameters:</span>
</span><span id="molecule-509"><a href="#molecule-509"><span class="linenos">509</span></a><span class="sd">            self:</span>
</span><span id="molecule-510"><a href="#molecule-510"><span class="linenos">510</span></a><span class="sd">                - initialized molecule.</span>
</span><span id="molecule-511"><a href="#molecule-511"><span class="linenos">511</span></a><span class="sd">            idx:</span>
</span><span id="molecule-512"><a href="#molecule-512"><span class="linenos">512</span></a><span class="sd">                - index in list representation of molecule</span>
</span><span id="molecule-513"><a href="#molecule-513"><span class="linenos">513</span></a><span class="sd">                </span>
</span><span id="molecule-514"><a href="#molecule-514"><span class="linenos">514</span></a><span class="sd">        Returns:</span>
</span><span id="molecule-515"><a href="#molecule-515"><span class="linenos">515</span></a><span class="sd">            number of the atom before index idx</span>
</span><span id="molecule-516"><a href="#molecule-516"><span class="linenos">516</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule-517"><a href="#molecule-517"><span class="linenos">517</span></a>        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_last_atom_idx</span><span class="p">(</span><span class="n">idx</span><span class="p">)])</span>
</span><span id="molecule-518"><a href="#molecule-518"><span class="linenos">518</span></a>
</span><span id="molecule-519"><a href="#molecule-519"><span class="linenos">519</span></a>    <span class="k">def</span> <span class="nf">map_molecule_via_atom_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="molecule-520"><a href="#molecule-520"><span class="linenos">520</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule-521"><a href="#molecule-521"><span class="linenos">521</span></a><span class="sd">        maps information from a dictionary onto the molecule.</span>
</span><span id="molecule-522"><a href="#molecule-522"><span class="linenos">522</span></a><span class="sd">        Use this for molecule information i.e. coordinates, group contributions,...</span>
</span><span id="molecule-523"><a href="#molecule-523"><span class="linenos">523</span></a>
</span><span id="molecule-524"><a href="#molecule-524"><span class="linenos">524</span></a><span class="sd">        Parameters:</span>
</span><span id="molecule-525"><a href="#molecule-525"><span class="linenos">525</span></a><span class="sd">        - data:</span>
</span><span id="molecule-526"><a href="#molecule-526"><span class="linenos">526</span></a><span class="sd">            - dictionary with: keys == atom names !!!</span>
</span><span id="molecule-527"><a href="#molecule-527"><span class="linenos">527</span></a><span class="sd">            </span>
</span><span id="molecule-528"><a href="#molecule-528"><span class="linenos">528</span></a><span class="sd">        Returns:</span>
</span><span id="molecule-529"><a href="#molecule-529"><span class="linenos">529</span></a><span class="sd">        - mapped data</span>
</span><span id="molecule-530"><a href="#molecule-530"><span class="linenos">530</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule-531"><a href="#molecule-531"><span class="linenos">531</span></a>        <span class="k">return</span> <span class="p">[</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_names</span><span class="p">)]</span>
</span><span id="molecule-532"><a href="#molecule-532"><span class="linenos">532</span></a>
</span><span id="molecule-533"><a href="#molecule-533"><span class="linenos">533</span></a>    <span class="k">def</span> <span class="nf">map_unique_via_atom_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="molecule-534"><a href="#molecule-534"><span class="linenos">534</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule-535"><a href="#molecule-535"><span class="linenos">535</span></a><span class="sd">        Maps information from a dictionary onto unique elements of the molecule.</span>
</span><span id="molecule-536"><a href="#molecule-536"><span class="linenos">536</span></a><span class="sd">        Preserves the order of the original list.</span>
</span><span id="molecule-537"><a href="#molecule-537"><span class="linenos">537</span></a><span class="sd">        Use this for force-field information i.e. potentials,...</span>
</span><span id="molecule-538"><a href="#molecule-538"><span class="linenos">538</span></a>
</span><span id="molecule-539"><a href="#molecule-539"><span class="linenos">539</span></a><span class="sd">        Parameters:</span>
</span><span id="molecule-540"><a href="#molecule-540"><span class="linenos">540</span></a><span class="sd">        - data:</span>
</span><span id="molecule-541"><a href="#molecule-541"><span class="linenos">541</span></a><span class="sd">            - dictionary with: keys == atom names !!!</span>
</span><span id="molecule-542"><a href="#molecule-542"><span class="linenos">542</span></a><span class="sd">            </span>
</span><span id="molecule-543"><a href="#molecule-543"><span class="linenos">543</span></a><span class="sd">        Returns:</span>
</span><span id="molecule-544"><a href="#molecule-544"><span class="linenos">544</span></a><span class="sd">        - mapped unique data</span>
</span><span id="molecule-545"><a href="#molecule-545"><span class="linenos">545</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule-546"><a href="#molecule-546"><span class="linenos">546</span></a>        <span class="nb">print</span><span class="p">(</span>
</span><span id="molecule-547"><a href="#molecule-547"><span class="linenos">547</span></a>            <span class="s2">&quot;map_unique_via_atom_names is outtdated... dont use</span><span class="se">\n</span><span class="s2"> shouldnt cause errors btw&quot;</span>
</span><span id="molecule-548"><a href="#molecule-548"><span class="linenos">548</span></a>        <span class="p">)</span>
</span><span id="molecule-549"><a href="#molecule-549"><span class="linenos">549</span></a>        <span class="k">return</span> <span class="p">[</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_names</span><span class="p">)]</span>
</span><span id="molecule-550"><a href="#molecule-550"><span class="linenos">550</span></a>
</span><span id="molecule-551"><a href="#molecule-551"><span class="linenos">551</span></a>    <span class="k">def</span> <span class="nf">map_molecule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">goal</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="molecule-552"><a href="#molecule-552"><span class="linenos">552</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule-553"><a href="#molecule-553"><span class="linenos">553</span></a><span class="sd">        maps information from a dictionary onto a goal.</span>
</span><span id="molecule-554"><a href="#molecule-554"><span class="linenos">554</span></a><span class="sd">        Use this for molecule information i.e. coordinates, group contributions,...</span>
</span><span id="molecule-555"><a href="#molecule-555"><span class="linenos">555</span></a>
</span><span id="molecule-556"><a href="#molecule-556"><span class="linenos">556</span></a>
</span><span id="molecule-557"><a href="#molecule-557"><span class="linenos">557</span></a><span class="sd">        Parameters:</span>
</span><span id="molecule-558"><a href="#molecule-558"><span class="linenos">558</span></a><span class="sd">        - goal:</span>
</span><span id="molecule-559"><a href="#molecule-559"><span class="linenos">559</span></a><span class="sd">            - list of keys</span>
</span><span id="molecule-560"><a href="#molecule-560"><span class="linenos">560</span></a><span class="sd">        - data:</span>
</span><span id="molecule-561"><a href="#molecule-561"><span class="linenos">561</span></a><span class="sd">            - dictionary with keys in goal</span>
</span><span id="molecule-562"><a href="#molecule-562"><span class="linenos">562</span></a><span class="sd">            </span>
</span><span id="molecule-563"><a href="#molecule-563"><span class="linenos">563</span></a><span class="sd">        Returns:</span>
</span><span id="molecule-564"><a href="#molecule-564"><span class="linenos">564</span></a><span class="sd">        - mapped data</span>
</span><span id="molecule-565"><a href="#molecule-565"><span class="linenos">565</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule-566"><a href="#molecule-566"><span class="linenos">566</span></a>        <span class="k">return</span> <span class="p">[</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="n">goal</span><span class="p">)]</span>
</span><span id="molecule-567"><a href="#molecule-567"><span class="linenos">567</span></a>
</span><span id="molecule-568"><a href="#molecule-568"><span class="linenos">568</span></a>    <span class="k">def</span> <span class="nf">map_unique</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">goal</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="molecule-569"><a href="#molecule-569"><span class="linenos">569</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule-570"><a href="#molecule-570"><span class="linenos">570</span></a><span class="sd">        Maps information from a dictionary onto unique elements a goal.</span>
</span><span id="molecule-571"><a href="#molecule-571"><span class="linenos">571</span></a><span class="sd">        Preserves the order of the original list.</span>
</span><span id="molecule-572"><a href="#molecule-572"><span class="linenos">572</span></a><span class="sd">        Use this for force-field information i.e. potentials,...</span>
</span><span id="molecule-573"><a href="#molecule-573"><span class="linenos">573</span></a>
</span><span id="molecule-574"><a href="#molecule-574"><span class="linenos">574</span></a><span class="sd">        Parameters:</span>
</span><span id="molecule-575"><a href="#molecule-575"><span class="linenos">575</span></a><span class="sd">        - goal:</span>
</span><span id="molecule-576"><a href="#molecule-576"><span class="linenos">576</span></a><span class="sd">            - list of keys</span>
</span><span id="molecule-577"><a href="#molecule-577"><span class="linenos">577</span></a><span class="sd">        - data:</span>
</span><span id="molecule-578"><a href="#molecule-578"><span class="linenos">578</span></a><span class="sd">            - dictionary with keys in goal</span>
</span><span id="molecule-579"><a href="#molecule-579"><span class="linenos">579</span></a><span class="sd">            </span>
</span><span id="molecule-580"><a href="#molecule-580"><span class="linenos">580</span></a><span class="sd">        Returns:</span>
</span><span id="molecule-581"><a href="#molecule-581"><span class="linenos">581</span></a><span class="sd">        - mapped unique data</span>
</span><span id="molecule-582"><a href="#molecule-582"><span class="linenos">582</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule-583"><a href="#molecule-583"><span class="linenos">583</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;map_unique is outtdated... dont use</span><span class="se">\n</span><span class="s2"> shouldnt cause errors btw&quot;</span><span class="p">)</span>
</span><span id="molecule-584"><a href="#molecule-584"><span class="linenos">584</span></a>        <span class="k">return</span> <span class="p">[</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="n">unique_sort</span><span class="p">(</span><span class="n">goal</span><span class="p">))]</span>
</span><span id="molecule-585"><a href="#molecule-585"><span class="linenos">585</span></a>
</span><span id="molecule-586"><a href="#molecule-586"><span class="linenos">586</span></a>    <span class="k">def</span> <span class="nf">map_nested</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">goal</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="molecule-587"><a href="#molecule-587"><span class="linenos">587</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule-588"><a href="#molecule-588"><span class="linenos">588</span></a><span class="sd">        Maps information from a dictionary onto nested elements of a goal.</span>
</span><span id="molecule-589"><a href="#molecule-589"><span class="linenos">589</span></a><span class="sd">        Preserves the order of the original list.</span>
</span><span id="molecule-590"><a href="#molecule-590"><span class="linenos">590</span></a><span class="sd">        Use this for advanced force-field information i.e. mixing rules,...</span>
</span><span id="molecule-591"><a href="#molecule-591"><span class="linenos">591</span></a>
</span><span id="molecule-592"><a href="#molecule-592"><span class="linenos">592</span></a><span class="sd">        same as:</span>
</span><span id="molecule-593"><a href="#molecule-593"><span class="linenos">593</span></a><span class="sd">        [ self.map_unique( m, data) for m in goal ]</span>
</span><span id="molecule-594"><a href="#molecule-594"><span class="linenos">594</span></a>
</span><span id="molecule-595"><a href="#molecule-595"><span class="linenos">595</span></a><span class="sd">        Parameters:</span>
</span><span id="molecule-596"><a href="#molecule-596"><span class="linenos">596</span></a><span class="sd">        - goal:</span>
</span><span id="molecule-597"><a href="#molecule-597"><span class="linenos">597</span></a><span class="sd">            -with list list of keys</span>
</span><span id="molecule-598"><a href="#molecule-598"><span class="linenos">598</span></a><span class="sd">        - data:</span>
</span><span id="molecule-599"><a href="#molecule-599"><span class="linenos">599</span></a><span class="sd">            -dictionary with keys in goal</span>
</span><span id="molecule-600"><a href="#molecule-600"><span class="linenos">600</span></a><span class="sd">            </span>
</span><span id="molecule-601"><a href="#molecule-601"><span class="linenos">601</span></a><span class="sd">        Returns:</span>
</span><span id="molecule-602"><a href="#molecule-602"><span class="linenos">602</span></a><span class="sd">        - mapped unique data</span>
</span><span id="molecule-603"><a href="#molecule-603"><span class="linenos">603</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule-604"><a href="#molecule-604"><span class="linenos">604</span></a>        <span class="k">return</span> <span class="p">[[</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="n">m</span><span class="p">)]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">goal</span><span class="p">]</span>
</span><span id="molecule-605"><a href="#molecule-605"><span class="linenos">605</span></a>
</span><span id="molecule-606"><a href="#molecule-606"><span class="linenos">606</span></a>    <span class="k">def</span> <span class="nf">get_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="molecule-607"><a href="#molecule-607"><span class="linenos">607</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule-608"><a href="#molecule-608"><span class="linenos">608</span></a><span class="sd">        Returns distance between atoms no x and y</span>
</span><span id="molecule-609"><a href="#molecule-609"><span class="linenos">609</span></a><span class="sd">        0: same atom i.e. x==y</span>
</span><span id="molecule-610"><a href="#molecule-610"><span class="linenos">610</span></a><span class="sd">        1: bond</span>
</span><span id="molecule-611"><a href="#molecule-611"><span class="linenos">611</span></a><span class="sd">        2: angle</span>
</span><span id="molecule-612"><a href="#molecule-612"><span class="linenos">612</span></a><span class="sd">        3: torsion</span>
</span><span id="molecule-613"><a href="#molecule-613"><span class="linenos">613</span></a>
</span><span id="molecule-614"><a href="#molecule-614"><span class="linenos">614</span></a><span class="sd">        Parameters:</span>
</span><span id="molecule-615"><a href="#molecule-615"><span class="linenos">615</span></a><span class="sd">        - x,y:</span>
</span><span id="molecule-616"><a href="#molecule-616"><span class="linenos">616</span></a><span class="sd">            - atom numbers</span>
</span><span id="molecule-617"><a href="#molecule-617"><span class="linenos">617</span></a><span class="sd">            </span>
</span><span id="molecule-618"><a href="#molecule-618"><span class="linenos">618</span></a><span class="sd">        Returns:</span>
</span><span id="molecule-619"><a href="#molecule-619"><span class="linenos">619</span></a><span class="sd">        - distance</span>
</span><span id="molecule-620"><a href="#molecule-620"><span class="linenos">620</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule-621"><a href="#molecule-621"><span class="linenos">621</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance_matrix</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)][</span><span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)]</span>
</span><span id="molecule-622"><a href="#molecule-622"><span class="linenos">622</span></a>
</span><span id="molecule-623"><a href="#molecule-623"><span class="linenos">623</span></a>    <span class="k">def</span> <span class="nf">get_sorted_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="molecule-624"><a href="#molecule-624"><span class="linenos">624</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule-625"><a href="#molecule-625"><span class="linenos">625</span></a><span class="sd">        Sorts a list alphabetically.</span>
</span><span id="molecule-626"><a href="#molecule-626"><span class="linenos">626</span></a><span class="sd">        Very important for dictionary keys in the molecule class!!!</span>
</span><span id="molecule-627"><a href="#molecule-627"><span class="linenos">627</span></a>
</span><span id="molecule-628"><a href="#molecule-628"><span class="linenos">628</span></a><span class="sd">        Parameters:</span>
</span><span id="molecule-629"><a href="#molecule-629"><span class="linenos">629</span></a><span class="sd">        - x:</span>
</span><span id="molecule-630"><a href="#molecule-630"><span class="linenos">630</span></a><span class="sd">            - string list to sort</span>
</span><span id="molecule-631"><a href="#molecule-631"><span class="linenos">631</span></a><span class="sd">            </span>
</span><span id="molecule-632"><a href="#molecule-632"><span class="linenos">632</span></a><span class="sd">        Returns:</span>
</span><span id="molecule-633"><a href="#molecule-633"><span class="linenos">633</span></a><span class="sd">        - key (string) and sorted list</span>
</span><span id="molecule-634"><a href="#molecule-634"><span class="linenos">634</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule-635"><a href="#molecule-635"><span class="linenos">635</span></a>        <span class="n">x_sort</span> <span class="o">=</span> <span class="n">sort_force_fields</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="molecule-636"><a href="#molecule-636"><span class="linenos">636</span></a>        <span class="k">return</span> <span class="n">make_graph</span><span class="p">(</span><span class="n">x_sort</span><span class="p">),</span> <span class="n">x_sort</span>
</span><span id="molecule-637"><a href="#molecule-637"><span class="linenos">637</span></a>
</span><span id="molecule-638"><a href="#molecule-638"><span class="linenos">638</span></a>    <span class="k">def</span> <span class="nf">visualize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">saveto</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
</span><span id="molecule-639"><a href="#molecule-639"><span class="linenos">639</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule-640"><a href="#molecule-640"><span class="linenos">640</span></a><span class="sd">        plots and visualizes molecule</span>
</span><span id="molecule-641"><a href="#molecule-641"><span class="linenos">641</span></a><span class="sd">        </span>
</span><span id="molecule-642"><a href="#molecule-642"><span class="linenos">642</span></a><span class="sd">        Parameters:</span>
</span><span id="molecule-643"><a href="#molecule-643"><span class="linenos">643</span></a><span class="sd">        - saveto:</span>
</span><span id="molecule-644"><a href="#molecule-644"><span class="linenos">644</span></a><span class="sd">            - optional, location to save pic of graph to,</span>
</span><span id="molecule-645"><a href="#molecule-645"><span class="linenos">645</span></a><span class="sd">            - add file format at the end ;)</span>
</span><span id="molecule-646"><a href="#molecule-646"><span class="linenos">646</span></a><span class="sd">            </span>
</span><span id="molecule-647"><a href="#molecule-647"><span class="linenos">647</span></a><span class="sd">        Returns:</span>
</span><span id="molecule-648"><a href="#molecule-648"><span class="linenos">648</span></a><span class="sd">            nothing</span>
</span><span id="molecule-649"><a href="#molecule-649"><span class="linenos">649</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule-650"><a href="#molecule-650"><span class="linenos">650</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_numbers</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="molecule-651"><a href="#molecule-651"><span class="linenos">651</span></a>            <span class="n">plot_graph</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_list</span><span class="p">,</span> <span class="n">saveto</span><span class="o">=</span><span class="n">saveto</span><span class="p">)</span>
</span><span id="molecule-652"><a href="#molecule-652"><span class="linenos">652</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="molecule-653"><a href="#molecule-653"><span class="linenos">653</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;one bead only&quot;</span><span class="p">)</span>
</span><span id="molecule-654"><a href="#molecule-654"><span class="linenos">654</span></a>        <span class="k">return</span>
</span></pre></div>


            <div class="docstring"><p>simple undirected graph representation for molecules and more.</p>

<p>write code about molecules without the need to care about them.</p>

<p>semantics only. Bring your own syntax.</p>

<p>Main results are:</p>

<ul>
<li>distance matrix of the molecule.</li>
<li>atom, bond, angle, torsion lists.</li>
</ul>

<p>YOU can use them to:</p>

<ul>
<li>map force-field information onto your molecule.</li>
<li>generate inputs for templating trajectories and coordinates</li>
<li>use group contribution approaches</li>
<li>process coordinates from the PubChem-API</li>
</ul>

<p>Furthermore:</p>

<ul>
<li>this graph-representation is quite general and not limited to molecules.</li>
<li>...you might use it to represent your favorite baking recipes and optimize them.</li>
</ul>
</div>


                            <div id="molecule.__init__" class="classattr">
                                        <input id="molecule.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">molecule</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">mol</span></span>)</span>

                <label class="view-source-button" for="molecule.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#molecule.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="molecule.__init__-45"><a href="#molecule.__init__-45"><span class="linenos"> 45</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mol</span><span class="p">):</span>
</span><span id="molecule.__init__-46"><a href="#molecule.__init__-46"><span class="linenos"> 46</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-47"><a href="#molecule.__init__-47"><span class="linenos"> 47</span></a><span class="sd">        initializes molecules based on graph-list representation.</span>
</span><span id="molecule.__init__-48"><a href="#molecule.__init__-48"><span class="linenos"> 48</span></a><span class="sd">        </span>
</span><span id="molecule.__init__-49"><a href="#molecule.__init__-49"><span class="linenos"> 49</span></a><span class="sd">        The term index (or idx) always refers to a character in the string, </span>
</span><span id="molecule.__init__-50"><a href="#molecule.__init__-50"><span class="linenos"> 50</span></a><span class="sd">        be it semantic or syntactic. Semantics and syntax of the string are </span>
</span><span id="molecule.__init__-51"><a href="#molecule.__init__-51"><span class="linenos"> 51</span></a><span class="sd">        no longer important once the bond list and thus the actual graph is </span>
</span><span id="molecule.__init__-52"><a href="#molecule.__init__-52"><span class="linenos"> 52</span></a><span class="sd">        created. Then there are only syntactic objects, i.e. atoms.</span>
</span><span id="molecule.__init__-53"><a href="#molecule.__init__-53"><span class="linenos"> 53</span></a><span class="sd">        Thus, all numbers occuring in bond, angle or torsional lists or in</span>
</span><span id="molecule.__init__-54"><a href="#molecule.__init__-54"><span class="linenos"> 54</span></a><span class="sd">        distance matrices refer to atomic numbers. Indexes and semantic lists </span>
</span><span id="molecule.__init__-55"><a href="#molecule.__init__-55"><span class="linenos"> 55</span></a><span class="sd">        are only important for advanced applications. For example, generating</span>
</span><span id="molecule.__init__-56"><a href="#molecule.__init__-56"><span class="linenos"> 56</span></a><span class="sd">        strings with the same meaning. If both options are available they are</span>
</span><span id="molecule.__init__-57"><a href="#molecule.__init__-57"><span class="linenos"> 57</span></a><span class="sd">        are marked with index/indexes/idx and number/numbers. For example:</span>
</span><span id="molecule.__init__-58"><a href="#molecule.__init__-58"><span class="linenos"> 58</span></a><span class="sd">        ring_root_numbers and ring_root_indexes.</span>
</span><span id="molecule.__init__-59"><a href="#molecule.__init__-59"><span class="linenos"> 59</span></a>
</span><span id="molecule.__init__-60"><a href="#molecule.__init__-60"><span class="linenos"> 60</span></a><span class="sd">        Parameters:</span>
</span><span id="molecule.__init__-61"><a href="#molecule.__init__-61"><span class="linenos"> 61</span></a><span class="sd">        - mol:</span>
</span><span id="molecule.__init__-62"><a href="#molecule.__init__-62"><span class="linenos"> 62</span></a><span class="sd">            - string representation of a molecule.</span>
</span><span id="molecule.__init__-63"><a href="#molecule.__init__-63"><span class="linenos"> 63</span></a><span class="sd">        </span>
</span><span id="molecule.__init__-64"><a href="#molecule.__init__-64"><span class="linenos"> 64</span></a><span class="sd">        Returns:</span>
</span><span id="molecule.__init__-65"><a href="#molecule.__init__-65"><span class="linenos"> 65</span></a><span class="sd">            nothing</span>
</span><span id="molecule.__init__-66"><a href="#molecule.__init__-66"><span class="linenos"> 66</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule.__init__-67"><a href="#molecule.__init__-67"><span class="linenos"> 67</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="molecule.__init__-68"><a href="#molecule.__init__-68"><span class="linenos"> 68</span></a>            <span class="n">mol</span> <span class="o">=</span> <span class="n">mol</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;][&quot;</span><span class="p">)</span>
</span><span id="molecule.__init__-69"><a href="#molecule.__init__-69"><span class="linenos"> 69</span></a>
</span><span id="molecule.__init__-70"><a href="#molecule.__init__-70"><span class="linenos"> 70</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">molecule</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
</span><span id="molecule.__init__-71"><a href="#molecule.__init__-71"><span class="linenos"> 71</span></a>        <span class="sd">&quot;&quot;&quot;array representation of the molecule i.e. all keys/words/whatever in a list&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-72"><a href="#molecule.__init__-72"><span class="linenos"> 72</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mol</span><span class="p">))</span>  <span class="c1"># shows function</span>
</span><span id="molecule.__init__-73"><a href="#molecule.__init__-73"><span class="linenos"> 73</span></a>        <span class="sd">&quot;&quot;&quot;array with all functions. </span>
</span><span id="molecule.__init__-74"><a href="#molecule.__init__-74"><span class="linenos"> 74</span></a><span class="sd">        - branches pointing forward f &gt; 0</span>
</span><span id="molecule.__init__-75"><a href="#molecule.__init__-75"><span class="linenos"> 75</span></a><span class="sd">        - rings pointing backward f &lt; 0</span>
</span><span id="molecule.__init__-76"><a href="#molecule.__init__-76"><span class="linenos"> 76</span></a><span class="sd">        - beads without function f = 0</span>
</span><span id="molecule.__init__-77"><a href="#molecule.__init__-77"><span class="linenos"> 77</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule.__init__-78"><a href="#molecule.__init__-78"><span class="linenos"> 78</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mol</span><span class="p">))</span>  <span class="c1"># shows atomnumber</span>
</span><span id="molecule.__init__-79"><a href="#molecule.__init__-79"><span class="linenos"> 79</span></a>        <span class="sd">&quot;&quot;&quot;array with atom numbers. branches and rings n = -1 as they are no atoms&quot;&quot;&quot;</span>        
</span><span id="molecule.__init__-80"><a href="#molecule.__init__-80"><span class="linenos"> 80</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mol</span><span class="p">))</span>  <span class="c1"># shows index</span>
</span><span id="molecule.__init__-81"><a href="#molecule.__init__-81"><span class="linenos"> 81</span></a>        <span class="sd">&quot;&quot;&quot;array with indexes. atoms, branches and rings get an index&quot;&quot;&quot;</span>         
</span><span id="molecule.__init__-82"><a href="#molecule.__init__-82"><span class="linenos"> 82</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">)</span>
</span><span id="molecule.__init__-83"><a href="#molecule.__init__-83"><span class="linenos"> 83</span></a>        <span class="sd">&quot;&quot;&quot;number of all elements i.e. atoms, branches and rings&quot;&quot;&quot;</span>       
</span><span id="molecule.__init__-84"><a href="#molecule.__init__-84"><span class="linenos"> 84</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="molecule.__init__-85"><a href="#molecule.__init__-85"><span class="linenos"> 85</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
</span><span id="molecule.__init__-86"><a href="#molecule.__init__-86"><span class="linenos"> 86</span></a>            <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span>
</span><span id="molecule.__init__-87"><a href="#molecule.__init__-87"><span class="linenos"> 87</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
</span><span id="molecule.__init__-88"><a href="#molecule.__init__-88"><span class="linenos"> 88</span></a>            <span class="k">elif</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;r&quot;</span><span class="p">:</span>
</span><span id="molecule.__init__-89"><a href="#molecule.__init__-89"><span class="linenos"> 89</span></a>                <span class="c1"># dum = -int(m[1:])</span>
</span><span id="molecule.__init__-90"><a href="#molecule.__init__-90"><span class="linenos"> 90</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>  <span class="c1"># self.get_atom_index()</span>
</span><span id="molecule.__init__-91"><a href="#molecule.__init__-91"><span class="linenos"> 91</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="molecule.__init__-92"><a href="#molecule.__init__-92"><span class="linenos"> 92</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span>
</span><span id="molecule.__init__-93"><a href="#molecule.__init__-93"><span class="linenos"> 93</span></a>                <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="molecule.__init__-94"><a href="#molecule.__init__-94"><span class="linenos"> 94</span></a>
</span><span id="molecule.__init__-95"><a href="#molecule.__init__-95"><span class="linenos"> 95</span></a>        <span class="c1"># contains indexes of atoms</span>
</span><span id="molecule.__init__-96"><a href="#molecule.__init__-96"><span class="linenos"> 96</span></a>        <span class="c1"># index of atom no n: self.atom_indexes[n]</span>
</span><span id="molecule.__init__-97"><a href="#molecule.__init__-97"><span class="linenos"> 97</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">atom_indexes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="molecule.__init__-98"><a href="#molecule.__init__-98"><span class="linenos"> 98</span></a>        <span class="sd">&quot;&quot;&quot;array with indexes of all atoms&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-99"><a href="#molecule.__init__-99"><span class="linenos"> 99</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">atom_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">molecule</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="molecule.__init__-100"><a href="#molecule.__init__-100"><span class="linenos">100</span></a>        <span class="sd">&quot;&quot;&quot;array with names of all atoms&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-101"><a href="#molecule.__init__-101"><span class="linenos">101</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">atom_number</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_indexes</span><span class="p">)</span>
</span><span id="molecule.__init__-102"><a href="#molecule.__init__-102"><span class="linenos">102</span></a>        <span class="sd">&quot;&quot;&quot;number of all atoms&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-103"><a href="#molecule.__init__-103"><span class="linenos">103</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">atom_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_number</span><span class="p">)</span>
</span><span id="molecule.__init__-104"><a href="#molecule.__init__-104"><span class="linenos">104</span></a>        <span class="sd">&quot;&quot;&quot;array with numbers of all atoms&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-105"><a href="#molecule.__init__-105"><span class="linenos">105</span></a>        
</span><span id="molecule.__init__-106"><a href="#molecule.__init__-106"><span class="linenos">106</span></a>        <span class="c1"># housekeeping for get_neighbour_list (will be called later)</span>
</span><span id="molecule.__init__-107"><a href="#molecule.__init__-107"><span class="linenos">107</span></a>        <span class="c1"># (the following things are generated when calling get_neighbour_list)</span>
</span><span id="molecule.__init__-108"><a href="#molecule.__init__-108"><span class="linenos">108</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">idx_neighbour_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule.__init__-109"><a href="#molecule.__init__-109"><span class="linenos">109</span></a>        <span class="sd">&quot;&quot;&quot;array with indexes of all neighboured/bonded atoms&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-110"><a href="#molecule.__init__-110"><span class="linenos">110</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">neighbour_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule.__init__-111"><a href="#molecule.__init__-111"><span class="linenos">111</span></a>        <span class="sd">&quot;&quot;&quot;array with numbers of all neighboured/bonded atoms&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-112"><a href="#molecule.__init__-112"><span class="linenos">112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ring_root_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule.__init__-113"><a href="#molecule.__init__-113"><span class="linenos">113</span></a>        <span class="sd">&quot;&quot;&quot;array with indexes of all atoms rooting a ring&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-114"><a href="#molecule.__init__-114"><span class="linenos">114</span></a>       
</span><span id="molecule.__init__-115"><a href="#molecule.__init__-115"><span class="linenos">115</span></a>        
</span><span id="molecule.__init__-116"><a href="#molecule.__init__-116"><span class="linenos">116</span></a>        <span class="c1"># housekeeping for get_distance_matrix (will be called later)</span>
</span><span id="molecule.__init__-117"><a href="#molecule.__init__-117"><span class="linenos">117</span></a>        <span class="c1"># (the following things are generated when calling get_distance_matrix)</span>
</span><span id="molecule.__init__-118"><a href="#molecule.__init__-118"><span class="linenos">118</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distance_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule.__init__-119"><a href="#molecule.__init__-119"><span class="linenos">119</span></a>        <span class="sd">&quot;&quot;&quot;distance matrix of all atoms in the molecule&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-120"><a href="#molecule.__init__-120"><span class="linenos">120</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bond_lists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule.__init__-121"><a href="#molecule.__init__-121"><span class="linenos">121</span></a>        <span class="sd">&quot;&quot;&quot;nested array with bond lists </span>
</span><span id="molecule.__init__-122"><a href="#molecule.__init__-122"><span class="linenos">122</span></a><span class="sd">        - starting from atoms separeted by one bond bond_lists[0]</span>
</span><span id="molecule.__init__-123"><a href="#molecule.__init__-123"><span class="linenos">123</span></a><span class="sd">        - then atoms separeted by two bonds bond_lists[1] </span>
</span><span id="molecule.__init__-124"><a href="#molecule.__init__-124"><span class="linenos">124</span></a><span class="sd">        - ...</span>
</span><span id="molecule.__init__-125"><a href="#molecule.__init__-125"><span class="linenos">125</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule.__init__-126"><a href="#molecule.__init__-126"><span class="linenos">126</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">idx_bond_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule.__init__-127"><a href="#molecule.__init__-127"><span class="linenos">127</span></a>        <span class="sd">&quot;&quot;&quot;array with indexes of all neighboured/bonded atoms&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-128"><a href="#molecule.__init__-128"><span class="linenos">128</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bond_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  
</span><span id="molecule.__init__-129"><a href="#molecule.__init__-129"><span class="linenos">129</span></a>        <span class="sd">&quot;&quot;&quot;array with numbers of all neighboured/bonded atoms&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-130"><a href="#molecule.__init__-130"><span class="linenos">130</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bond_keys</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule.__init__-131"><a href="#molecule.__init__-131"><span class="linenos">131</span></a>        <span class="sd">&quot;&quot;&quot;array with keys of all neighboured/bonded atoms&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-132"><a href="#molecule.__init__-132"><span class="linenos">132</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">angle_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule.__init__-133"><a href="#molecule.__init__-133"><span class="linenos">133</span></a>        <span class="sd">&quot;&quot;&quot;array of numbers of all angle forming atoms (separated by 2 bonds)&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-134"><a href="#molecule.__init__-134"><span class="linenos">134</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">angle_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule.__init__-135"><a href="#molecule.__init__-135"><span class="linenos">135</span></a>        <span class="sd">&quot;&quot;&quot;array of names of all angle forming atoms (separated by 2 bonds)&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-136"><a href="#molecule.__init__-136"><span class="linenos">136</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">angle_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule.__init__-137"><a href="#molecule.__init__-137"><span class="linenos">137</span></a>        <span class="sd">&quot;&quot;&quot;array of keys of all angle forming atoms (separated by 2 bonds)&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-138"><a href="#molecule.__init__-138"><span class="linenos">138</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule.__init__-139"><a href="#molecule.__init__-139"><span class="linenos">139</span></a>        <span class="sd">&quot;&quot;&quot;array of numbers of all dihedral forming atoms (separated by 3 bonds)&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-140"><a href="#molecule.__init__-140"><span class="linenos">140</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule.__init__-141"><a href="#molecule.__init__-141"><span class="linenos">141</span></a>        <span class="sd">&quot;&quot;&quot;array of names of all dihedral forming atoms (separated by 3 bonds)&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-142"><a href="#molecule.__init__-142"><span class="linenos">142</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">torsion_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>        
</span><span id="molecule.__init__-143"><a href="#molecule.__init__-143"><span class="linenos">143</span></a>        <span class="sd">&quot;&quot;&quot;array of keys of all dihedral forming atoms (separated by 3 bonds)&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-144"><a href="#molecule.__init__-144"><span class="linenos">144</span></a>
</span><span id="molecule.__init__-145"><a href="#molecule.__init__-145"><span class="linenos">145</span></a>        <span class="c1"># get bond list</span>
</span><span id="molecule.__init__-146"><a href="#molecule.__init__-146"><span class="linenos">146</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">get_neighbour_list</span><span class="p">()</span>        
</span><span id="molecule.__init__-147"><a href="#molecule.__init__-147"><span class="linenos">147</span></a>        
</span><span id="molecule.__init__-148"><a href="#molecule.__init__-148"><span class="linenos">148</span></a>        <span class="c1"># get branch ends</span>
</span><span id="molecule.__init__-149"><a href="#molecule.__init__-149"><span class="linenos">149</span></a>        <span class="n">n</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bond_list</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="molecule.__init__-150"><a href="#molecule.__init__-150"><span class="linenos">150</span></a>        <span class="n">pp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">count</span> <span class="o">==</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="molecule.__init__-151"><a href="#molecule.__init__-151"><span class="linenos">151</span></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="molecule.__init__-152"><a href="#molecule.__init__-152"><span class="linenos">152</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">branch_end_numbers</span> <span class="o">=</span> <span class="n">n</span><span class="p">[</span><span class="n">pp</span><span class="p">]</span>
</span><span id="molecule.__init__-153"><a href="#molecule.__init__-153"><span class="linenos">153</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">branch_end_indexes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_indexes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">branch_end_numbers</span><span class="p">]</span>
</span><span id="molecule.__init__-154"><a href="#molecule.__init__-154"><span class="linenos">154</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="molecule.__init__-155"><a href="#molecule.__init__-155"><span class="linenos">155</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">branch_end_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="molecule.__init__-156"><a href="#molecule.__init__-156"><span class="linenos">156</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">branch_end_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="molecule.__init__-157"><a href="#molecule.__init__-157"><span class="linenos">157</span></a>        <span class="c1"># get ring closures</span>
</span><span id="molecule.__init__-158"><a href="#molecule.__init__-158"><span class="linenos">158</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ring_close_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="molecule.__init__-159"><a href="#molecule.__init__-159"><span class="linenos">159</span></a>        <span class="sd">&quot;&quot;&quot;array with indexes of all atoms closing a ring&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-160"><a href="#molecule.__init__-160"><span class="linenos">160</span></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ring_close_indexes</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="molecule.__init__-161"><a href="#molecule.__init__-161"><span class="linenos">161</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ring_close_numbers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ring_close_indexes</span><span class="p">]</span>
</span><span id="molecule.__init__-162"><a href="#molecule.__init__-162"><span class="linenos">162</span></a>            <span class="sd">&quot;&quot;&quot;array with atom numbers of all atoms closing a ring&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-163"><a href="#molecule.__init__-163"><span class="linenos">163</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ring_root_numbers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ring_root_indexes</span><span class="p">]</span>
</span><span id="molecule.__init__-164"><a href="#molecule.__init__-164"><span class="linenos">164</span></a>            <span class="sd">&quot;&quot;&quot;array with atom numbers of all atoms rooting a ring&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-165"><a href="#molecule.__init__-165"><span class="linenos">165</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="molecule.__init__-166"><a href="#molecule.__init__-166"><span class="linenos">166</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ring_close_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="molecule.__init__-167"><a href="#molecule.__init__-167"><span class="linenos">167</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ring_root_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="molecule.__init__-168"><a href="#molecule.__init__-168"><span class="linenos">168</span></a>
</span><span id="molecule.__init__-169"><a href="#molecule.__init__-169"><span class="linenos">169</span></a>        <span class="c1"># get distance matrix</span>
</span><span id="molecule.__init__-170"><a href="#molecule.__init__-170"><span class="linenos">170</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">get_distance_matrix</span><span class="p">()</span>
</span><span id="molecule.__init__-171"><a href="#molecule.__init__-171"><span class="linenos">171</span></a>
</span><span id="molecule.__init__-172"><a href="#molecule.__init__-172"><span class="linenos">172</span></a>        <span class="n">dummy</span> <span class="o">=</span> <span class="n">unique_sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_names</span><span class="p">,</span> <span class="n">return_inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="molecule.__init__-173"><a href="#molecule.__init__-173"><span class="linenos">173</span></a>        <span class="p">(</span>
</span><span id="molecule.__init__-174"><a href="#molecule.__init__-174"><span class="linenos">174</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_keys</span><span class="p">,</span>
</span><span id="molecule.__init__-175"><a href="#molecule.__init__-175"><span class="linenos">175</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_indexes</span><span class="p">,</span>
</span><span id="molecule.__init__-176"><a href="#molecule.__init__-176"><span class="linenos">176</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_inverse</span><span class="p">,</span>
</span><span id="molecule.__init__-177"><a href="#molecule.__init__-177"><span class="linenos">177</span></a>        <span class="p">)</span> <span class="o">=</span> <span class="n">dummy</span>
</span><span id="molecule.__init__-178"><a href="#molecule.__init__-178"><span class="linenos">178</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_names</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_indexes</span><span class="p">]</span>
</span><span id="molecule.__init__-179"><a href="#molecule.__init__-179"><span class="linenos">179</span></a>        <span class="sd">&quot;&quot;&quot;array with unique atom names&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-180"><a href="#molecule.__init__-180"><span class="linenos">180</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_numbers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_numbers</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_indexes</span><span class="p">]</span>
</span><span id="molecule.__init__-181"><a href="#molecule.__init__-181"><span class="linenos">181</span></a>        <span class="sd">&quot;&quot;&quot;array with numbers of unique atom names&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-182"><a href="#molecule.__init__-182"><span class="linenos">182</span></a>        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span>
</span><span id="molecule.__init__-183"><a href="#molecule.__init__-183"><span class="linenos">183</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_keys</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_inverse</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_names</span>
</span><span id="molecule.__init__-184"><a href="#molecule.__init__-184"><span class="linenos">184</span></a>        <span class="p">),</span> <span class="s2">&quot;unique atom in inverse doesnt work&quot;</span>
</span><span id="molecule.__init__-185"><a href="#molecule.__init__-185"><span class="linenos">185</span></a>
</span><span id="molecule.__init__-186"><a href="#molecule.__init__-186"><span class="linenos">186</span></a>        <span class="n">dummy</span> <span class="o">=</span> <span class="n">unique_sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bond_keys</span><span class="p">,</span> <span class="n">return_inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="molecule.__init__-187"><a href="#molecule.__init__-187"><span class="linenos">187</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_bond_keys</span> <span class="o">=</span> <span class="n">dummy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="molecule.__init__-188"><a href="#molecule.__init__-188"><span class="linenos">188</span></a>        <span class="sd">&quot;&quot;&quot;array with unique bond keys&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-189"><a href="#molecule.__init__-189"><span class="linenos">189</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_bond_indexes</span> <span class="o">=</span> <span class="n">dummy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="molecule.__init__-190"><a href="#molecule.__init__-190"><span class="linenos">190</span></a>        <span class="sd">&quot;&quot;&quot;array with unique bond indexes&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-191"><a href="#molecule.__init__-191"><span class="linenos">191</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_bond_inverse</span> <span class="o">=</span> <span class="n">dummy</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="molecule.__init__-192"><a href="#molecule.__init__-192"><span class="linenos">192</span></a>        <span class="sd">&quot;&quot;&quot;array to invert unique bonds&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-193"><a href="#molecule.__init__-193"><span class="linenos">193</span></a>
</span><span id="molecule.__init__-194"><a href="#molecule.__init__-194"><span class="linenos">194</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_bond_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_names</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_bond_indexes</span><span class="p">]</span>
</span><span id="molecule.__init__-195"><a href="#molecule.__init__-195"><span class="linenos">195</span></a>        <span class="sd">&quot;&quot;&quot;array with unique bond names&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-196"><a href="#molecule.__init__-196"><span class="linenos">196</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_bond_numbers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_bond_indexes</span><span class="p">]</span>
</span><span id="molecule.__init__-197"><a href="#molecule.__init__-197"><span class="linenos">197</span></a>        <span class="sd">&quot;&quot;&quot;array with numbers of unique bond names&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-198"><a href="#molecule.__init__-198"><span class="linenos">198</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bond_keys</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="molecule.__init__-199"><a href="#molecule.__init__-199"><span class="linenos">199</span></a>            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span>
</span><span id="molecule.__init__-200"><a href="#molecule.__init__-200"><span class="linenos">200</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">unique_bond_keys</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_bond_inverse</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_keys</span>
</span><span id="molecule.__init__-201"><a href="#molecule.__init__-201"><span class="linenos">201</span></a>            <span class="p">),</span> <span class="s2">&quot;unique bond in inverse doesnt work&quot;</span>
</span><span id="molecule.__init__-202"><a href="#molecule.__init__-202"><span class="linenos">202</span></a>
</span><span id="molecule.__init__-203"><a href="#molecule.__init__-203"><span class="linenos">203</span></a>        <span class="n">dummy</span> <span class="o">=</span> <span class="n">unique_sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angle_keys</span><span class="p">,</span> <span class="n">return_inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="molecule.__init__-204"><a href="#molecule.__init__-204"><span class="linenos">204</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_angle_keys</span> <span class="o">=</span> <span class="n">dummy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="molecule.__init__-205"><a href="#molecule.__init__-205"><span class="linenos">205</span></a>        <span class="sd">&quot;&quot;&quot;array with unique angle keys&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-206"><a href="#molecule.__init__-206"><span class="linenos">206</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_angle_indexes</span> <span class="o">=</span> <span class="n">dummy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="molecule.__init__-207"><a href="#molecule.__init__-207"><span class="linenos">207</span></a>        <span class="sd">&quot;&quot;&quot;array with unique angle indexes&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-208"><a href="#molecule.__init__-208"><span class="linenos">208</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_angle_inverse</span> <span class="o">=</span> <span class="n">dummy</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="molecule.__init__-209"><a href="#molecule.__init__-209"><span class="linenos">209</span></a>        <span class="sd">&quot;&quot;&quot;array to invert unique angles&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-210"><a href="#molecule.__init__-210"><span class="linenos">210</span></a>
</span><span id="molecule.__init__-211"><a href="#molecule.__init__-211"><span class="linenos">211</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_angle_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_names</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_angle_indexes</span><span class="p">]</span>
</span><span id="molecule.__init__-212"><a href="#molecule.__init__-212"><span class="linenos">212</span></a>        <span class="sd">&quot;&quot;&quot;array with unique angle names&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-213"><a href="#molecule.__init__-213"><span class="linenos">213</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_angle_numbers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_angle_indexes</span><span class="p">]</span>
</span><span id="molecule.__init__-214"><a href="#molecule.__init__-214"><span class="linenos">214</span></a>        <span class="sd">&quot;&quot;&quot;array with numbers of unique angle names&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-215"><a href="#molecule.__init__-215"><span class="linenos">215</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angle_keys</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="molecule.__init__-216"><a href="#molecule.__init__-216"><span class="linenos">216</span></a>            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span>
</span><span id="molecule.__init__-217"><a href="#molecule.__init__-217"><span class="linenos">217</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">unique_angle_keys</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_angle_inverse</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_keys</span>
</span><span id="molecule.__init__-218"><a href="#molecule.__init__-218"><span class="linenos">218</span></a>            <span class="p">),</span> <span class="s2">&quot;unique angle in inverse doesnt work&quot;</span>
</span><span id="molecule.__init__-219"><a href="#molecule.__init__-219"><span class="linenos">219</span></a>
</span><span id="molecule.__init__-220"><a href="#molecule.__init__-220"><span class="linenos">220</span></a>        <span class="n">dummy</span> <span class="o">=</span> <span class="n">unique_sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">torsion_keys</span><span class="p">,</span> <span class="n">return_inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="molecule.__init__-221"><a href="#molecule.__init__-221"><span class="linenos">221</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_torsion_keys</span> <span class="o">=</span> <span class="n">dummy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="molecule.__init__-222"><a href="#molecule.__init__-222"><span class="linenos">222</span></a>        <span class="sd">&quot;&quot;&quot;array with unique torsion keys&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-223"><a href="#molecule.__init__-223"><span class="linenos">223</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_torsion_indexes</span> <span class="o">=</span> <span class="n">dummy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="molecule.__init__-224"><a href="#molecule.__init__-224"><span class="linenos">224</span></a>        <span class="sd">&quot;&quot;&quot;array with unique torsion indexes&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-225"><a href="#molecule.__init__-225"><span class="linenos">225</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_torsion_inverse</span> <span class="o">=</span> <span class="n">dummy</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="molecule.__init__-226"><a href="#molecule.__init__-226"><span class="linenos">226</span></a>        <span class="sd">&quot;&quot;&quot;array to invert unique torsions&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-227"><a href="#molecule.__init__-227"><span class="linenos">227</span></a>        
</span><span id="molecule.__init__-228"><a href="#molecule.__init__-228"><span class="linenos">228</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_torsion_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">torsion_names</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_torsion_indexes</span><span class="p">]</span>
</span><span id="molecule.__init__-229"><a href="#molecule.__init__-229"><span class="linenos">229</span></a>        <span class="sd">&quot;&quot;&quot;array with unique torsion names&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-230"><a href="#molecule.__init__-230"><span class="linenos">230</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_torsion_numbers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">torsion_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_torsion_indexes</span><span class="p">]</span>
</span><span id="molecule.__init__-231"><a href="#molecule.__init__-231"><span class="linenos">231</span></a>        <span class="sd">&quot;&quot;&quot;array with numbers of unique torsion names&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-232"><a href="#molecule.__init__-232"><span class="linenos">232</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">torsion_keys</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="molecule.__init__-233"><a href="#molecule.__init__-233"><span class="linenos">233</span></a>            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span>
</span><span id="molecule.__init__-234"><a href="#molecule.__init__-234"><span class="linenos">234</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">unique_torsion_keys</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_torsion_inverse</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">torsion_keys</span>
</span><span id="molecule.__init__-235"><a href="#molecule.__init__-235"><span class="linenos">235</span></a>            <span class="p">),</span> <span class="s2">&quot;unique angle in inverse doesnt work&quot;</span>
</span><span id="molecule.__init__-236"><a href="#molecule.__init__-236"><span class="linenos">236</span></a>
</span><span id="molecule.__init__-237"><a href="#molecule.__init__-237"><span class="linenos">237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_pair_names</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="molecule.__init__-238"><a href="#molecule.__init__-238"><span class="linenos">238</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_pair_keys</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="molecule.__init__-239"><a href="#molecule.__init__-239"><span class="linenos">239</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">a0</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_names</span><span class="p">):</span>
</span><span id="molecule.__init__-240"><a href="#molecule.__init__-240"><span class="linenos">240</span></a>            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">a1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_names</span><span class="p">):</span>
</span><span id="molecule.__init__-241"><a href="#molecule.__init__-241"><span class="linenos">241</span></a>                <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">j</span><span class="p">:</span>
</span><span id="molecule.__init__-242"><a href="#molecule.__init__-242"><span class="linenos">242</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_pair_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sort_force_fields</span><span class="p">([</span><span class="n">a0</span><span class="p">,</span> <span class="n">a1</span><span class="p">]))</span>
</span><span id="molecule.__init__-243"><a href="#molecule.__init__-243"><span class="linenos">243</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_pair_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="molecule.__init__-244"><a href="#molecule.__init__-244"><span class="linenos">244</span></a>                        <span class="n">make_graph</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_pair_names</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="molecule.__init__-245"><a href="#molecule.__init__-245"><span class="linenos">245</span></a>                    <span class="p">)</span>
</span><span id="molecule.__init__-246"><a href="#molecule.__init__-246"><span class="linenos">246</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_pair_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_pair_names</span><span class="p">)</span>
</span><span id="molecule.__init__-247"><a href="#molecule.__init__-247"><span class="linenos">247</span></a>        <span class="sd">&quot;&quot;&quot;array with unique atom pair names. use them for combining rules.&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-248"><a href="#molecule.__init__-248"><span class="linenos">248</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_pair_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_pair_keys</span><span class="p">)</span>
</span><span id="molecule.__init__-249"><a href="#molecule.__init__-249"><span class="linenos">249</span></a>        <span class="sd">&quot;&quot;&quot;array with unique atom pair keys. use them for combining rules.&quot;&quot;&quot;</span>
</span><span id="molecule.__init__-250"><a href="#molecule.__init__-250"><span class="linenos">250</span></a>        <span class="k">return</span>
</span></pre></div>


            <div class="docstring"><p>initializes molecules based on graph-list representation.</p>

<p>The term index (or idx) always refers to a character in the string, 
be it semantic or syntactic. Semantics and syntax of the string are 
no longer important once the bond list and thus the actual graph is 
created. Then there are only syntactic objects, i.e. atoms.
Thus, all numbers occuring in bond, angle or torsional lists or in
distance matrices refer to atomic numbers. Indexes and semantic lists 
are only important for advanced applications. For example, generating
strings with the same meaning. If both options are available they are
are marked with index/indexes/idx and number/numbers. For example:
ring_root_numbers and ring_root_indexes.</p>

<p>Parameters:</p>

<ul>
<li>mol:
<ul>
<li>string representation of a molecule.</li>
</ul></li>
</ul>

<p>Returns:
    nothing</p>
</div>


                            </div>
                            <div id="molecule.molecule" class="classattr">
                                <div class="attr variable">
            <span class="name">molecule</span>

        
    </div>
    <a class="headerlink" href="#molecule.molecule"></a>
    
            <div class="docstring"><p>array representation of the molecule i.e. all keys/words/whatever in a list</p>
</div>


                            </div>
                            <div id="molecule.f" class="classattr">
                                <div class="attr variable">
            <span class="name">f</span>

        
    </div>
    <a class="headerlink" href="#molecule.f"></a>
    
            <div class="docstring"><p>array with all functions. </p>

<ul>
<li>branches pointing forward f &gt; 0</li>
<li>rings pointing backward f &lt; 0</li>
<li>beads without function f = 0</li>
</ul>
</div>


                            </div>
                            <div id="molecule.n" class="classattr">
                                <div class="attr variable">
            <span class="name">n</span>

        
    </div>
    <a class="headerlink" href="#molecule.n"></a>
    
            <div class="docstring"><p>array with atom numbers. branches and rings n = -1 as they are no atoms</p>
</div>


                            </div>
                            <div id="molecule.i" class="classattr">
                                <div class="attr variable">
            <span class="name">i</span>

        
    </div>
    <a class="headerlink" href="#molecule.i"></a>
    
            <div class="docstring"><p>array with indexes. atoms, branches and rings get an index</p>
</div>


                            </div>
                            <div id="molecule.len" class="classattr">
                                <div class="attr variable">
            <span class="name">len</span>

        
    </div>
    <a class="headerlink" href="#molecule.len"></a>
    
            <div class="docstring"><p>number of all elements i.e. atoms, branches and rings</p>
</div>


                            </div>
                            <div id="molecule.atom_indexes" class="classattr">
                                <div class="attr variable">
            <span class="name">atom_indexes</span>

        
    </div>
    <a class="headerlink" href="#molecule.atom_indexes"></a>
    
            <div class="docstring"><p>array with indexes of all atoms</p>
</div>


                            </div>
                            <div id="molecule.atom_names" class="classattr">
                                <div class="attr variable">
            <span class="name">atom_names</span>

        
    </div>
    <a class="headerlink" href="#molecule.atom_names"></a>
    
            <div class="docstring"><p>array with names of all atoms</p>
</div>


                            </div>
                            <div id="molecule.atom_number" class="classattr">
                                <div class="attr variable">
            <span class="name">atom_number</span>

        
    </div>
    <a class="headerlink" href="#molecule.atom_number"></a>
    
            <div class="docstring"><p>number of all atoms</p>
</div>


                            </div>
                            <div id="molecule.atom_numbers" class="classattr">
                                <div class="attr variable">
            <span class="name">atom_numbers</span>

        
    </div>
    <a class="headerlink" href="#molecule.atom_numbers"></a>
    
            <div class="docstring"><p>array with numbers of all atoms</p>
</div>


                            </div>
                            <div id="molecule.idx_neighbour_list" class="classattr">
                                <div class="attr variable">
            <span class="name">idx_neighbour_list</span>

        
    </div>
    <a class="headerlink" href="#molecule.idx_neighbour_list"></a>
    
            <div class="docstring"><p>array with indexes of all neighboured/bonded atoms</p>
</div>


                            </div>
                            <div id="molecule.neighbour_list" class="classattr">
                                <div class="attr variable">
            <span class="name">neighbour_list</span>

        
    </div>
    <a class="headerlink" href="#molecule.neighbour_list"></a>
    
            <div class="docstring"><p>array with numbers of all neighboured/bonded atoms</p>
</div>


                            </div>
                            <div id="molecule.ring_root_indexes" class="classattr">
                                <div class="attr variable">
            <span class="name">ring_root_indexes</span>

        
    </div>
    <a class="headerlink" href="#molecule.ring_root_indexes"></a>
    
            <div class="docstring"><p>array with indexes of all atoms rooting a ring</p>
</div>


                            </div>
                            <div id="molecule.distance_matrix" class="classattr">
                                <div class="attr variable">
            <span class="name">distance_matrix</span>

        
    </div>
    <a class="headerlink" href="#molecule.distance_matrix"></a>
    
            <div class="docstring"><p>distance matrix of all atoms in the molecule</p>
</div>


                            </div>
                            <div id="molecule.bond_lists" class="classattr">
                                <div class="attr variable">
            <span class="name">bond_lists</span>

        
    </div>
    <a class="headerlink" href="#molecule.bond_lists"></a>
    
            <div class="docstring"><p>nested array with bond lists </p>

<ul>
<li>starting from atoms separeted by one bond bond_lists[0]</li>
<li>then atoms separeted by two bonds bond_lists[1] </li>
<li>...</li>
</ul>
</div>


                            </div>
                            <div id="molecule.idx_bond_list" class="classattr">
                                <div class="attr variable">
            <span class="name">idx_bond_list</span>

        
    </div>
    <a class="headerlink" href="#molecule.idx_bond_list"></a>
    
            <div class="docstring"><p>array with indexes of all neighboured/bonded atoms</p>
</div>


                            </div>
                            <div id="molecule.bond_list" class="classattr">
                                <div class="attr variable">
            <span class="name">bond_list</span>

        
    </div>
    <a class="headerlink" href="#molecule.bond_list"></a>
    
            <div class="docstring"><p>array with numbers of all neighboured/bonded atoms</p>
</div>


                            </div>
                            <div id="molecule.bond_keys" class="classattr">
                                <div class="attr variable">
            <span class="name">bond_keys</span>

        
    </div>
    <a class="headerlink" href="#molecule.bond_keys"></a>
    
            <div class="docstring"><p>array with keys of all neighboured/bonded atoms</p>
</div>


                            </div>
                            <div id="molecule.angle_list" class="classattr">
                                <div class="attr variable">
            <span class="name">angle_list</span>

        
    </div>
    <a class="headerlink" href="#molecule.angle_list"></a>
    
            <div class="docstring"><p>array of numbers of all angle forming atoms (separated by 2 bonds)</p>
</div>


                            </div>
                            <div id="molecule.angle_names" class="classattr">
                                <div class="attr variable">
            <span class="name">angle_names</span>

        
    </div>
    <a class="headerlink" href="#molecule.angle_names"></a>
    
            <div class="docstring"><p>array of names of all angle forming atoms (separated by 2 bonds)</p>
</div>


                            </div>
                            <div id="molecule.angle_keys" class="classattr">
                                <div class="attr variable">
            <span class="name">angle_keys</span>

        
    </div>
    <a class="headerlink" href="#molecule.angle_keys"></a>
    
            <div class="docstring"><p>array of keys of all angle forming atoms (separated by 2 bonds)</p>
</div>


                            </div>
                            <div id="molecule.torsion_list" class="classattr">
                                <div class="attr variable">
            <span class="name">torsion_list</span>

        
    </div>
    <a class="headerlink" href="#molecule.torsion_list"></a>
    
            <div class="docstring"><p>array of numbers of all dihedral forming atoms (separated by 3 bonds)</p>
</div>


                            </div>
                            <div id="molecule.torsion_names" class="classattr">
                                <div class="attr variable">
            <span class="name">torsion_names</span>

        
    </div>
    <a class="headerlink" href="#molecule.torsion_names"></a>
    
            <div class="docstring"><p>array of names of all dihedral forming atoms (separated by 3 bonds)</p>
</div>


                            </div>
                            <div id="molecule.torsion_keys" class="classattr">
                                <div class="attr variable">
            <span class="name">torsion_keys</span>

        
    </div>
    <a class="headerlink" href="#molecule.torsion_keys"></a>
    
            <div class="docstring"><p>array of keys of all dihedral forming atoms (separated by 3 bonds)</p>
</div>


                            </div>
                            <div id="molecule.ring_close_indexes" class="classattr">
                                <div class="attr variable">
            <span class="name">ring_close_indexes</span>

        
    </div>
    <a class="headerlink" href="#molecule.ring_close_indexes"></a>
    
            <div class="docstring"><p>array with indexes of all atoms closing a ring</p>
</div>


                            </div>
                            <div id="molecule.unique_atom_names" class="classattr">
                                <div class="attr variable">
            <span class="name">unique_atom_names</span>

        
    </div>
    <a class="headerlink" href="#molecule.unique_atom_names"></a>
    
            <div class="docstring"><p>array with unique atom names</p>
</div>


                            </div>
                            <div id="molecule.unique_atom_numbers" class="classattr">
                                <div class="attr variable">
            <span class="name">unique_atom_numbers</span>

        
    </div>
    <a class="headerlink" href="#molecule.unique_atom_numbers"></a>
    
            <div class="docstring"><p>array with numbers of unique atom names</p>
</div>


                            </div>
                            <div id="molecule.unique_bond_keys" class="classattr">
                                <div class="attr variable">
            <span class="name">unique_bond_keys</span>

        
    </div>
    <a class="headerlink" href="#molecule.unique_bond_keys"></a>
    
            <div class="docstring"><p>array with unique bond keys</p>
</div>


                            </div>
                            <div id="molecule.unique_bond_indexes" class="classattr">
                                <div class="attr variable">
            <span class="name">unique_bond_indexes</span>

        
    </div>
    <a class="headerlink" href="#molecule.unique_bond_indexes"></a>
    
            <div class="docstring"><p>array with unique bond indexes</p>
</div>


                            </div>
                            <div id="molecule.unique_bond_inverse" class="classattr">
                                <div class="attr variable">
            <span class="name">unique_bond_inverse</span>

        
    </div>
    <a class="headerlink" href="#molecule.unique_bond_inverse"></a>
    
            <div class="docstring"><p>array to invert unique bonds</p>
</div>


                            </div>
                            <div id="molecule.unique_bond_names" class="classattr">
                                <div class="attr variable">
            <span class="name">unique_bond_names</span>

        
    </div>
    <a class="headerlink" href="#molecule.unique_bond_names"></a>
    
            <div class="docstring"><p>array with unique bond names</p>
</div>


                            </div>
                            <div id="molecule.unique_bond_numbers" class="classattr">
                                <div class="attr variable">
            <span class="name">unique_bond_numbers</span>

        
    </div>
    <a class="headerlink" href="#molecule.unique_bond_numbers"></a>
    
            <div class="docstring"><p>array with numbers of unique bond names</p>
</div>


                            </div>
                            <div id="molecule.unique_angle_keys" class="classattr">
                                <div class="attr variable">
            <span class="name">unique_angle_keys</span>

        
    </div>
    <a class="headerlink" href="#molecule.unique_angle_keys"></a>
    
            <div class="docstring"><p>array with unique angle keys</p>
</div>


                            </div>
                            <div id="molecule.unique_angle_indexes" class="classattr">
                                <div class="attr variable">
            <span class="name">unique_angle_indexes</span>

        
    </div>
    <a class="headerlink" href="#molecule.unique_angle_indexes"></a>
    
            <div class="docstring"><p>array with unique angle indexes</p>
</div>


                            </div>
                            <div id="molecule.unique_angle_inverse" class="classattr">
                                <div class="attr variable">
            <span class="name">unique_angle_inverse</span>

        
    </div>
    <a class="headerlink" href="#molecule.unique_angle_inverse"></a>
    
            <div class="docstring"><p>array to invert unique angles</p>
</div>


                            </div>
                            <div id="molecule.unique_angle_names" class="classattr">
                                <div class="attr variable">
            <span class="name">unique_angle_names</span>

        
    </div>
    <a class="headerlink" href="#molecule.unique_angle_names"></a>
    
            <div class="docstring"><p>array with unique angle names</p>
</div>


                            </div>
                            <div id="molecule.unique_angle_numbers" class="classattr">
                                <div class="attr variable">
            <span class="name">unique_angle_numbers</span>

        
    </div>
    <a class="headerlink" href="#molecule.unique_angle_numbers"></a>
    
            <div class="docstring"><p>array with numbers of unique angle names</p>
</div>


                            </div>
                            <div id="molecule.unique_torsion_keys" class="classattr">
                                <div class="attr variable">
            <span class="name">unique_torsion_keys</span>

        
    </div>
    <a class="headerlink" href="#molecule.unique_torsion_keys"></a>
    
            <div class="docstring"><p>array with unique torsion keys</p>
</div>


                            </div>
                            <div id="molecule.unique_torsion_indexes" class="classattr">
                                <div class="attr variable">
            <span class="name">unique_torsion_indexes</span>

        
    </div>
    <a class="headerlink" href="#molecule.unique_torsion_indexes"></a>
    
            <div class="docstring"><p>array with unique torsion indexes</p>
</div>


                            </div>
                            <div id="molecule.unique_torsion_inverse" class="classattr">
                                <div class="attr variable">
            <span class="name">unique_torsion_inverse</span>

        
    </div>
    <a class="headerlink" href="#molecule.unique_torsion_inverse"></a>
    
            <div class="docstring"><p>array to invert unique torsions</p>
</div>


                            </div>
                            <div id="molecule.unique_torsion_names" class="classattr">
                                <div class="attr variable">
            <span class="name">unique_torsion_names</span>

        
    </div>
    <a class="headerlink" href="#molecule.unique_torsion_names"></a>
    
            <div class="docstring"><p>array with unique torsion names</p>
</div>


                            </div>
                            <div id="molecule.unique_torsion_numbers" class="classattr">
                                <div class="attr variable">
            <span class="name">unique_torsion_numbers</span>

        
    </div>
    <a class="headerlink" href="#molecule.unique_torsion_numbers"></a>
    
            <div class="docstring"><p>array with numbers of unique torsion names</p>
</div>


                            </div>
                            <div id="molecule.unique_atom_pair_names" class="classattr">
                                <div class="attr variable">
            <span class="name">unique_atom_pair_names</span>

        
    </div>
    <a class="headerlink" href="#molecule.unique_atom_pair_names"></a>
    
            <div class="docstring"><p>array with unique atom pair names. use them for combining rules.</p>
</div>


                            </div>
                            <div id="molecule.unique_atom_pair_keys" class="classattr">
                                <div class="attr variable">
            <span class="name">unique_atom_pair_keys</span>

        
    </div>
    <a class="headerlink" href="#molecule.unique_atom_pair_keys"></a>
    
            <div class="docstring"><p>array with unique atom pair keys. use them for combining rules.</p>
</div>


                            </div>
                            <div id="molecule.get_neighbour_list" class="classattr">
                                        <input id="molecule.get_neighbour_list-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_neighbour_list</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="molecule.get_neighbour_list-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#molecule.get_neighbour_list"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="molecule.get_neighbour_list-252"><a href="#molecule.get_neighbour_list-252"><span class="linenos">252</span></a>    <span class="k">def</span> <span class="nf">get_neighbour_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="molecule.get_neighbour_list-253"><a href="#molecule.get_neighbour_list-253"><span class="linenos">253</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule.get_neighbour_list-254"><a href="#molecule.get_neighbour_list-254"><span class="linenos">254</span></a><span class="sd">        generates a neighbour list from an initialized molecule</span>
</span><span id="molecule.get_neighbour_list-255"><a href="#molecule.get_neighbour_list-255"><span class="linenos">255</span></a>
</span><span id="molecule.get_neighbour_list-256"><a href="#molecule.get_neighbour_list-256"><span class="linenos">256</span></a><span class="sd">        Parameters: None</span>
</span><span id="molecule.get_neighbour_list-257"><a href="#molecule.get_neighbour_list-257"><span class="linenos">257</span></a>
</span><span id="molecule.get_neighbour_list-258"><a href="#molecule.get_neighbour_list-258"><span class="linenos">258</span></a><span class="sd">        Returns:</span>
</span><span id="molecule.get_neighbour_list-259"><a href="#molecule.get_neighbour_list-259"><span class="linenos">259</span></a><span class="sd">        - neighbour_list:</span>
</span><span id="molecule.get_neighbour_list-260"><a href="#molecule.get_neighbour_list-260"><span class="linenos">260</span></a><span class="sd">            - list of neighboured atoms containing their atom numbers.</span>
</span><span id="molecule.get_neighbour_list-261"><a href="#molecule.get_neighbour_list-261"><span class="linenos">261</span></a><span class="sd">        - idx_neighbour_list:</span>
</span><span id="molecule.get_neighbour_list-262"><a href="#molecule.get_neighbour_list-262"><span class="linenos">262</span></a><span class="sd">            - list of neighboured atoms containing their atom indexes.</span>
</span><span id="molecule.get_neighbour_list-263"><a href="#molecule.get_neighbour_list-263"><span class="linenos">263</span></a><span class="sd">        &quot;&quot;&quot;</span> 
</span><span id="molecule.get_neighbour_list-264"><a href="#molecule.get_neighbour_list-264"><span class="linenos">264</span></a>
</span><span id="molecule.get_neighbour_list-265"><a href="#molecule.get_neighbour_list-265"><span class="linenos">265</span></a>        <span class="n">idx_neighbour_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="molecule.get_neighbour_list-266"><a href="#molecule.get_neighbour_list-266"><span class="linenos">266</span></a>        <span class="n">idx_branch_ends</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="molecule.get_neighbour_list-267"><a href="#molecule.get_neighbour_list-267"><span class="linenos">267</span></a>        <span class="n">idx_branch_starts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="molecule.get_neighbour_list-268"><a href="#molecule.get_neighbour_list-268"><span class="linenos">268</span></a>        <span class="n">idx_ring_close</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="molecule.get_neighbour_list-269"><a href="#molecule.get_neighbour_list-269"><span class="linenos">269</span></a>        <span class="n">idx_branch_funs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="molecule.get_neighbour_list-270"><a href="#molecule.get_neighbour_list-270"><span class="linenos">270</span></a>
</span><span id="molecule.get_neighbour_list-271"><a href="#molecule.get_neighbour_list-271"><span class="linenos">271</span></a>        <span class="n">branches</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">))</span>
</span><span id="molecule.get_neighbour_list-272"><a href="#molecule.get_neighbour_list-272"><span class="linenos">272</span></a>        <span class="n">branch_origins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">))</span>
</span><span id="molecule.get_neighbour_list-273"><a href="#molecule.get_neighbour_list-273"><span class="linenos">273</span></a>        <span class="n">branch_count</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="molecule.get_neighbour_list-274"><a href="#molecule.get_neighbour_list-274"><span class="linenos">274</span></a>
</span><span id="molecule.get_neighbour_list-275"><a href="#molecule.get_neighbour_list-275"><span class="linenos">275</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_number</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="molecule.get_neighbour_list-276"><a href="#molecule.get_neighbour_list-276"><span class="linenos">276</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">idx_neighbour_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule.get_neighbour_list-277"><a href="#molecule.get_neighbour_list-277"><span class="linenos">277</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">neighbour_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule.get_neighbour_list-278"><a href="#molecule.get_neighbour_list-278"><span class="linenos">278</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">idx_bond_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule.get_neighbour_list-279"><a href="#molecule.get_neighbour_list-279"><span class="linenos">279</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">bond_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule.get_neighbour_list-280"><a href="#molecule.get_neighbour_list-280"><span class="linenos">280</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule.get_neighbour_list-281"><a href="#molecule.get_neighbour_list-281"><span class="linenos">281</span></a>
</span><span id="molecule.get_neighbour_list-282"><a href="#molecule.get_neighbour_list-282"><span class="linenos">282</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule.get_neighbour_list-283"><a href="#molecule.get_neighbour_list-283"><span class="linenos">283</span></a><span class="sd">        find branches and assign numbers.</span>
</span><span id="molecule.get_neighbour_list-284"><a href="#molecule.get_neighbour_list-284"><span class="linenos">284</span></a><span class="sd">        get main path through molecule.</span>
</span><span id="molecule.get_neighbour_list-285"><a href="#molecule.get_neighbour_list-285"><span class="linenos">285</span></a><span class="sd">        build molecule from this...</span>
</span><span id="molecule.get_neighbour_list-286"><a href="#molecule.get_neighbour_list-286"><span class="linenos">286</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule.get_neighbour_list-287"><a href="#molecule.get_neighbour_list-287"><span class="linenos">287</span></a>        <span class="n">inv_f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="molecule.get_neighbour_list-288"><a href="#molecule.get_neighbour_list-288"><span class="linenos">288</span></a>        <span class="n">branch_no</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="molecule.get_neighbour_list-289"><a href="#molecule.get_neighbour_list-289"><span class="linenos">289</span></a>        <span class="n">inv_f_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">inv_f</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)))</span>
</span><span id="molecule.get_neighbour_list-290"><a href="#molecule.get_neighbour_list-290"><span class="linenos">290</span></a>        <span class="n">inv_branches</span> <span class="o">=</span> <span class="n">inv_f</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="molecule.get_neighbour_list-291"><a href="#molecule.get_neighbour_list-291"><span class="linenos">291</span></a>        <span class="n">inv_branches</span><span class="p">[</span><span class="n">inv_branches</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="molecule.get_neighbour_list-292"><a href="#molecule.get_neighbour_list-292"><span class="linenos">292</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ifi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">inv_f_p</span><span class="p">,</span> <span class="n">inv_f</span><span class="p">[</span><span class="n">inv_f_p</span><span class="p">]):</span>
</span><span id="molecule.get_neighbour_list-293"><a href="#molecule.get_neighbour_list-293"><span class="linenos">293</span></a>            <span class="k">if</span> <span class="n">ifi</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># ring</span>
</span><span id="molecule.get_neighbour_list-294"><a href="#molecule.get_neighbour_list-294"><span class="linenos">294</span></a>                <span class="n">inv_branches</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="molecule.get_neighbour_list-295"><a href="#molecule.get_neighbour_list-295"><span class="linenos">295</span></a>            <span class="k">if</span> <span class="n">ifi</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># branch :)</span>
</span><span id="molecule.get_neighbour_list-296"><a href="#molecule.get_neighbour_list-296"><span class="linenos">296</span></a>                <span class="n">pp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">inv_branches</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)))</span>
</span><span id="molecule.get_neighbour_list-297"><a href="#molecule.get_neighbour_list-297"><span class="linenos">297</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">ifi</span><span class="p">:</span>
</span><span id="molecule.get_neighbour_list-298"><a href="#molecule.get_neighbour_list-298"><span class="linenos">298</span></a>                    <span class="n">p_branch</span> <span class="o">=</span> <span class="n">pp</span><span class="p">[</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="n">ifi</span><span class="p">)</span> <span class="p">:]</span>
</span><span id="molecule.get_neighbour_list-299"><a href="#molecule.get_neighbour_list-299"><span class="linenos">299</span></a>                    <span class="n">inv_branches</span><span class="p">[</span><span class="n">p_branch</span><span class="p">]</span> <span class="o">=</span> <span class="n">branch_no</span>
</span><span id="molecule.get_neighbour_list-300"><a href="#molecule.get_neighbour_list-300"><span class="linenos">300</span></a>                    <span class="n">inv_branches</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">branch_no</span>
</span><span id="molecule.get_neighbour_list-301"><a href="#molecule.get_neighbour_list-301"><span class="linenos">301</span></a>                    <span class="n">branch_no</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="molecule.get_neighbour_list-302"><a href="#molecule.get_neighbour_list-302"><span class="linenos">302</span></a>        <span class="n">branches</span> <span class="o">=</span> <span class="n">reenumerate_branches</span><span class="p">(</span><span class="n">inv_branches</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="molecule.get_neighbour_list-303"><a href="#molecule.get_neighbour_list-303"><span class="linenos">303</span></a>        <span class="c1"># print(branches)</span>
</span><span id="molecule.get_neighbour_list-304"><a href="#molecule.get_neighbour_list-304"><span class="linenos">304</span></a>
</span><span id="molecule.get_neighbour_list-305"><a href="#molecule.get_neighbour_list-305"><span class="linenos">305</span></a>        <span class="n">main_path_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">branches</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="molecule.get_neighbour_list-306"><a href="#molecule.get_neighbour_list-306"><span class="linenos">306</span></a>        <span class="n">main_path_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">[</span><span class="n">main_path_p</span><span class="p">]</span>
</span><span id="molecule.get_neighbour_list-307"><a href="#molecule.get_neighbour_list-307"><span class="linenos">307</span></a>
</span><span id="molecule.get_neighbour_list-308"><a href="#molecule.get_neighbour_list-308"><span class="linenos">308</span></a>        <span class="c1"># get bond list of main path</span>
</span><span id="molecule.get_neighbour_list-309"><a href="#molecule.get_neighbour_list-309"><span class="linenos">309</span></a>        <span class="n">bond_list</span> <span class="o">=</span> <span class="n">bond_list_from_simple_path</span><span class="p">(</span><span class="n">main_path_i</span><span class="p">)</span>
</span><span id="molecule.get_neighbour_list-310"><a href="#molecule.get_neighbour_list-310"><span class="linenos">310</span></a>        <span class="c1"># print( &quot;branches&quot;,branches )</span>
</span><span id="molecule.get_neighbour_list-311"><a href="#molecule.get_neighbour_list-311"><span class="linenos">311</span></a>
</span><span id="molecule.get_neighbour_list-312"><a href="#molecule.get_neighbour_list-312"><span class="linenos">312</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule.get_neighbour_list-313"><a href="#molecule.get_neighbour_list-313"><span class="linenos">313</span></a><span class="sd">        build bond list</span>
</span><span id="molecule.get_neighbour_list-314"><a href="#molecule.get_neighbour_list-314"><span class="linenos">314</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule.get_neighbour_list-315"><a href="#molecule.get_neighbour_list-315"><span class="linenos">315</span></a>        <span class="n">f_p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)))</span>
</span><span id="molecule.get_neighbour_list-316"><a href="#molecule.get_neighbour_list-316"><span class="linenos">316</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ring_root_indexes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="molecule.get_neighbour_list-317"><a href="#molecule.get_neighbour_list-317"><span class="linenos">317</span></a>        <span class="c1"># print(&quot;f_p , self.f[f_p]&quot;, f_p, self.f[f_p])</span>
</span><span id="molecule.get_neighbour_list-318"><a href="#molecule.get_neighbour_list-318"><span class="linenos">318</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">f_p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">[</span><span class="n">f_p</span><span class="p">]):</span>
</span><span id="molecule.get_neighbour_list-319"><a href="#molecule.get_neighbour_list-319"><span class="linenos">319</span></a>            <span class="c1">#print(branches)</span>
</span><span id="molecule.get_neighbour_list-320"><a href="#molecule.get_neighbour_list-320"><span class="linenos">320</span></a>            <span class="k">if</span> <span class="n">fi</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="molecule.get_neighbour_list-321"><a href="#molecule.get_neighbour_list-321"><span class="linenos">321</span></a>                <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span>
</span><span id="molecule.get_neighbour_list-322"><a href="#molecule.get_neighbour_list-322"><span class="linenos">322</span></a>                    <span class="n">get_diff_in_bond_lists</span><span class="p">(</span><span class="n">f_p</span><span class="p">[</span><span class="n">f_p</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</span><span id="molecule.get_neighbour_list-323"><a href="#molecule.get_neighbour_list-323"><span class="linenos">323</span></a>                <span class="p">)</span>  <span class="c1"># index of last atom</span>
</span><span id="molecule.get_neighbour_list-324"><a href="#molecule.get_neighbour_list-324"><span class="linenos">324</span></a>                <span class="n">branches</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_branch_root</span><span class="p">(</span>
</span><span id="molecule.get_neighbour_list-325"><a href="#molecule.get_neighbour_list-325"><span class="linenos">325</span></a>                    <span class="n">branches</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">branches</span>
</span><span id="molecule.get_neighbour_list-326"><a href="#molecule.get_neighbour_list-326"><span class="linenos">326</span></a>                <span class="p">)</span>  <span class="c1"># connect ring to acompanying branch</span>
</span><span id="molecule.get_neighbour_list-327"><a href="#molecule.get_neighbour_list-327"><span class="linenos">327</span></a>                <span class="n">subgraph</span> <span class="o">=</span> <span class="n">graph_from_bonds</span><span class="p">(</span><span class="n">bond_list</span><span class="p">)</span>
</span><span id="molecule.get_neighbour_list-328"><a href="#molecule.get_neighbour_list-328"><span class="linenos">328</span></a>                <span class="n">path_to_main</span> <span class="o">=</span> <span class="n">get_shortest_path</span><span class="p">(</span><span class="n">subgraph</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
</span><span id="molecule.get_neighbour_list-329"><a href="#molecule.get_neighbour_list-329"><span class="linenos">329</span></a>
</span><span id="molecule.get_neighbour_list-330"><a href="#molecule.get_neighbour_list-330"><span class="linenos">330</span></a>                <span class="n">bond_list_to_main</span> <span class="o">=</span> <span class="n">bond_list_from_simple_path</span><span class="p">(</span><span class="n">path_to_main</span><span class="p">)</span>
</span><span id="molecule.get_neighbour_list-331"><a href="#molecule.get_neighbour_list-331"><span class="linenos">331</span></a>                <span class="n">graph_to_main</span> <span class="o">=</span> <span class="n">graph_from_bonds</span><span class="p">(</span><span class="n">bond_list_to_main</span><span class="p">)</span>
</span><span id="molecule.get_neighbour_list-332"><a href="#molecule.get_neighbour_list-332"><span class="linenos">332</span></a>                <span class="n">root</span> <span class="o">=</span> <span class="n">get_root</span><span class="p">(</span><span class="n">graph_to_main</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">fi</span><span class="p">)))</span>
</span><span id="molecule.get_neighbour_list-333"><a href="#molecule.get_neighbour_list-333"><span class="linenos">333</span></a>                <span class="k">if</span> <span class="n">root</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="molecule.get_neighbour_list-334"><a href="#molecule.get_neighbour_list-334"><span class="linenos">334</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;root of ring outside molecule. ignore.&quot;</span><span class="p">)</span>
</span><span id="molecule.get_neighbour_list-335"><a href="#molecule.get_neighbour_list-335"><span class="linenos">335</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="molecule.get_neighbour_list-336"><a href="#molecule.get_neighbour_list-336"><span class="linenos">336</span></a>                    <span class="n">bond_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">bond_list</span><span class="p">,</span> <span class="p">[[</span><span class="n">root</span><span class="p">,</span> <span class="n">idx</span><span class="p">]]])</span>
</span><span id="molecule.get_neighbour_list-337"><a href="#molecule.get_neighbour_list-337"><span class="linenos">337</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">ring_root_indexes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
</span><span id="molecule.get_neighbour_list-338"><a href="#molecule.get_neighbour_list-338"><span class="linenos">338</span></a>            <span class="k">elif</span> <span class="n">fi</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="molecule.get_neighbour_list-339"><a href="#molecule.get_neighbour_list-339"><span class="linenos">339</span></a>                <span class="n">link</span> <span class="o">=</span> <span class="n">get_branch_root</span><span class="p">(</span><span class="n">branches</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">branches</span><span class="p">)</span>
</span><span id="molecule.get_neighbour_list-340"><a href="#molecule.get_neighbour_list-340"><span class="linenos">340</span></a>                <span class="n">branch</span> <span class="o">=</span> <span class="n">branches</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="molecule.get_neighbour_list-341"><a href="#molecule.get_neighbour_list-341"><span class="linenos">341</span></a>                <span class="n">p_subchain_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">branches</span> <span class="o">==</span> <span class="n">branch</span><span class="p">)))[</span>
</span><span id="molecule.get_neighbour_list-342"><a href="#molecule.get_neighbour_list-342"><span class="linenos">342</span></a>                    <span class="mi">1</span><span class="p">:</span>
</span><span id="molecule.get_neighbour_list-343"><a href="#molecule.get_neighbour_list-343"><span class="linenos">343</span></a>                <span class="p">]</span>
</span><span id="molecule.get_neighbour_list-344"><a href="#molecule.get_neighbour_list-344"><span class="linenos">344</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p_subchain_i</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">fi</span><span class="p">:</span>
</span><span id="molecule.get_neighbour_list-345"><a href="#molecule.get_neighbour_list-345"><span class="linenos">345</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;end of branch outside molecule. ignore.&quot;</span><span class="p">)</span>
</span><span id="molecule.get_neighbour_list-346"><a href="#molecule.get_neighbour_list-346"><span class="linenos">346</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="molecule.get_neighbour_list-347"><a href="#molecule.get_neighbour_list-347"><span class="linenos">347</span></a>                    <span class="n">p_subchain_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([[</span><span class="n">link</span><span class="p">],</span> <span class="n">p_subchain_i</span><span class="p">])</span>
</span><span id="molecule.get_neighbour_list-348"><a href="#molecule.get_neighbour_list-348"><span class="linenos">348</span></a>                    <span class="n">subchain_bond_list</span> <span class="o">=</span> <span class="n">bond_list_from_simple_path</span><span class="p">(</span><span class="n">p_subchain_i</span><span class="p">)</span>
</span><span id="molecule.get_neighbour_list-349"><a href="#molecule.get_neighbour_list-349"><span class="linenos">349</span></a>                    <span class="n">bond_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">bond_list</span><span class="p">,</span> <span class="n">subchain_bond_list</span><span class="p">])</span>
</span><span id="molecule.get_neighbour_list-350"><a href="#molecule.get_neighbour_list-350"><span class="linenos">350</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="molecule.get_neighbour_list-351"><a href="#molecule.get_neighbour_list-351"><span class="linenos">351</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;fi = 0... this should not happen :P&quot;</span><span class="p">)</span>
</span><span id="molecule.get_neighbour_list-352"><a href="#molecule.get_neighbour_list-352"><span class="linenos">352</span></a>        <span class="c1">#print(&quot;fin branches&quot;, branches)</span>
</span><span id="molecule.get_neighbour_list-353"><a href="#molecule.get_neighbour_list-353"><span class="linenos">353</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">idx_neighbour_list</span> <span class="o">=</span> <span class="n">bond_list</span>
</span><span id="molecule.get_neighbour_list-354"><a href="#molecule.get_neighbour_list-354"><span class="linenos">354</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">idx_bond_list</span> <span class="o">=</span> <span class="n">bond_list</span>
</span><span id="molecule.get_neighbour_list-355"><a href="#molecule.get_neighbour_list-355"><span class="linenos">355</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ring_root_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ring_root_indexes</span><span class="p">)</span>
</span><span id="molecule.get_neighbour_list-356"><a href="#molecule.get_neighbour_list-356"><span class="linenos">356</span></a>
</span><span id="molecule.get_neighbour_list-357"><a href="#molecule.get_neighbour_list-357"><span class="linenos">357</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">neighbour_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_atom_no</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">idx_neighbour_list</span><span class="p">)</span>
</span><span id="molecule.get_neighbour_list-358"><a href="#molecule.get_neighbour_list-358"><span class="linenos">358</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bond_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">neighbour_list</span>
</span><span id="molecule.get_neighbour_list-359"><a href="#molecule.get_neighbour_list-359"><span class="linenos">359</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">neighbour_list</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">idx_neighbour_list</span>
</span></pre></div>


            <div class="docstring"><p>generates a neighbour list from an initialized molecule</p>

<p>Parameters: None</p>

<p>Returns:</p>

<ul>
<li>neighbour_list:
<ul>
<li>list of neighboured atoms containing their atom numbers.</li>
</ul></li>
<li>idx_neighbour_list:
<ul>
<li>list of neighboured atoms containing their atom indexes.</li>
</ul></li>
</ul>
</div>


                            </div>
                            <div id="molecule.get_bond_matrix" class="classattr">
                                        <input id="molecule.get_bond_matrix-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_bond_matrix</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="molecule.get_bond_matrix-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#molecule.get_bond_matrix"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="molecule.get_bond_matrix-361"><a href="#molecule.get_bond_matrix-361"><span class="linenos">361</span></a>    <span class="k">def</span> <span class="nf">get_bond_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="molecule.get_bond_matrix-362"><a href="#molecule.get_bond_matrix-362"><span class="linenos">362</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule.get_bond_matrix-363"><a href="#molecule.get_bond_matrix-363"><span class="linenos">363</span></a><span class="sd">        generates bond matrix from an initialized molecule</span>
</span><span id="molecule.get_bond_matrix-364"><a href="#molecule.get_bond_matrix-364"><span class="linenos">364</span></a>
</span><span id="molecule.get_bond_matrix-365"><a href="#molecule.get_bond_matrix-365"><span class="linenos">365</span></a><span class="sd">        Parameters: None</span>
</span><span id="molecule.get_bond_matrix-366"><a href="#molecule.get_bond_matrix-366"><span class="linenos">366</span></a>
</span><span id="molecule.get_bond_matrix-367"><a href="#molecule.get_bond_matrix-367"><span class="linenos">367</span></a><span class="sd">        Returns:</span>
</span><span id="molecule.get_bond_matrix-368"><a href="#molecule.get_bond_matrix-368"><span class="linenos">368</span></a><span class="sd">        - bond_matrix:</span>
</span><span id="molecule.get_bond_matrix-369"><a href="#molecule.get_bond_matrix-369"><span class="linenos">369</span></a><span class="sd">            - bond matrix of you molecule</span>
</span><span id="molecule.get_bond_matrix-370"><a href="#molecule.get_bond_matrix-370"><span class="linenos">370</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule.get_bond_matrix-371"><a href="#molecule.get_bond_matrix-371"><span class="linenos">371</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bond_matrix</span> <span class="o">=</span> <span class="n">get_bond_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">neighbour_list</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_number</span><span class="p">)</span>
</span><span id="molecule.get_bond_matrix-372"><a href="#molecule.get_bond_matrix-372"><span class="linenos">372</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_matrix</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>generates bond matrix from an initialized molecule</p>

<p>Parameters: None</p>

<p>Returns:</p>

<ul>
<li>bond_matrix:
<ul>
<li>bond matrix of you molecule</li>
</ul></li>
</ul>
</div>


                            </div>
                            <div id="molecule.get_distance_matrix" class="classattr">
                                        <input id="molecule.get_distance_matrix-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_distance_matrix</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="molecule.get_distance_matrix-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#molecule.get_distance_matrix"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="molecule.get_distance_matrix-374"><a href="#molecule.get_distance_matrix-374"><span class="linenos">374</span></a>    <span class="k">def</span> <span class="nf">get_distance_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="molecule.get_distance_matrix-375"><a href="#molecule.get_distance_matrix-375"><span class="linenos">375</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule.get_distance_matrix-376"><a href="#molecule.get_distance_matrix-376"><span class="linenos">376</span></a><span class="sd">        generates distance matrix from an initialized molecule.</span>
</span><span id="molecule.get_distance_matrix-377"><a href="#molecule.get_distance_matrix-377"><span class="linenos">377</span></a><span class="sd">        Furthermore different angle and torsion lists are generated.</span>
</span><span id="molecule.get_distance_matrix-378"><a href="#molecule.get_distance_matrix-378"><span class="linenos">378</span></a>
</span><span id="molecule.get_distance_matrix-379"><a href="#molecule.get_distance_matrix-379"><span class="linenos">379</span></a><span class="sd">        Parameters: None</span>
</span><span id="molecule.get_distance_matrix-380"><a href="#molecule.get_distance_matrix-380"><span class="linenos">380</span></a><span class="sd">        </span>
</span><span id="molecule.get_distance_matrix-381"><a href="#molecule.get_distance_matrix-381"><span class="linenos">381</span></a><span class="sd">        Returns:</span>
</span><span id="molecule.get_distance_matrix-382"><a href="#molecule.get_distance_matrix-382"><span class="linenos">382</span></a><span class="sd">        - distance_matrix:</span>
</span><span id="molecule.get_distance_matrix-383"><a href="#molecule.get_distance_matrix-383"><span class="linenos">383</span></a><span class="sd">            - distance matrix of you molecule</span>
</span><span id="molecule.get_distance_matrix-384"><a href="#molecule.get_distance_matrix-384"><span class="linenos">384</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule.get_distance_matrix-385"><a href="#molecule.get_distance_matrix-385"><span class="linenos">385</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">distance_matrix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_lists</span> <span class="o">=</span> <span class="n">get_distance_matrix</span><span class="p">(</span>
</span><span id="molecule.get_distance_matrix-386"><a href="#molecule.get_distance_matrix-386"><span class="linenos">386</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">neighbour_list</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_number</span>
</span><span id="molecule.get_distance_matrix-387"><a href="#molecule.get_distance_matrix-387"><span class="linenos">387</span></a>        <span class="p">)</span>
</span><span id="molecule.get_distance_matrix-388"><a href="#molecule.get_distance_matrix-388"><span class="linenos">388</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bond_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_lists</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="molecule.get_distance_matrix-389"><a href="#molecule.get_distance_matrix-389"><span class="linenos">389</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bond_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="molecule.get_distance_matrix-390"><a href="#molecule.get_distance_matrix-390"><span class="linenos">390</span></a>            <span class="p">[</span><span class="n">sort_force_fields</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_names</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_list</span><span class="p">]</span>
</span><span id="molecule.get_distance_matrix-391"><a href="#molecule.get_distance_matrix-391"><span class="linenos">391</span></a>        <span class="p">)</span>
</span><span id="molecule.get_distance_matrix-392"><a href="#molecule.get_distance_matrix-392"><span class="linenos">392</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">bond_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">make_graph</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_names</span><span class="p">])</span>
</span><span id="molecule.get_distance_matrix-393"><a href="#molecule.get_distance_matrix-393"><span class="linenos">393</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bond_lists</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="molecule.get_distance_matrix-394"><a href="#molecule.get_distance_matrix-394"><span class="linenos">394</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">angle_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bond_lists</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="molecule.get_distance_matrix-395"><a href="#molecule.get_distance_matrix-395"><span class="linenos">395</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">angle_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="molecule.get_distance_matrix-396"><a href="#molecule.get_distance_matrix-396"><span class="linenos">396</span></a>                <span class="p">[</span><span class="n">sort_force_fields</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_names</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_list</span><span class="p">]</span>
</span><span id="molecule.get_distance_matrix-397"><a href="#molecule.get_distance_matrix-397"><span class="linenos">397</span></a>            <span class="p">)</span>
</span><span id="molecule.get_distance_matrix-398"><a href="#molecule.get_distance_matrix-398"><span class="linenos">398</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">angle_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">make_graph</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_names</span><span class="p">])</span>
</span><span id="molecule.get_distance_matrix-399"><a href="#molecule.get_distance_matrix-399"><span class="linenos">399</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="molecule.get_distance_matrix-400"><a href="#molecule.get_distance_matrix-400"><span class="linenos">400</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">angle_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule.get_distance_matrix-401"><a href="#molecule.get_distance_matrix-401"><span class="linenos">401</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">angle_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule.get_distance_matrix-402"><a href="#molecule.get_distance_matrix-402"><span class="linenos">402</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">angle_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule.get_distance_matrix-403"><a href="#molecule.get_distance_matrix-403"><span class="linenos">403</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bond_lists</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="molecule.get_distance_matrix-404"><a href="#molecule.get_distance_matrix-404"><span class="linenos">404</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">torsion_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bond_lists</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="molecule.get_distance_matrix-405"><a href="#molecule.get_distance_matrix-405"><span class="linenos">405</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">torsion_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
</span><span id="molecule.get_distance_matrix-406"><a href="#molecule.get_distance_matrix-406"><span class="linenos">406</span></a>                <span class="p">[</span><span class="n">sort_force_fields</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_names</span><span class="p">[</span><span class="n">a</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">torsion_list</span><span class="p">]</span>
</span><span id="molecule.get_distance_matrix-407"><a href="#molecule.get_distance_matrix-407"><span class="linenos">407</span></a>            <span class="p">)</span>
</span><span id="molecule.get_distance_matrix-408"><a href="#molecule.get_distance_matrix-408"><span class="linenos">408</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">torsion_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">make_graph</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">torsion_names</span><span class="p">])</span>
</span><span id="molecule.get_distance_matrix-409"><a href="#molecule.get_distance_matrix-409"><span class="linenos">409</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="molecule.get_distance_matrix-410"><a href="#molecule.get_distance_matrix-410"><span class="linenos">410</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">torsion_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule.get_distance_matrix-411"><a href="#molecule.get_distance_matrix-411"><span class="linenos">411</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">torsion_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule.get_distance_matrix-412"><a href="#molecule.get_distance_matrix-412"><span class="linenos">412</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">torsion_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</span><span id="molecule.get_distance_matrix-413"><a href="#molecule.get_distance_matrix-413"><span class="linenos">413</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance_matrix</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>generates distance matrix from an initialized molecule.
Furthermore different angle and torsion lists are generated.</p>

<p>Parameters: None</p>

<p>Returns:</p>

<ul>
<li>distance_matrix:
<ul>
<li>distance matrix of you molecule</li>
</ul></li>
</ul>
</div>


                            </div>
                            <div id="molecule.get_atom_index" class="classattr">
                                        <input id="molecule.get_atom_index-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_atom_index</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">no</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="molecule.get_atom_index-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#molecule.get_atom_index"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="molecule.get_atom_index-415"><a href="#molecule.get_atom_index-415"><span class="linenos">415</span></a>    <span class="k">def</span> <span class="nf">get_atom_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">no</span><span class="p">):</span>
</span><span id="molecule.get_atom_index-416"><a href="#molecule.get_atom_index-416"><span class="linenos">416</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule.get_atom_index-417"><a href="#molecule.get_atom_index-417"><span class="linenos">417</span></a><span class="sd">        returns index of atom.</span>
</span><span id="molecule.get_atom_index-418"><a href="#molecule.get_atom_index-418"><span class="linenos">418</span></a><span class="sd">        - Number: atom number</span>
</span><span id="molecule.get_atom_index-419"><a href="#molecule.get_atom_index-419"><span class="linenos">419</span></a><span class="sd">        - Index:  index in list representation of molecule.</span>
</span><span id="molecule.get_atom_index-420"><a href="#molecule.get_atom_index-420"><span class="linenos">420</span></a><span class="sd">        Number and index are differing due to functionals in the list.</span>
</span><span id="molecule.get_atom_index-421"><a href="#molecule.get_atom_index-421"><span class="linenos">421</span></a>
</span><span id="molecule.get_atom_index-422"><a href="#molecule.get_atom_index-422"><span class="linenos">422</span></a><span class="sd">        Parameters:</span>
</span><span id="molecule.get_atom_index-423"><a href="#molecule.get_atom_index-423"><span class="linenos">423</span></a><span class="sd">        - no:</span>
</span><span id="molecule.get_atom_index-424"><a href="#molecule.get_atom_index-424"><span class="linenos">424</span></a><span class="sd">           - number of the atom</span>
</span><span id="molecule.get_atom_index-425"><a href="#molecule.get_atom_index-425"><span class="linenos">425</span></a><span class="sd">           </span>
</span><span id="molecule.get_atom_index-426"><a href="#molecule.get_atom_index-426"><span class="linenos">426</span></a><span class="sd">        Returns:</span>
</span><span id="molecule.get_atom_index-427"><a href="#molecule.get_atom_index-427"><span class="linenos">427</span></a><span class="sd">        - index of atom number &quot;no&quot;</span>
</span><span id="molecule.get_atom_index-428"><a href="#molecule.get_atom_index-428"><span class="linenos">428</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule.get_atom_index-429"><a href="#molecule.get_atom_index-429"><span class="linenos">429</span></a>        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_indexes</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">no</span><span class="p">)])</span>  <span class="c1"># int(np.squeeze(np.where(self.n==no)))</span>
</span></pre></div>


            <div class="docstring"><p>returns index of atom.</p>

<ul>
<li>Number: atom number</li>
<li>Index:  index in list representation of molecule.
Number and index are differing due to functionals in the list.</li>
</ul>

<p>Parameters:</p>

<ul>
<li>no:
<ul>
<li>number of the atom</li>
</ul></li>
</ul>

<p>Returns:</p>

<ul>
<li>index of atom number "no"</li>
</ul>
</div>


                            </div>
                            <div id="molecule.get_atom_no" class="classattr">
                                        <input id="molecule.get_atom_no-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_atom_no</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">idx</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="molecule.get_atom_no-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#molecule.get_atom_no"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="molecule.get_atom_no-431"><a href="#molecule.get_atom_no-431"><span class="linenos">431</span></a>    <span class="k">def</span> <span class="nf">get_atom_no</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
</span><span id="molecule.get_atom_no-432"><a href="#molecule.get_atom_no-432"><span class="linenos">432</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule.get_atom_no-433"><a href="#molecule.get_atom_no-433"><span class="linenos">433</span></a><span class="sd">        returns index of atom.</span>
</span><span id="molecule.get_atom_no-434"><a href="#molecule.get_atom_no-434"><span class="linenos">434</span></a><span class="sd">        - Number: atom number</span>
</span><span id="molecule.get_atom_no-435"><a href="#molecule.get_atom_no-435"><span class="linenos">435</span></a><span class="sd">        - Index:  index in list representation of molecule.</span>
</span><span id="molecule.get_atom_no-436"><a href="#molecule.get_atom_no-436"><span class="linenos">436</span></a><span class="sd">        Number and index are differing due to functionals in the list.</span>
</span><span id="molecule.get_atom_no-437"><a href="#molecule.get_atom_no-437"><span class="linenos">437</span></a>
</span><span id="molecule.get_atom_no-438"><a href="#molecule.get_atom_no-438"><span class="linenos">438</span></a><span class="sd">        Parameters:</span>
</span><span id="molecule.get_atom_no-439"><a href="#molecule.get_atom_no-439"><span class="linenos">439</span></a><span class="sd">        - idx:</span>
</span><span id="molecule.get_atom_no-440"><a href="#molecule.get_atom_no-440"><span class="linenos">440</span></a><span class="sd">            - idx of the atom</span>
</span><span id="molecule.get_atom_no-441"><a href="#molecule.get_atom_no-441"><span class="linenos">441</span></a><span class="sd">            </span>
</span><span id="molecule.get_atom_no-442"><a href="#molecule.get_atom_no-442"><span class="linenos">442</span></a><span class="sd">        Returns:</span>
</span><span id="molecule.get_atom_no-443"><a href="#molecule.get_atom_no-443"><span class="linenos">443</span></a><span class="sd">        - number of atom with index</span>
</span><span id="molecule.get_atom_no-444"><a href="#molecule.get_atom_no-444"><span class="linenos">444</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule.get_atom_no-445"><a href="#molecule.get_atom_no-445"><span class="linenos">445</span></a>        <span class="n">idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
</span><span id="molecule.get_atom_no-446"><a href="#molecule.get_atom_no-446"><span class="linenos">446</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="molecule.get_atom_no-447"><a href="#molecule.get_atom_no-447"><span class="linenos">447</span></a>            <span class="n">no</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_indexes</span> <span class="o">==</span> <span class="n">idx</span><span class="p">)))</span>
</span><span id="molecule.get_atom_no-448"><a href="#molecule.get_atom_no-448"><span class="linenos">448</span></a>            <span class="k">assert</span> <span class="n">no</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="s2">&quot;atom numbers dont work&quot;</span>
</span><span id="molecule.get_atom_no-449"><a href="#molecule.get_atom_no-449"><span class="linenos">449</span></a>            <span class="k">return</span> <span class="n">no</span>
</span><span id="molecule.get_atom_no-450"><a href="#molecule.get_atom_no-450"><span class="linenos">450</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="molecule.get_atom_no-451"><a href="#molecule.get_atom_no-451"><span class="linenos">451</span></a>            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;atom numbers dont work&quot;</span>
</span><span id="molecule.get_atom_no-452"><a href="#molecule.get_atom_no-452"><span class="linenos">452</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error in get_atom_no: not an atom&quot;</span><span class="p">)</span>
</span><span id="molecule.get_atom_no-453"><a href="#molecule.get_atom_no-453"><span class="linenos">453</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>returns index of atom.</p>

<ul>
<li>Number: atom number</li>
<li>Index:  index in list representation of molecule.
Number and index are differing due to functionals in the list.</li>
</ul>

<p>Parameters:</p>

<ul>
<li>idx:
<ul>
<li>idx of the atom</li>
</ul></li>
</ul>

<p>Returns:</p>

<ul>
<li>number of atom with index</li>
</ul>
</div>


                            </div>
                            <div id="molecule.get_next_atom_idx" class="classattr">
                                        <input id="molecule.get_next_atom_idx-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_next_atom_idx</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">idx</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="molecule.get_next_atom_idx-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#molecule.get_next_atom_idx"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="molecule.get_next_atom_idx-455"><a href="#molecule.get_next_atom_idx-455"><span class="linenos">455</span></a>    <span class="k">def</span> <span class="nf">get_next_atom_idx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
</span><span id="molecule.get_next_atom_idx-456"><a href="#molecule.get_next_atom_idx-456"><span class="linenos">456</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule.get_next_atom_idx-457"><a href="#molecule.get_next_atom_idx-457"><span class="linenos">457</span></a><span class="sd">        returns index of the next atom after index idx.</span>
</span><span id="molecule.get_next_atom_idx-458"><a href="#molecule.get_next_atom_idx-458"><span class="linenos">458</span></a><span class="sd">        Index:  index in list representation of molecule.</span>
</span><span id="molecule.get_next_atom_idx-459"><a href="#molecule.get_next_atom_idx-459"><span class="linenos">459</span></a><span class="sd">        Number and index are differing due to functionals in the list.</span>
</span><span id="molecule.get_next_atom_idx-460"><a href="#molecule.get_next_atom_idx-460"><span class="linenos">460</span></a>
</span><span id="molecule.get_next_atom_idx-461"><a href="#molecule.get_next_atom_idx-461"><span class="linenos">461</span></a><span class="sd">        Parameters:</span>
</span><span id="molecule.get_next_atom_idx-462"><a href="#molecule.get_next_atom_idx-462"><span class="linenos">462</span></a><span class="sd">        idx:</span>
</span><span id="molecule.get_next_atom_idx-463"><a href="#molecule.get_next_atom_idx-463"><span class="linenos">463</span></a><span class="sd">            - index in list representation of molecule</span>
</span><span id="molecule.get_next_atom_idx-464"><a href="#molecule.get_next_atom_idx-464"><span class="linenos">464</span></a><span class="sd">            </span>
</span><span id="molecule.get_next_atom_idx-465"><a href="#molecule.get_next_atom_idx-465"><span class="linenos">465</span></a><span class="sd">        Returns:</span>
</span><span id="molecule.get_next_atom_idx-466"><a href="#molecule.get_next_atom_idx-466"><span class="linenos">466</span></a><span class="sd">        - index of the next atom after index idx</span>
</span><span id="molecule.get_next_atom_idx-467"><a href="#molecule.get_next_atom_idx-467"><span class="linenos">467</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule.get_next_atom_idx-468"><a href="#molecule.get_next_atom_idx-468"><span class="linenos">468</span></a>        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_indexes</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_indexes</span> <span class="o">-</span> <span class="n">idx</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]))</span>
</span></pre></div>


            <div class="docstring"><p>returns index of the next atom after index idx.
Index:  index in list representation of molecule.
Number and index are differing due to functionals in the list.</p>

<p>Parameters:
idx:
    - index in list representation of molecule</p>

<p>Returns:</p>

<ul>
<li>index of the next atom after index idx</li>
</ul>
</div>


                            </div>
                            <div id="molecule.get_last_atom_idx" class="classattr">
                                        <input id="molecule.get_last_atom_idx-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_last_atom_idx</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">idx</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="molecule.get_last_atom_idx-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#molecule.get_last_atom_idx"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="molecule.get_last_atom_idx-470"><a href="#molecule.get_last_atom_idx-470"><span class="linenos">470</span></a>    <span class="k">def</span> <span class="nf">get_last_atom_idx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
</span><span id="molecule.get_last_atom_idx-471"><a href="#molecule.get_last_atom_idx-471"><span class="linenos">471</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule.get_last_atom_idx-472"><a href="#molecule.get_last_atom_idx-472"><span class="linenos">472</span></a><span class="sd">        returns index of the atom before index idx.</span>
</span><span id="molecule.get_last_atom_idx-473"><a href="#molecule.get_last_atom_idx-473"><span class="linenos">473</span></a><span class="sd">        Index:  index in list representation of molecule.</span>
</span><span id="molecule.get_last_atom_idx-474"><a href="#molecule.get_last_atom_idx-474"><span class="linenos">474</span></a><span class="sd">        Number and index are differing due to functionals in the list.</span>
</span><span id="molecule.get_last_atom_idx-475"><a href="#molecule.get_last_atom_idx-475"><span class="linenos">475</span></a>
</span><span id="molecule.get_last_atom_idx-476"><a href="#molecule.get_last_atom_idx-476"><span class="linenos">476</span></a><span class="sd">        Parameters:</span>
</span><span id="molecule.get_last_atom_idx-477"><a href="#molecule.get_last_atom_idx-477"><span class="linenos">477</span></a><span class="sd">        idx:</span>
</span><span id="molecule.get_last_atom_idx-478"><a href="#molecule.get_last_atom_idx-478"><span class="linenos">478</span></a><span class="sd">            - index in list representation of molecule</span>
</span><span id="molecule.get_last_atom_idx-479"><a href="#molecule.get_last_atom_idx-479"><span class="linenos">479</span></a><span class="sd">            </span>
</span><span id="molecule.get_last_atom_idx-480"><a href="#molecule.get_last_atom_idx-480"><span class="linenos">480</span></a><span class="sd">        Returns:</span>
</span><span id="molecule.get_last_atom_idx-481"><a href="#molecule.get_last_atom_idx-481"><span class="linenos">481</span></a><span class="sd">        - index of the atom before index idx</span>
</span><span id="molecule.get_last_atom_idx-482"><a href="#molecule.get_last_atom_idx-482"><span class="linenos">482</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule.get_last_atom_idx-483"><a href="#molecule.get_last_atom_idx-483"><span class="linenos">483</span></a>        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_indexes</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_indexes</span> <span class="o">-</span> <span class="n">idx</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]))</span>
</span></pre></div>


            <div class="docstring"><p>returns index of the atom before index idx.
Index:  index in list representation of molecule.
Number and index are differing due to functionals in the list.</p>

<p>Parameters:
idx:
    - index in list representation of molecule</p>

<p>Returns:</p>

<ul>
<li>index of the atom before index idx</li>
</ul>
</div>


                            </div>
                            <div id="molecule.get_next_atom_no" class="classattr">
                                        <input id="molecule.get_next_atom_no-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_next_atom_no</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">idx</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="molecule.get_next_atom_no-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#molecule.get_next_atom_no"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="molecule.get_next_atom_no-485"><a href="#molecule.get_next_atom_no-485"><span class="linenos">485</span></a>    <span class="k">def</span> <span class="nf">get_next_atom_no</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
</span><span id="molecule.get_next_atom_no-486"><a href="#molecule.get_next_atom_no-486"><span class="linenos">486</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule.get_next_atom_no-487"><a href="#molecule.get_next_atom_no-487"><span class="linenos">487</span></a><span class="sd">        returns number of the atom after index idx.</span>
</span><span id="molecule.get_next_atom_no-488"><a href="#molecule.get_next_atom_no-488"><span class="linenos">488</span></a><span class="sd">        Index:  index in list representation of molecule.</span>
</span><span id="molecule.get_next_atom_no-489"><a href="#molecule.get_next_atom_no-489"><span class="linenos">489</span></a><span class="sd">        Number: atom number</span>
</span><span id="molecule.get_next_atom_no-490"><a href="#molecule.get_next_atom_no-490"><span class="linenos">490</span></a><span class="sd">        Number and index are differing due to functionals in the list.</span>
</span><span id="molecule.get_next_atom_no-491"><a href="#molecule.get_next_atom_no-491"><span class="linenos">491</span></a>
</span><span id="molecule.get_next_atom_no-492"><a href="#molecule.get_next_atom_no-492"><span class="linenos">492</span></a><span class="sd">        Parameters:</span>
</span><span id="molecule.get_next_atom_no-493"><a href="#molecule.get_next_atom_no-493"><span class="linenos">493</span></a><span class="sd">        - idx:</span>
</span><span id="molecule.get_next_atom_no-494"><a href="#molecule.get_next_atom_no-494"><span class="linenos">494</span></a><span class="sd">            - index in list representation of molecule</span>
</span><span id="molecule.get_next_atom_no-495"><a href="#molecule.get_next_atom_no-495"><span class="linenos">495</span></a><span class="sd">            </span>
</span><span id="molecule.get_next_atom_no-496"><a href="#molecule.get_next_atom_no-496"><span class="linenos">496</span></a><span class="sd">        Returns:</span>
</span><span id="molecule.get_next_atom_no-497"><a href="#molecule.get_next_atom_no-497"><span class="linenos">497</span></a><span class="sd">        - number of the atom after index idx</span>
</span><span id="molecule.get_next_atom_no-498"><a href="#molecule.get_next_atom_no-498"><span class="linenos">498</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule.get_next_atom_no-499"><a href="#molecule.get_next_atom_no-499"><span class="linenos">499</span></a>        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_next_atom_idx</span><span class="p">(</span><span class="n">idx</span><span class="p">)])</span>
</span></pre></div>


            <div class="docstring"><p>returns number of the atom after index idx.
Index:  index in list representation of molecule.
Number: atom number
Number and index are differing due to functionals in the list.</p>

<p>Parameters:</p>

<ul>
<li>idx:
<ul>
<li>index in list representation of molecule</li>
</ul></li>
</ul>

<p>Returns:</p>

<ul>
<li>number of the atom after index idx</li>
</ul>
</div>


                            </div>
                            <div id="molecule.get_last_atom_no" class="classattr">
                                        <input id="molecule.get_last_atom_no-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_last_atom_no</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">idx</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="molecule.get_last_atom_no-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#molecule.get_last_atom_no"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="molecule.get_last_atom_no-501"><a href="#molecule.get_last_atom_no-501"><span class="linenos">501</span></a>    <span class="k">def</span> <span class="nf">get_last_atom_no</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
</span><span id="molecule.get_last_atom_no-502"><a href="#molecule.get_last_atom_no-502"><span class="linenos">502</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule.get_last_atom_no-503"><a href="#molecule.get_last_atom_no-503"><span class="linenos">503</span></a><span class="sd">        returns number of the atom before index idx.</span>
</span><span id="molecule.get_last_atom_no-504"><a href="#molecule.get_last_atom_no-504"><span class="linenos">504</span></a><span class="sd">        Index:  index in list representation of molecule.</span>
</span><span id="molecule.get_last_atom_no-505"><a href="#molecule.get_last_atom_no-505"><span class="linenos">505</span></a><span class="sd">        Number: atom number</span>
</span><span id="molecule.get_last_atom_no-506"><a href="#molecule.get_last_atom_no-506"><span class="linenos">506</span></a><span class="sd">        Number and index are differing due to functionals in the list.</span>
</span><span id="molecule.get_last_atom_no-507"><a href="#molecule.get_last_atom_no-507"><span class="linenos">507</span></a>
</span><span id="molecule.get_last_atom_no-508"><a href="#molecule.get_last_atom_no-508"><span class="linenos">508</span></a><span class="sd">        Parameters:</span>
</span><span id="molecule.get_last_atom_no-509"><a href="#molecule.get_last_atom_no-509"><span class="linenos">509</span></a><span class="sd">            self:</span>
</span><span id="molecule.get_last_atom_no-510"><a href="#molecule.get_last_atom_no-510"><span class="linenos">510</span></a><span class="sd">                - initialized molecule.</span>
</span><span id="molecule.get_last_atom_no-511"><a href="#molecule.get_last_atom_no-511"><span class="linenos">511</span></a><span class="sd">            idx:</span>
</span><span id="molecule.get_last_atom_no-512"><a href="#molecule.get_last_atom_no-512"><span class="linenos">512</span></a><span class="sd">                - index in list representation of molecule</span>
</span><span id="molecule.get_last_atom_no-513"><a href="#molecule.get_last_atom_no-513"><span class="linenos">513</span></a><span class="sd">                </span>
</span><span id="molecule.get_last_atom_no-514"><a href="#molecule.get_last_atom_no-514"><span class="linenos">514</span></a><span class="sd">        Returns:</span>
</span><span id="molecule.get_last_atom_no-515"><a href="#molecule.get_last_atom_no-515"><span class="linenos">515</span></a><span class="sd">            number of the atom before index idx</span>
</span><span id="molecule.get_last_atom_no-516"><a href="#molecule.get_last_atom_no-516"><span class="linenos">516</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule.get_last_atom_no-517"><a href="#molecule.get_last_atom_no-517"><span class="linenos">517</span></a>        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_last_atom_idx</span><span class="p">(</span><span class="n">idx</span><span class="p">)])</span>
</span></pre></div>


            <div class="docstring"><p>returns number of the atom before index idx.
Index:  index in list representation of molecule.
Number: atom number
Number and index are differing due to functionals in the list.</p>

<p>Parameters:
    self:
        - initialized molecule.
    idx:
        - index in list representation of molecule</p>

<p>Returns:
    number of the atom before index idx</p>
</div>


                            </div>
                            <div id="molecule.map_molecule_via_atom_names" class="classattr">
                                        <input id="molecule.map_molecule_via_atom_names-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">map_molecule_via_atom_names</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">data</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="molecule.map_molecule_via_atom_names-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#molecule.map_molecule_via_atom_names"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="molecule.map_molecule_via_atom_names-519"><a href="#molecule.map_molecule_via_atom_names-519"><span class="linenos">519</span></a>    <span class="k">def</span> <span class="nf">map_molecule_via_atom_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="molecule.map_molecule_via_atom_names-520"><a href="#molecule.map_molecule_via_atom_names-520"><span class="linenos">520</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule.map_molecule_via_atom_names-521"><a href="#molecule.map_molecule_via_atom_names-521"><span class="linenos">521</span></a><span class="sd">        maps information from a dictionary onto the molecule.</span>
</span><span id="molecule.map_molecule_via_atom_names-522"><a href="#molecule.map_molecule_via_atom_names-522"><span class="linenos">522</span></a><span class="sd">        Use this for molecule information i.e. coordinates, group contributions,...</span>
</span><span id="molecule.map_molecule_via_atom_names-523"><a href="#molecule.map_molecule_via_atom_names-523"><span class="linenos">523</span></a>
</span><span id="molecule.map_molecule_via_atom_names-524"><a href="#molecule.map_molecule_via_atom_names-524"><span class="linenos">524</span></a><span class="sd">        Parameters:</span>
</span><span id="molecule.map_molecule_via_atom_names-525"><a href="#molecule.map_molecule_via_atom_names-525"><span class="linenos">525</span></a><span class="sd">        - data:</span>
</span><span id="molecule.map_molecule_via_atom_names-526"><a href="#molecule.map_molecule_via_atom_names-526"><span class="linenos">526</span></a><span class="sd">            - dictionary with: keys == atom names !!!</span>
</span><span id="molecule.map_molecule_via_atom_names-527"><a href="#molecule.map_molecule_via_atom_names-527"><span class="linenos">527</span></a><span class="sd">            </span>
</span><span id="molecule.map_molecule_via_atom_names-528"><a href="#molecule.map_molecule_via_atom_names-528"><span class="linenos">528</span></a><span class="sd">        Returns:</span>
</span><span id="molecule.map_molecule_via_atom_names-529"><a href="#molecule.map_molecule_via_atom_names-529"><span class="linenos">529</span></a><span class="sd">        - mapped data</span>
</span><span id="molecule.map_molecule_via_atom_names-530"><a href="#molecule.map_molecule_via_atom_names-530"><span class="linenos">530</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule.map_molecule_via_atom_names-531"><a href="#molecule.map_molecule_via_atom_names-531"><span class="linenos">531</span></a>        <span class="k">return</span> <span class="p">[</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_names</span><span class="p">)]</span>
</span></pre></div>


            <div class="docstring"><p>maps information from a dictionary onto the molecule.
Use this for molecule information i.e. coordinates, group contributions,...</p>

<p>Parameters:</p>

<ul>
<li>data:
<ul>
<li>dictionary with: keys == atom names !!!</li>
</ul></li>
</ul>

<p>Returns:</p>

<ul>
<li>mapped data</li>
</ul>
</div>


                            </div>
                            <div id="molecule.map_unique_via_atom_names" class="classattr">
                                        <input id="molecule.map_unique_via_atom_names-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">map_unique_via_atom_names</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">data</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="molecule.map_unique_via_atom_names-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#molecule.map_unique_via_atom_names"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="molecule.map_unique_via_atom_names-533"><a href="#molecule.map_unique_via_atom_names-533"><span class="linenos">533</span></a>    <span class="k">def</span> <span class="nf">map_unique_via_atom_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="molecule.map_unique_via_atom_names-534"><a href="#molecule.map_unique_via_atom_names-534"><span class="linenos">534</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule.map_unique_via_atom_names-535"><a href="#molecule.map_unique_via_atom_names-535"><span class="linenos">535</span></a><span class="sd">        Maps information from a dictionary onto unique elements of the molecule.</span>
</span><span id="molecule.map_unique_via_atom_names-536"><a href="#molecule.map_unique_via_atom_names-536"><span class="linenos">536</span></a><span class="sd">        Preserves the order of the original list.</span>
</span><span id="molecule.map_unique_via_atom_names-537"><a href="#molecule.map_unique_via_atom_names-537"><span class="linenos">537</span></a><span class="sd">        Use this for force-field information i.e. potentials,...</span>
</span><span id="molecule.map_unique_via_atom_names-538"><a href="#molecule.map_unique_via_atom_names-538"><span class="linenos">538</span></a>
</span><span id="molecule.map_unique_via_atom_names-539"><a href="#molecule.map_unique_via_atom_names-539"><span class="linenos">539</span></a><span class="sd">        Parameters:</span>
</span><span id="molecule.map_unique_via_atom_names-540"><a href="#molecule.map_unique_via_atom_names-540"><span class="linenos">540</span></a><span class="sd">        - data:</span>
</span><span id="molecule.map_unique_via_atom_names-541"><a href="#molecule.map_unique_via_atom_names-541"><span class="linenos">541</span></a><span class="sd">            - dictionary with: keys == atom names !!!</span>
</span><span id="molecule.map_unique_via_atom_names-542"><a href="#molecule.map_unique_via_atom_names-542"><span class="linenos">542</span></a><span class="sd">            </span>
</span><span id="molecule.map_unique_via_atom_names-543"><a href="#molecule.map_unique_via_atom_names-543"><span class="linenos">543</span></a><span class="sd">        Returns:</span>
</span><span id="molecule.map_unique_via_atom_names-544"><a href="#molecule.map_unique_via_atom_names-544"><span class="linenos">544</span></a><span class="sd">        - mapped unique data</span>
</span><span id="molecule.map_unique_via_atom_names-545"><a href="#molecule.map_unique_via_atom_names-545"><span class="linenos">545</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule.map_unique_via_atom_names-546"><a href="#molecule.map_unique_via_atom_names-546"><span class="linenos">546</span></a>        <span class="nb">print</span><span class="p">(</span>
</span><span id="molecule.map_unique_via_atom_names-547"><a href="#molecule.map_unique_via_atom_names-547"><span class="linenos">547</span></a>            <span class="s2">&quot;map_unique_via_atom_names is outtdated... dont use</span><span class="se">\n</span><span class="s2"> shouldnt cause errors btw&quot;</span>
</span><span id="molecule.map_unique_via_atom_names-548"><a href="#molecule.map_unique_via_atom_names-548"><span class="linenos">548</span></a>        <span class="p">)</span>
</span><span id="molecule.map_unique_via_atom_names-549"><a href="#molecule.map_unique_via_atom_names-549"><span class="linenos">549</span></a>        <span class="k">return</span> <span class="p">[</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unique_atom_names</span><span class="p">)]</span>
</span></pre></div>


            <div class="docstring"><p>Maps information from a dictionary onto unique elements of the molecule.
Preserves the order of the original list.
Use this for force-field information i.e. potentials,...</p>

<p>Parameters:</p>

<ul>
<li>data:
<ul>
<li>dictionary with: keys == atom names !!!</li>
</ul></li>
</ul>

<p>Returns:</p>

<ul>
<li>mapped unique data</li>
</ul>
</div>


                            </div>
                            <div id="molecule.map_molecule" class="classattr">
                                        <input id="molecule.map_molecule-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">map_molecule</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">goal</span>, </span><span class="param"><span class="n">data</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="molecule.map_molecule-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#molecule.map_molecule"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="molecule.map_molecule-551"><a href="#molecule.map_molecule-551"><span class="linenos">551</span></a>    <span class="k">def</span> <span class="nf">map_molecule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">goal</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="molecule.map_molecule-552"><a href="#molecule.map_molecule-552"><span class="linenos">552</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule.map_molecule-553"><a href="#molecule.map_molecule-553"><span class="linenos">553</span></a><span class="sd">        maps information from a dictionary onto a goal.</span>
</span><span id="molecule.map_molecule-554"><a href="#molecule.map_molecule-554"><span class="linenos">554</span></a><span class="sd">        Use this for molecule information i.e. coordinates, group contributions,...</span>
</span><span id="molecule.map_molecule-555"><a href="#molecule.map_molecule-555"><span class="linenos">555</span></a>
</span><span id="molecule.map_molecule-556"><a href="#molecule.map_molecule-556"><span class="linenos">556</span></a>
</span><span id="molecule.map_molecule-557"><a href="#molecule.map_molecule-557"><span class="linenos">557</span></a><span class="sd">        Parameters:</span>
</span><span id="molecule.map_molecule-558"><a href="#molecule.map_molecule-558"><span class="linenos">558</span></a><span class="sd">        - goal:</span>
</span><span id="molecule.map_molecule-559"><a href="#molecule.map_molecule-559"><span class="linenos">559</span></a><span class="sd">            - list of keys</span>
</span><span id="molecule.map_molecule-560"><a href="#molecule.map_molecule-560"><span class="linenos">560</span></a><span class="sd">        - data:</span>
</span><span id="molecule.map_molecule-561"><a href="#molecule.map_molecule-561"><span class="linenos">561</span></a><span class="sd">            - dictionary with keys in goal</span>
</span><span id="molecule.map_molecule-562"><a href="#molecule.map_molecule-562"><span class="linenos">562</span></a><span class="sd">            </span>
</span><span id="molecule.map_molecule-563"><a href="#molecule.map_molecule-563"><span class="linenos">563</span></a><span class="sd">        Returns:</span>
</span><span id="molecule.map_molecule-564"><a href="#molecule.map_molecule-564"><span class="linenos">564</span></a><span class="sd">        - mapped data</span>
</span><span id="molecule.map_molecule-565"><a href="#molecule.map_molecule-565"><span class="linenos">565</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule.map_molecule-566"><a href="#molecule.map_molecule-566"><span class="linenos">566</span></a>        <span class="k">return</span> <span class="p">[</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="n">goal</span><span class="p">)]</span>
</span></pre></div>


            <div class="docstring"><p>maps information from a dictionary onto a goal.
Use this for molecule information i.e. coordinates, group contributions,...</p>

<p>Parameters:</p>

<ul>
<li>goal:
<ul>
<li>list of keys</li>
</ul></li>
<li>data:
<ul>
<li>dictionary with keys in goal</li>
</ul></li>
</ul>

<p>Returns:</p>

<ul>
<li>mapped data</li>
</ul>
</div>


                            </div>
                            <div id="molecule.map_unique" class="classattr">
                                        <input id="molecule.map_unique-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">map_unique</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">goal</span>, </span><span class="param"><span class="n">data</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="molecule.map_unique-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#molecule.map_unique"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="molecule.map_unique-568"><a href="#molecule.map_unique-568"><span class="linenos">568</span></a>    <span class="k">def</span> <span class="nf">map_unique</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">goal</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="molecule.map_unique-569"><a href="#molecule.map_unique-569"><span class="linenos">569</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule.map_unique-570"><a href="#molecule.map_unique-570"><span class="linenos">570</span></a><span class="sd">        Maps information from a dictionary onto unique elements a goal.</span>
</span><span id="molecule.map_unique-571"><a href="#molecule.map_unique-571"><span class="linenos">571</span></a><span class="sd">        Preserves the order of the original list.</span>
</span><span id="molecule.map_unique-572"><a href="#molecule.map_unique-572"><span class="linenos">572</span></a><span class="sd">        Use this for force-field information i.e. potentials,...</span>
</span><span id="molecule.map_unique-573"><a href="#molecule.map_unique-573"><span class="linenos">573</span></a>
</span><span id="molecule.map_unique-574"><a href="#molecule.map_unique-574"><span class="linenos">574</span></a><span class="sd">        Parameters:</span>
</span><span id="molecule.map_unique-575"><a href="#molecule.map_unique-575"><span class="linenos">575</span></a><span class="sd">        - goal:</span>
</span><span id="molecule.map_unique-576"><a href="#molecule.map_unique-576"><span class="linenos">576</span></a><span class="sd">            - list of keys</span>
</span><span id="molecule.map_unique-577"><a href="#molecule.map_unique-577"><span class="linenos">577</span></a><span class="sd">        - data:</span>
</span><span id="molecule.map_unique-578"><a href="#molecule.map_unique-578"><span class="linenos">578</span></a><span class="sd">            - dictionary with keys in goal</span>
</span><span id="molecule.map_unique-579"><a href="#molecule.map_unique-579"><span class="linenos">579</span></a><span class="sd">            </span>
</span><span id="molecule.map_unique-580"><a href="#molecule.map_unique-580"><span class="linenos">580</span></a><span class="sd">        Returns:</span>
</span><span id="molecule.map_unique-581"><a href="#molecule.map_unique-581"><span class="linenos">581</span></a><span class="sd">        - mapped unique data</span>
</span><span id="molecule.map_unique-582"><a href="#molecule.map_unique-582"><span class="linenos">582</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule.map_unique-583"><a href="#molecule.map_unique-583"><span class="linenos">583</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;map_unique is outtdated... dont use</span><span class="se">\n</span><span class="s2"> shouldnt cause errors btw&quot;</span><span class="p">)</span>
</span><span id="molecule.map_unique-584"><a href="#molecule.map_unique-584"><span class="linenos">584</span></a>        <span class="k">return</span> <span class="p">[</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="n">unique_sort</span><span class="p">(</span><span class="n">goal</span><span class="p">))]</span>
</span></pre></div>


            <div class="docstring"><p>Maps information from a dictionary onto unique elements a goal.
Preserves the order of the original list.
Use this for force-field information i.e. potentials,...</p>

<p>Parameters:</p>

<ul>
<li>goal:
<ul>
<li>list of keys</li>
</ul></li>
<li>data:
<ul>
<li>dictionary with keys in goal</li>
</ul></li>
</ul>

<p>Returns:</p>

<ul>
<li>mapped unique data</li>
</ul>
</div>


                            </div>
                            <div id="molecule.map_nested" class="classattr">
                                        <input id="molecule.map_nested-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">map_nested</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">goal</span>, </span><span class="param"><span class="n">data</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="molecule.map_nested-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#molecule.map_nested"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="molecule.map_nested-586"><a href="#molecule.map_nested-586"><span class="linenos">586</span></a>    <span class="k">def</span> <span class="nf">map_nested</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">goal</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="molecule.map_nested-587"><a href="#molecule.map_nested-587"><span class="linenos">587</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule.map_nested-588"><a href="#molecule.map_nested-588"><span class="linenos">588</span></a><span class="sd">        Maps information from a dictionary onto nested elements of a goal.</span>
</span><span id="molecule.map_nested-589"><a href="#molecule.map_nested-589"><span class="linenos">589</span></a><span class="sd">        Preserves the order of the original list.</span>
</span><span id="molecule.map_nested-590"><a href="#molecule.map_nested-590"><span class="linenos">590</span></a><span class="sd">        Use this for advanced force-field information i.e. mixing rules,...</span>
</span><span id="molecule.map_nested-591"><a href="#molecule.map_nested-591"><span class="linenos">591</span></a>
</span><span id="molecule.map_nested-592"><a href="#molecule.map_nested-592"><span class="linenos">592</span></a><span class="sd">        same as:</span>
</span><span id="molecule.map_nested-593"><a href="#molecule.map_nested-593"><span class="linenos">593</span></a><span class="sd">        [ self.map_unique( m, data) for m in goal ]</span>
</span><span id="molecule.map_nested-594"><a href="#molecule.map_nested-594"><span class="linenos">594</span></a>
</span><span id="molecule.map_nested-595"><a href="#molecule.map_nested-595"><span class="linenos">595</span></a><span class="sd">        Parameters:</span>
</span><span id="molecule.map_nested-596"><a href="#molecule.map_nested-596"><span class="linenos">596</span></a><span class="sd">        - goal:</span>
</span><span id="molecule.map_nested-597"><a href="#molecule.map_nested-597"><span class="linenos">597</span></a><span class="sd">            -with list list of keys</span>
</span><span id="molecule.map_nested-598"><a href="#molecule.map_nested-598"><span class="linenos">598</span></a><span class="sd">        - data:</span>
</span><span id="molecule.map_nested-599"><a href="#molecule.map_nested-599"><span class="linenos">599</span></a><span class="sd">            -dictionary with keys in goal</span>
</span><span id="molecule.map_nested-600"><a href="#molecule.map_nested-600"><span class="linenos">600</span></a><span class="sd">            </span>
</span><span id="molecule.map_nested-601"><a href="#molecule.map_nested-601"><span class="linenos">601</span></a><span class="sd">        Returns:</span>
</span><span id="molecule.map_nested-602"><a href="#molecule.map_nested-602"><span class="linenos">602</span></a><span class="sd">        - mapped unique data</span>
</span><span id="molecule.map_nested-603"><a href="#molecule.map_nested-603"><span class="linenos">603</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule.map_nested-604"><a href="#molecule.map_nested-604"><span class="linenos">604</span></a>        <span class="k">return</span> <span class="p">[[</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="n">m</span><span class="p">)]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">goal</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Maps information from a dictionary onto nested elements of a goal.
Preserves the order of the original list.
Use this for advanced force-field information i.e. mixing rules,...</p>

<p>same as:
[ self.map_unique( m, data) for m in goal ]</p>

<p>Parameters:</p>

<ul>
<li>goal:
-with list list of keys</li>
<li>data:
-dictionary with keys in goal</li>
</ul>

<p>Returns:</p>

<ul>
<li>mapped unique data</li>
</ul>
</div>


                            </div>
                            <div id="molecule.get_distance" class="classattr">
                                        <input id="molecule.get_distance-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_distance</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x</span>, </span><span class="param"><span class="n">y</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="molecule.get_distance-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#molecule.get_distance"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="molecule.get_distance-606"><a href="#molecule.get_distance-606"><span class="linenos">606</span></a>    <span class="k">def</span> <span class="nf">get_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="molecule.get_distance-607"><a href="#molecule.get_distance-607"><span class="linenos">607</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule.get_distance-608"><a href="#molecule.get_distance-608"><span class="linenos">608</span></a><span class="sd">        Returns distance between atoms no x and y</span>
</span><span id="molecule.get_distance-609"><a href="#molecule.get_distance-609"><span class="linenos">609</span></a><span class="sd">        0: same atom i.e. x==y</span>
</span><span id="molecule.get_distance-610"><a href="#molecule.get_distance-610"><span class="linenos">610</span></a><span class="sd">        1: bond</span>
</span><span id="molecule.get_distance-611"><a href="#molecule.get_distance-611"><span class="linenos">611</span></a><span class="sd">        2: angle</span>
</span><span id="molecule.get_distance-612"><a href="#molecule.get_distance-612"><span class="linenos">612</span></a><span class="sd">        3: torsion</span>
</span><span id="molecule.get_distance-613"><a href="#molecule.get_distance-613"><span class="linenos">613</span></a>
</span><span id="molecule.get_distance-614"><a href="#molecule.get_distance-614"><span class="linenos">614</span></a><span class="sd">        Parameters:</span>
</span><span id="molecule.get_distance-615"><a href="#molecule.get_distance-615"><span class="linenos">615</span></a><span class="sd">        - x,y:</span>
</span><span id="molecule.get_distance-616"><a href="#molecule.get_distance-616"><span class="linenos">616</span></a><span class="sd">            - atom numbers</span>
</span><span id="molecule.get_distance-617"><a href="#molecule.get_distance-617"><span class="linenos">617</span></a><span class="sd">            </span>
</span><span id="molecule.get_distance-618"><a href="#molecule.get_distance-618"><span class="linenos">618</span></a><span class="sd">        Returns:</span>
</span><span id="molecule.get_distance-619"><a href="#molecule.get_distance-619"><span class="linenos">619</span></a><span class="sd">        - distance</span>
</span><span id="molecule.get_distance-620"><a href="#molecule.get_distance-620"><span class="linenos">620</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule.get_distance-621"><a href="#molecule.get_distance-621"><span class="linenos">621</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance_matrix</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)][</span><span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">)]</span>
</span></pre></div>


            <div class="docstring"><p>Returns distance between atoms no x and y
0: same atom i.e. x==y
1: bond
2: angle
3: torsion</p>

<p>Parameters:</p>

<ul>
<li>x,y:
<ul>
<li>atom numbers</li>
</ul></li>
</ul>

<p>Returns:</p>

<ul>
<li>distance</li>
</ul>
</div>


                            </div>
                            <div id="molecule.get_sorted_key" class="classattr">
                                        <input id="molecule.get_sorted_key-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_sorted_key</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="molecule.get_sorted_key-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#molecule.get_sorted_key"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="molecule.get_sorted_key-623"><a href="#molecule.get_sorted_key-623"><span class="linenos">623</span></a>    <span class="k">def</span> <span class="nf">get_sorted_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="molecule.get_sorted_key-624"><a href="#molecule.get_sorted_key-624"><span class="linenos">624</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule.get_sorted_key-625"><a href="#molecule.get_sorted_key-625"><span class="linenos">625</span></a><span class="sd">        Sorts a list alphabetically.</span>
</span><span id="molecule.get_sorted_key-626"><a href="#molecule.get_sorted_key-626"><span class="linenos">626</span></a><span class="sd">        Very important for dictionary keys in the molecule class!!!</span>
</span><span id="molecule.get_sorted_key-627"><a href="#molecule.get_sorted_key-627"><span class="linenos">627</span></a>
</span><span id="molecule.get_sorted_key-628"><a href="#molecule.get_sorted_key-628"><span class="linenos">628</span></a><span class="sd">        Parameters:</span>
</span><span id="molecule.get_sorted_key-629"><a href="#molecule.get_sorted_key-629"><span class="linenos">629</span></a><span class="sd">        - x:</span>
</span><span id="molecule.get_sorted_key-630"><a href="#molecule.get_sorted_key-630"><span class="linenos">630</span></a><span class="sd">            - string list to sort</span>
</span><span id="molecule.get_sorted_key-631"><a href="#molecule.get_sorted_key-631"><span class="linenos">631</span></a><span class="sd">            </span>
</span><span id="molecule.get_sorted_key-632"><a href="#molecule.get_sorted_key-632"><span class="linenos">632</span></a><span class="sd">        Returns:</span>
</span><span id="molecule.get_sorted_key-633"><a href="#molecule.get_sorted_key-633"><span class="linenos">633</span></a><span class="sd">        - key (string) and sorted list</span>
</span><span id="molecule.get_sorted_key-634"><a href="#molecule.get_sorted_key-634"><span class="linenos">634</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule.get_sorted_key-635"><a href="#molecule.get_sorted_key-635"><span class="linenos">635</span></a>        <span class="n">x_sort</span> <span class="o">=</span> <span class="n">sort_force_fields</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="molecule.get_sorted_key-636"><a href="#molecule.get_sorted_key-636"><span class="linenos">636</span></a>        <span class="k">return</span> <span class="n">make_graph</span><span class="p">(</span><span class="n">x_sort</span><span class="p">),</span> <span class="n">x_sort</span>
</span></pre></div>


            <div class="docstring"><p>Sorts a list alphabetically.
Very important for dictionary keys in the molecule class!!!</p>

<p>Parameters:</p>

<ul>
<li>x:
<ul>
<li>string list to sort</li>
</ul></li>
</ul>

<p>Returns:</p>

<ul>
<li>key (string) and sorted list</li>
</ul>
</div>


                            </div>
                            <div id="molecule.visualize" class="classattr">
                                        <input id="molecule.visualize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">visualize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">saveto</span><span class="o">=</span><span class="s1">&#39;&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="molecule.visualize-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#molecule.visualize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="molecule.visualize-638"><a href="#molecule.visualize-638"><span class="linenos">638</span></a>    <span class="k">def</span> <span class="nf">visualize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">saveto</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
</span><span id="molecule.visualize-639"><a href="#molecule.visualize-639"><span class="linenos">639</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="molecule.visualize-640"><a href="#molecule.visualize-640"><span class="linenos">640</span></a><span class="sd">        plots and visualizes molecule</span>
</span><span id="molecule.visualize-641"><a href="#molecule.visualize-641"><span class="linenos">641</span></a><span class="sd">        </span>
</span><span id="molecule.visualize-642"><a href="#molecule.visualize-642"><span class="linenos">642</span></a><span class="sd">        Parameters:</span>
</span><span id="molecule.visualize-643"><a href="#molecule.visualize-643"><span class="linenos">643</span></a><span class="sd">        - saveto:</span>
</span><span id="molecule.visualize-644"><a href="#molecule.visualize-644"><span class="linenos">644</span></a><span class="sd">            - optional, location to save pic of graph to,</span>
</span><span id="molecule.visualize-645"><a href="#molecule.visualize-645"><span class="linenos">645</span></a><span class="sd">            - add file format at the end ;)</span>
</span><span id="molecule.visualize-646"><a href="#molecule.visualize-646"><span class="linenos">646</span></a><span class="sd">            </span>
</span><span id="molecule.visualize-647"><a href="#molecule.visualize-647"><span class="linenos">647</span></a><span class="sd">        Returns:</span>
</span><span id="molecule.visualize-648"><a href="#molecule.visualize-648"><span class="linenos">648</span></a><span class="sd">            nothing</span>
</span><span id="molecule.visualize-649"><a href="#molecule.visualize-649"><span class="linenos">649</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="molecule.visualize-650"><a href="#molecule.visualize-650"><span class="linenos">650</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_numbers</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="molecule.visualize-651"><a href="#molecule.visualize-651"><span class="linenos">651</span></a>            <span class="n">plot_graph</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_list</span><span class="p">,</span> <span class="n">saveto</span><span class="o">=</span><span class="n">saveto</span><span class="p">)</span>
</span><span id="molecule.visualize-652"><a href="#molecule.visualize-652"><span class="linenos">652</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="molecule.visualize-653"><a href="#molecule.visualize-653"><span class="linenos">653</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;one bead only&quot;</span><span class="p">)</span>
</span><span id="molecule.visualize-654"><a href="#molecule.visualize-654"><span class="linenos">654</span></a>        <span class="k">return</span>
</span></pre></div>


            <div class="docstring"><p>plots and visualizes molecule</p>

<p>Parameters:</p>

<ul>
<li>saveto:
<ul>
<li>optional, location to save pic of graph to,</li>
<li>add file format at the end ;)</li>
</ul></li>
</ul>

<p>Returns:
    nothing</p>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>